###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.3.10338/W32 for 8051         24/Nov/2016  15:46:09 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  C:\Users\icecreamco\Desktop\GAP\EndDvice -         #
#                          拨码开关地址版\Components\stack\zdo\ZDApp.c        #
#    Command line       =  -f "C:\Users\icecreamco\Desktop\GAP\EndDvice -     #
#                          拨码开关地址版\Projects\zstack\Samples\SampleApp\C #
#                          C2530DB\..\..\..\Tools\CC2530DB\f8wEndev.cfg"      #
#                          (-DCPU32MHZ -DROOT=__near_func                     #
#                          -DMAC_CFG_TX_DATA_MAX=3 -DMAC_CFG_TX_MAX=6         #
#                          -DMAC_CFG_RX_MAX=3) -f "C:\Users\icecreamco\Deskto #
#                          p\GAP\EndDvice - 拨码开关地址版\Projects\zstack\Sa #
#                          mples\SampleApp\CC2530DB\..\..\..\Tools\CC2530DB\f #
#                          8wConfig.cfg" (-DZIGBEEPRO -DSECURE=0              #
#                          -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                  #
#                          -DDEFAULT_CHANLIST=0x00000800                      #
#                          -DZDAPP_CONFIG_PAN_ID=0x2222                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=500               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DLINK_STATUS_JITTER_MASK=0x007F                   #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116                           #
#                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const     #
#                          __code" -DGENERIC=__generic                        #
#                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=1000        #
#                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100)   #
#                          -DREJOIN_POLL_RATE=440 "C:\Users\icecreamco\Deskto #
#                          p\GAP\EndDvice - 拨码开关地址版\Components\stack\z #
#                          do\ZDApp.c" -D xNWK_AUTO_POLL -D POWER_SAVING -D   #
#                          AUTO_RESET -D xMT_TASK -D xMT_SYS_FUNC -D          #
#                          xMT_ZDO_FUNC -D xLCD_SUPPORTED=DEBUG -lC           #
#                          "C:\Users\icecreamco\Desktop\GAP\EndDvice -        #
#                          拨码开关地址版\Projects\zstack\Samples\SampleApp\C #
#                          C2530DB\EndDeviceEB\List\" -lA                     #
#                          "C:\Users\icecreamco\Desktop\GAP\EndDvice -        #
#                          拨码开关地址版\Projects\zstack\Samples\SampleApp\C #
#                          C2530DB\EndDeviceEB\List\" --diag_suppress         #
#                          Pe001,Pa010 -o "C:\Users\icecreamco\Desktop\GAP\En #
#                          dDvice - 拨码开关地址版\Projects\zstack\Samples\Sa #
#                          mpleApp\CC2530DB\EndDeviceEB\Obj\" -e              #
#                          --no_code_motion --debug --core=plain --dptr=16,1  #
#                          --data_model=large --code_model=banked             #
#                          --calling_convention=xdata_reentrant               #
#                          --place_constants=data_rom --nr_virtual_regs 16    #
#                          -I "C:\Users\icecreamco\Desktop\GAP\EndDvice -     #
#                          拨码开关地址版\Projects\zstack\Samples\SampleApp\C #
#                          C2530DB\" -I "C:\Users\icecreamco\Desktop\GAP\EndD #
#                          vice - 拨码开关地址版\Projects\zstack\Samples\Samp #
#                          leApp\CC2530DB\..\Source\" -I                      #
#                          "C:\Users\icecreamco\Desktop\GAP\EndDvice -        #
#                          拨码开关地址版\Projects\zstack\Samples\SampleApp\C #
#                          C2530DB\..\..\..\ZMain\TI2530DB\" -I               #
#                          "C:\Users\icecreamco\Desktop\GAP\EndDvice -        #
#                          拨码开关地址版\Projects\zstack\Samples\SampleApp\C #
#                          C2530DB\..\..\..\..\..\Components\hal\include\"    #
#                          -I "C:\Users\icecreamco\Desktop\GAP\EndDvice -     #
#                          拨码开关地址版\Projects\zstack\Samples\SampleApp\C #
#                          C2530DB\..\..\..\..\..\Components\hal\target\CC253 #
#                          0EB\" -I "C:\Users\icecreamco\Desktop\GAP\EndDvice #
#                           - 拨码开关地址版\Projects\zstack\Samples\SampleAp #
#                          p\CC2530DB\..\..\..\..\..\Components\mac\include\" #
#                           -I "C:\Users\icecreamco\Desktop\GAP\EndDvice -    #
#                          拨码开关地址版\Projects\zstack\Samples\SampleApp\C #
#                          C2530DB\..\..\..\..\..\Components\mac\high_level\" #
#                           -I "C:\Users\icecreamco\Desktop\GAP\EndDvice -    #
#                          拨码开关地址版\Projects\zstack\Samples\SampleApp\C #
#                          C2530DB\..\..\..\..\..\Components\mac\low_level\sr #
#                          f04\" -I "C:\Users\icecreamco\Desktop\GAP\EndDvice #
#                           - 拨码开关地址版\Projects\zstack\Samples\SampleAp #
#                          p\CC2530DB\..\..\..\..\..\Components\mac\low_level #
#                          \srf04\single_chip\" -I "C:\Users\icecreamco\Deskt #
#                          op\GAP\EndDvice - 拨码开关地址版\Projects\zstack\S #
#                          amples\SampleApp\CC2530DB\..\..\..\..\..\Component #
#                          s\mt\" -I "C:\Users\icecreamco\Desktop\GAP\EndDvic #
#                          e - 拨码开关地址版\Projects\zstack\Samples\SampleA #
#                          pp\CC2530DB\..\..\..\..\..\Components\osal\include #
#                          \" -I "C:\Users\icecreamco\Desktop\GAP\EndDvice -  #
#                          拨码开关地址版\Projects\zstack\Samples\SampleApp\C #
#                          C2530DB\..\..\..\..\..\Components\services\saddr\" #
#                           -I "C:\Users\icecreamco\Desktop\GAP\EndDvice -    #
#                          拨码开关地址版\Projects\zstack\Samples\SampleApp\C #
#                          C2530DB\..\..\..\..\..\Components\services\sdata\" #
#                           -I "C:\Users\icecreamco\Desktop\GAP\EndDvice -    #
#                          拨码开关地址版\Projects\zstack\Samples\SampleApp\C #
#                          C2530DB\..\..\..\..\..\Components\stack\af\" -I    #
#                          "C:\Users\icecreamco\Desktop\GAP\EndDvice -        #
#                          拨码开关地址版\Projects\zstack\Samples\SampleApp\C #
#                          C2530DB\..\..\..\..\..\Components\stack\nwk\" -I   #
#                          "C:\Users\icecreamco\Desktop\GAP\EndDvice -        #
#                          拨码开关地址版\Projects\zstack\Samples\SampleApp\C #
#                          C2530DB\..\..\..\..\..\Components\stack\sapi\" -I  #
#                          "C:\Users\icecreamco\Desktop\GAP\EndDvice -        #
#                          拨码开关地址版\Projects\zstack\Samples\SampleApp\C #
#                          C2530DB\..\..\..\..\..\Components\stack\sec\" -I   #
#                          "C:\Users\icecreamco\Desktop\GAP\EndDvice -        #
#                          拨码开关地址版\Projects\zstack\Samples\SampleApp\C #
#                          C2530DB\..\..\..\..\..\Components\stack\sys\" -I   #
#                          "C:\Users\icecreamco\Desktop\GAP\EndDvice -        #
#                          拨码开关地址版\Projects\zstack\Samples\SampleApp\C #
#                          C2530DB\..\..\..\..\..\Components\stack\zdo\" -I   #
#                          "C:\Users\icecreamco\Desktop\GAP\EndDvice -        #
#                          拨码开关地址版\Projects\zstack\Samples\SampleApp\C #
#                          C2530DB\..\..\..\..\..\Components\zmac\" -I        #
#                          "C:\Users\icecreamco\Desktop\GAP\EndDvice -        #
#                          拨码开关地址版\Projects\zstack\Samples\SampleApp\C #
#                          C2530DB\..\..\..\..\..\Components\zmac\f8w\" -Ohz  #
#                          --require_prototypes                               #
#    List file          =  C:\Users\icecreamco\Desktop\GAP\EndDvice -         #
#                          拨码开关地址版\Projects\zstack\Samples\SampleApp\C #
#                          C2530DB\EndDeviceEB\List\ZDApp.lst                 #
#    Object file        =  C:\Users\icecreamco\Desktop\GAP\EndDvice -         #
#                          拨码开关地址版\Projects\zstack\Samples\SampleApp\C #
#                          C2530DB\EndDeviceEB\Obj\ZDApp.r51                  #
#                                                                             #
#                                                                             #
###############################################################################

C:\Users\icecreamco\Desktop\GAP\EndDvice - 拨码开关地址版\Components\stack\zdo\ZDApp.c
      1          /**************************************************************************************************
      2            Filename:       ZDApp.c
      3            Revised:        $Date: 2012-02-16 16:04:32 -0800 (Thu, 16 Feb 2012) $
      4            Revision:       $Revision: 29348 $
      5          
      6            Description:    This file contains the interface to the Zigbee Device Application. This is the
      7                            Application part that the user can change. This also contains the Task functions.
      8          
      9          
     10            Copyright 2004-2012 Texas Instruments Incorporated. All rights reserved.
     11          
     12            IMPORTANT: Your use of this Software is limited to those specific rights
     13            granted under the terms of a software license agreement between the user
     14            who downloaded the software, his/her employer (which must be your employer)
     15            and Texas Instruments Incorporated (the "License").  You may not use this
     16            Software unless you agree to abide by the terms of the License. The License
     17            limits your use, and you acknowledge, that the Software may not be modified,
     18            copied or distributed unless embedded on a Texas Instruments microcontroller
     19            or used solely and exclusively in conjunction with a Texas Instruments radio
     20            frequency transceiver, which is integrated into your product.  Other than for
     21            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     22            works of, modify, distribute, perform, display or sell this Software and/or
     23            its documentation for any purpose.
     24          
     25            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     26            PROVIDED AS IS?WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     27            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     28            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     29            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     30            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     31            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     32            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     33            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     34            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     35            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     36          
     37            Should you have any questions regarding your right to use this Software,
     38            contact Texas Instruments Incorporated at www.TI.com.
     39          **************************************************************************************************/
     40          
     41          /*********************************************************************
     42           * INCLUDES
     43           */
     44          
     45          #include "ZComDef.h"
     46          #include "ZMac.h"
     47          #include "OSAL.h"
     48          #include "OSAL_Tasks.h"
     49          #include "OSAL_PwrMgr.h"
     50          #include "OSAL_Nv.h"
     51          #include "AF.h"
     52          #include "APSMEDE.h"
     53          #include "NLMEDE.h"
     54          #include "AddrMgr.h"
     55          #include "ZDProfile.h"
     56          #include "ZDObject.h"
     57          #include "ZDConfig.h"
     58          #include "ZDSecMgr.h"
     59          #include "ZDApp.h"
     60          #include "DebugTrace.h"
     61          #include "nwk_util.h"
     62          #include "OnBoard.h"

   \                                 In  segment SFR_AN, at 0x90
   \   union <unnamed> volatile __sfr _A_P1
   \                     _A_P1:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfe
   \   unsigned char volatile __sfr P1DIR
   \                     P1DIR:
   \   000000                DS 1
     63          #include "ZGlobals.h"
     64          #include "ZDNwkMgr.h"
     65          #include "rtg.h"
     66          #include "SampleApp.h"
     67          #include "ssp.h"
     68          
     69          /* HAL */
     70          #include "hal_led.h"
     71          #include "hal_lcd.h"
     72          #include "hal_key.h"
     73          #include "hal_sleep.h"
     74          
     75          #if defined( MT_MAC_FUNC ) || defined( MT_MAC_CB_FUNC )
     76            #error "ERROR! MT_MAC functionalities should be disabled on ZDO devices"
     77          #endif
     78          
     79          /*********************************************************************
     80           * CONSTANTS
     81           */
     82          
     83          #if !defined( NWK_START_DELAY )
     84            #define NWK_START_DELAY             100   // in milliseconds
     85          #endif
     86          
     87          #if !defined( LEAVE_RESET_DELAY )
     88            #define LEAVE_RESET_DELAY           5000  // in milliseconds
     89          #endif
     90          
     91          // Init ZDO, but hold and wait for application to start the joining or
     92          // forming network
     93          #define ZDO_INIT_HOLD_NWK_START       0xFFFF
     94          
     95          #if !defined( EXTENDED_JOINING_RANDOM_MASK )
     96            #define EXTENDED_JOINING_RANDOM_MASK 0x007F
     97          #endif
     98          
     99          #if !defined( BEACON_REQUEST_DELAY )
    100            #define BEACON_REQUEST_DELAY        100   // in milliseconds
    101          #endif
    102          
    103          #if !defined( BEACON_REQ_DELAY_MASK )
    104            #define BEACON_REQ_DELAY_MASK       0x007F
    105          #endif
    106          
    107          #define MAX_RESUME_RETRY            3
    108          
    109          #define MAX_DEVICE_UNAUTH_TIMEOUT   5000  // 5 seconds
    110          
    111          // Beacon Order Settings (see NLMEDE.h)
    112          #define DEFAULT_BEACON_ORDER        BEACON_ORDER_NO_BEACONS
    113          #define DEFAULT_SUPERFRAME_ORDER    DEFAULT_BEACON_ORDER
    114          
    115          #if !defined( MAX_NWK_FRAMECOUNTER_CHANGES )
    116            // The number of times the frame counter can change before
    117            // saving to NV
    118            #define MAX_NWK_FRAMECOUNTER_CHANGES    1000
    119          #endif
    120          
    121          // Leave control bits
    122          #define ZDAPP_LEAVE_CTRL_INIT 0
    123          #define ZDAPP_LEAVE_CTRL_SET  1
    124          #define ZDAPP_LEAVE_CTRL_RA   2
    125          
    126          // Address Manager Stub Implementation
    127          #define ZDApp_NwkWriteNVRequest AddrMgrWriteNVRequest
    128          
    129          
    130          #if !defined ZDO_NV_SAVE_RFDs
    131          #define ZDO_NV_SAVE_RFDs  TRUE
    132          #endif
    133          
    134          // Delay time before updating NWK NV data to force fewer writes during high activity.
    135          #if ZDO_NV_SAVE_RFDs
    136          #define ZDAPP_UPDATE_NWK_NV_TIME 700
    137          #else
    138          #define ZDAPP_UPDATE_NWK_NV_TIME 65000
    139          #endif
    140          
    141          /*********************************************************************
    142           * GLOBAL VARIABLES
    143           */
    144          
    145          #if defined( LCD_SUPPORTED )
    146            uint8 MatchRsps = 0;
    147          #endif
    148          

   \                                 In  segment XDATA_I, align 1, keep-with-next
    149          uint8 zdoDiscCounter = 1;
   \                     zdoDiscCounter:
   \   000000                DS 1
   \   000001                REQUIRE `?<Initializer for zdoDiscCounter>`
   \   000001                REQUIRE __INIT_XDATA_I
    150          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    151          zAddrType_t ZDAppNwkAddr;
   \                     ZDAppNwkAddr:
   \   000000                DS 9
   \   000009                REQUIRE __INIT_XDATA_Z
    152          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    153          uint8 zdappMgmtNwkDiscRspTransSeq;
   \                     zdappMgmtNwkDiscRspTransSeq:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    154          uint8 zdappMgmtNwkDiscReqInProgress = FALSE;
   \                     zdappMgmtNwkDiscReqInProgress:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    155          zAddrType_t zdappMgmtNwkDiscRspAddr;
   \                     zdappMgmtNwkDiscRspAddr:
   \   000000                DS 9
   \   000009                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    156          uint8 zdappMgmtNwkDiscStartIndex;
   \                     zdappMgmtNwkDiscStartIndex:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    157          uint8 zdappMgmtSavedNwkState;
   \                     zdappMgmtSavedNwkState:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    158          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    159          uint16 nwkFrameCounterChanges = 0;
   \                     nwkFrameCounterChanges:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_I, align 1, keep-with-next
    160          uint8 continueJoining = TRUE;
   \                     continueJoining:
   \   000000                DS 1
   \   000001                REQUIRE `?<Initializer for continueJoining>`
   \   000001                REQUIRE __INIT_XDATA_I
    161          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    162          uint8  _tmpRejoinState;
   \                     _tmpRejoinState:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    163          
    164          // The extended PanID used in ZDO layer for rejoin.

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    165          uint8 ZDO_UseExtendedPANID[Z_EXTADDR_LEN];
   \                     ZDO_UseExtendedPANID:
   \   000000                DS 8
   \   000008                REQUIRE __INIT_XDATA_Z
    166          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    167          pfnZdoCb zdoCBFunc[MAX_ZDO_CB_FUNC];
   \                     zdoCBFunc:
   \   000000                DS 14
   \   00000E                REQUIRE __INIT_XDATA_Z
    168          
    169          /*********************************************************************
    170           * EXTERNAL VARIABLES
    171           */
    172          
    173          /*********************************************************************
    174           * EXTERNAL FUNCTIONS
    175           */
    176          
    177          /*********************************************************************
    178           * LOCAL FUNCTIONS
    179           */
    180          
    181          void ZDApp_NetworkStartEvt( void );
    182          void ZDApp_DeviceAuthEvt( void );
    183          void ZDApp_SaveNetworkStateEvt( void );
    184          
    185          uint8 ZDApp_ReadNetworkRestoreState( void );
    186          uint8 ZDApp_RestoreNetworkState( void );
    187          void ZDAppDetermineDeviceType( void );
    188          void ZDApp_InitUserDesc( void );
    189          void ZDAppCheckForHoldKey( void );
    190          void ZDApp_ProcessOSALMsg( osal_event_hdr_t *msgPtr );
    191          void ZDApp_ProcessNetworkJoin( void );
    192          void ZDApp_SetCoordAddress( uint8 endPoint, uint8 dstEP );
    193          uint8 ZDApp_RestoreNwkKey( void );
    194          networkDesc_t* ZDApp_NwkDescListProcessing(void);
    195          
    196          void ZDApp_SecInit( uint8 state );
    197          UINT16 ZDApp_ProcessSecEvent( uint8 task_id, UINT16 events );
    198          void ZDApp_ProcessSecMsg( osal_event_hdr_t *msgPtr );
    199          
    200          void ZDApp_SendMsg( uint8 taskID, uint8 cmd, uint8 len, uint8 *buf );
    201          
    202          void ZDApp_ResetTimerStart( uint16 delay );
    203          void ZDApp_ResetTimerCancel( void );
    204          void ZDApp_LeaveCtrlInit( void );
    205          void ZDApp_LeaveCtrlSet( uint8 ra );
    206          uint8 ZDApp_LeaveCtrlBypass( void );
    207          void ZDApp_LeaveCtrlStartup( devStates_t* state, uint16* startDelay );
    208          void ZDApp_LeaveUpdate( uint16 nwkAddr, uint8* extAddr,
    209                                  uint8 removeChildren );
    210          void ZDApp_NodeProfileSync( uint8 stackProfile );
    211          void ZDApp_ProcessMsgCBs( zdoIncomingMsg_t *inMsg );
    212          void ZDApp_RegisterCBs( void );
    213          void ZDApp_InitZdoCBFunc(void);
    214          
    215          /*********************************************************************
    216           * LOCAL VARIABLES
    217           */

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    218          uint8 linkedCount = 0;
   \                     linkedCount:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    219          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    220          uint8 ZDAppTaskID;
   \                     ZDAppTaskID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    221          uint8 nwkStatus;
   \                     nwkStatus:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    222          endPointDesc_t *ZDApp_AutoFindMode_epDesc = (endPointDesc_t *)NULL;
   \                     ZDApp_AutoFindMode_epDesc:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    223          uint8 ZDApp_LeaveCtrl;
   \                     ZDApp_LeaveCtrl:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    224          
    225          #if defined( HOLD_AUTO_START )
    226            devStates_t devState = DEV_HOLD;
    227          #else

   \                                 In  segment XDATA_I, align 1, keep-with-next
    228            devStates_t devState = DEV_INIT;
   \                     devState:
   \   000000                DS 1
   \   000001                REQUIRE `?<Initializer for devState>`
   \   000001                REQUIRE __INIT_XDATA_I
    229          #endif
    230          
    231          #if ( ZG_BUILD_RTRONLY_TYPE ) || ( ZG_BUILD_ENDDEVICE_TYPE )

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    232            devStartModes_t devStartMode = MODE_JOIN;     // Assume joining
   \                     devStartMode:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    233            //devStartModes_t devStartMode = MODE_RESUME; // if already "directly joined"
    234                                  // to parent. Set to make the device do an Orphan scan.
    235          #else
    236            // Set the default to coodinator
    237            devStartModes_t devStartMode = MODE_HARD;
    238          #endif
    239          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    240          uint8 retryCnt;
   \                     retryCnt:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    241          

   \                                 In  segment XDATA_I, align 1, keep-with-next
    242          endPointDesc_t ZDApp_epDesc =
   \                     ZDApp_epDesc:
   \   000000                DS 6
   \   000006                REQUIRE `?<Initializer for ZDApp_epDesc>`
   \   000006                REQUIRE __INIT_XDATA_I
    243          {
    244            ZDO_EP,
    245            &ZDAppTaskID,
    246            (SimpleDescriptionFormat_t *)NULL,  // No Simple description for ZDO
    247            (afNetworkLatencyReq_t)0            // No Network Latency req
    248          };
    249          

   \                                 In  segment XDATA_I, align 1, keep-with-next
    250          uint16 ZDApp_SavedPollRate = POLL_RATE;
   \                     ZDApp_SavedPollRate:
   \   000000                DS 2
   \   000002                REQUIRE `?<Initializer for ZDApp_SavedPollRate>`
   \   000002                REQUIRE __INIT_XDATA_I
    251          
    252          /*********************************************************************
    253           * @fn      ZDApp_Init
    254           *
    255           * @brief   ZDApp Initialization function.
    256           *
    257           * @param   task_id - ZDApp Task ID
    258           *
    259           * @return  None
    260           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    261          void ZDApp_Init( uint8 task_id )
   \                     ZDApp_Init:
    262          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
    263            // Save the task ID
    264            ZDAppTaskID = task_id;
   \   000006   90....       MOV     DPTR,#ZDAppTaskID
   \   000009   F0           MOVX    @DPTR,A
    265          
    266            // Initialize the ZDO global device short address storage
    267            ZDAppNwkAddr.addrMode = Addr16Bit;
   \   00000A   90....       MOV     DPTR,#ZDAppNwkAddr + 8
   \   00000D   7402         MOV     A,#0x2
   \   00000F   F0           MOVX    @DPTR,A
    268            ZDAppNwkAddr.addr.shortAddr = INVALID_NODE_ADDR;
   \   000010   90....       MOV     DPTR,#ZDAppNwkAddr
   \   000013   74FE         MOV     A,#-0x2
   \   000015   F0           MOVX    @DPTR,A
   \   000016   A3           INC     DPTR
   \   000017   04           INC     A
   \   000018   F0           MOVX    @DPTR,A
    269            (void)NLME_GetExtAddr();  // Load the saveExtAddr pointer.
   \   000019                ; Setup parameters for call to function NLME_GetExtAddr
   \   000019   12....       LCALL   ??NLME_GetExtAddr?relay
    270          
    271            // Check for manual "Hold Auto Start"
    272            ZDAppCheckForHoldKey();
   \   00001C                ; Setup parameters for call to function ZDAppCheckForHoldKey
   \   00001C   12....       LCALL   ??ZDAppCheckForHoldKey?relay
    273          
    274            // Initialize ZDO items and setup the device - type of device to create.
    275            ZDO_Init();
   \   00001F                ; Setup parameters for call to function ZDO_Init
   \   00001F   12....       LCALL   ??ZDO_Init?relay
    276          
    277            // Register the endpoint description with the AF
    278            // This task doesn't have a Simple description, but we still need
    279            // to register the endpoint.
    280            afRegister( (endPointDesc_t *)&ZDApp_epDesc );
   \   000022                ; Setup parameters for call to function afRegister
   \   000022   7A..         MOV     R2,#ZDApp_epDesc & 0xff
   \   000024   7B..         MOV     R3,#(ZDApp_epDesc >> 8) & 0xff
   \   000026   12....       LCALL   ??afRegister?relay
    281          
    282          #if defined( ZDO_USERDESC_RESPONSE )
    283            ZDApp_InitUserDesc();
    284          #endif // ZDO_USERDESC_RESPONSE
    285          
    286            // Start the device?
    287            if ( devState != DEV_HOLD )
   \   000029   90....       MOV     DPTR,#devState
   \   00002C   E0           MOVX    A,@DPTR
   \   00002D   6009         JZ      ??ZDApp_Init_0
    288            {
    289          //******************连网初始化************************************************//
    290              ZDOInitDevice( 0 );                
   \   00002F                ; Setup parameters for call to function ZDOInitDevice
   \   00002F   7A00         MOV     R2,#0x0
   \   000031   7B00         MOV     R3,#0x0
   \   000033   12....       LCALL   ??ZDOInitDevice?relay
   \   000036   8014         SJMP    ??ZDApp_Init_1
    291            }
    292            else
    293            {
    294              ZDOInitDevice( ZDO_INIT_HOLD_NWK_START );
   \                     ??ZDApp_Init_0:
   \   000038                ; Setup parameters for call to function ZDOInitDevice
   \   000038   7AFF         MOV     R2,#-0x1
   \   00003A   7BFF         MOV     R3,#-0x1
   \   00003C   12....       LCALL   ??ZDOInitDevice?relay
    295              // Blink LED to indicate HOLD_START
    296              HalLedBlink ( HAL_LED_4, 0, 50, 500 );
   \   00003F                ; Setup parameters for call to function HalLedBlink
   \   00003F   7CF4         MOV     R4,#-0xc
   \   000041   7D01         MOV     R5,#0x1
   \   000043   7B32         MOV     R3,#0x32
   \   000045   7A00         MOV     R2,#0x0
   \   000047   7908         MOV     R1,#0x8
   \   000049   12....       LCALL   ??HalLedBlink?relay
    297            }
    298          
    299            // Initialize the ZDO callback function pointers zdoCBFunc[]
    300            ZDApp_InitZdoCBFunc();
   \                     ??ZDApp_Init_1:
   \   00004C                ; Setup parameters for call to function ZDApp_InitZdoCBFunc
   \   00004C   12....       LCALL   ??ZDApp_InitZdoCBFunc?relay
    301          
    302            ZDApp_RegisterCBs();
   \   00004F                ; Setup parameters for call to function ZDApp_RegisterCBs
   \   00004F   12....       LCALL   ??ZDApp_RegisterCBs?relay
    303          } /* ZDApp_Init() */
   \   000052   02....       LJMP    ??Subroutine50_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine50_0:
   \   000000   7F01         MOV     R7,#0x1
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA
    304          
    305          /*********************************************************************
    306           * @fn          ZDApp_SecInit
    307           *
    308           * @brief       ZDApp initialize security.
    309           *
    310           * @param       state - device initialization state
    311           *
    312           * @return      none
    313           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    314          void ZDApp_SecInit( uint8 state )
   \                     ZDApp_SecInit:
    315          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    316            uint8 zgPreConfigKey[SEC_KEY_LEN];
    317          
    318            if ( ZG_SECURE_ENABLED && ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE )
    319            {
    320              // Set the Trust Center bit
    321              ZDO_Config_Node_Descriptor.ServerMask |= PRIM_TRUST_CENTER;
    322            }
    323          
    324            if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
    325            {
    326              ZDO_Config_Node_Descriptor.CapabilityFlags |= CAPINFO_SECURITY_CAPABLE;
    327            }
    328          
    329            // Initialize ZigBee Device Security Manager
    330            ZDSecMgrInit(state);
   \   000005                ; Setup parameters for call to function ZDSecMgrInit
   \   000005   12....       LCALL   ??ZDSecMgrInit?relay
    331          
    332            if ( ZG_SECURE_ENABLED )
    333            {
    334              if ( state != ZDO_INITDEV_RESTORED_NETWORK_STATE )
    335              {
    336                nwkFrameCounter = 0;
    337          
    338                if( _NIB.nwkKeyLoaded == FALSE )
    339                {
    340                  if ( ( ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE          ) ||
    341                       ( ( zgSecurityMode == ZG_SECURITY_RESIDENTIAL ) && zgPreConfigKeys )    )
    342                  {
    343                      ZDSecMgrReadKeyFromNv(ZCD_NV_PRECFGKEY, zgPreConfigKey);
    344                      SSP_UpdateNwkKey( zgPreConfigKey, 0);
    345                      SSP_SwitchNwkKey( 0 );
    346          
    347                      // clear local copy of key
    348                      osal_memset(zgPreConfigKey, 0x00, SEC_KEY_LEN);
    349                  }
    350                }
    351              }
    352            }
    353          }
   \   000008   02....       LJMP    ??Subroutine50_0 & 0xFFFF
    354          
    355          /*********************************************************************
    356           * @fn      ZDApp_event_loop()
    357           *
    358           * @brief   Main event loop for Zigbee device objects task. This function
    359           *          should be called at periodic intervals.
    360           *
    361           * @param   task_id - Task ID
    362           * @param   events  - Bitmap of events
    363           *
    364           * @return  none
    365           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    366          UINT16 ZDApp_event_loop( uint8 task_id, UINT16 events )
   \                     ZDApp_event_loop:
    367          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    368            uint8 *msg_ptr;
    369          
    370            if ( events & SYS_EVENT_MSG )
   \   000009   5480         ANL     A,#0x80
   \   00000B   7033         JNZ     ??ZDApp_event_loop_0
    371            {
    372              while ( (msg_ptr = osal_msg_receive( ZDAppTaskID )) )
    373              {
    374                ZDApp_ProcessOSALMsg( (osal_event_hdr_t *)msg_ptr );
    375          
    376                // Release the memory
    377                osal_msg_deallocate( msg_ptr );
    378              }
    379          
    380              // Return unprocessed events
    381              return (events ^ SYS_EVENT_MSG);
    382            }
    383          
    384            if ( events & ZDO_NETWORK_INIT )
   \   00000D   EE           MOV     A,R6
   \   00000E   A2E0         MOV     C,0xE0 /* A   */.0
   \   000010   5047         JNC     ??ZDApp_event_loop_1
    385            {
    386              // Initialize apps and start the network
    387              devState = DEV_INIT;
   \   000012   90....       MOV     DPTR,#devState
   \   000015   7401         MOV     A,#0x1
   \   000017   F0           MOVX    @DPTR,A
    388              osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   000018                ; Setup parameters for call to function osal_set_event
   \   000018   12....       LCALL   ?Subroutine18 & 0xFFFF
    389          
    390          //*********************开启设备***********************************************//
    391              ZDO_StartDevice( (uint8)ZDO_Config_Node_Descriptor.LogicalType, devStartMode,
    392                               DEFAULT_BEACON_ORDER, DEFAULT_SUPERFRAME_ORDER );
   \                     ??CrossCallReturnLabel_60:
   \   00001B                ; Setup parameters for call to function ZDO_StartDevice
   \   00001B   7C0F         MOV     R4,#0xf
   \   00001D   7B0F         MOV     R3,#0xf
   \   00001F   90....       MOV     DPTR,#devStartMode
   \   000022   E0           MOVX    A,@DPTR
   \   000023   FA           MOV     R2,A
   \   000024   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000027   E0           MOVX    A,@DPTR
   \   000028   5407         ANL     A,#0x7
   \   00002A   F9           MOV     R1,A
   \   00002B   12....       LCALL   ??ZDO_StartDevice?relay
    393          
    394              // Return unprocessed events
    395              return (events ^ ZDO_NETWORK_INIT);
   \   00002E   EE           MOV     A,R6
   \   00002F   6401         XRL     A,#0x1
   \                     ??ZDApp_event_loop_2:
   \   000031   FA           MOV     R2,A
   \   000032   EF           MOV     A,R7
   \                     ??ZDApp_event_loop_3:
   \   000033   FB           MOV     R3,A
   \   000034   8072         SJMP    ??ZDApp_event_loop_4
    396            }
   \                     ??ZDApp_event_loop_5:
   \   000036                ; Setup parameters for call to function ZDApp_ProcessOSALMsg
   \   000036   12....       LCALL   ??ZDApp_ProcessOSALMsg?relay
   \   000039                ; Setup parameters for call to function osal_msg_deallocate
   \   000039   AA..         MOV     R2,?V0 + 0
   \   00003B   AB..         MOV     R3,?V0 + 1
   \   00003D   12....       LCALL   ??osal_msg_deallocate?relay
   \                     ??ZDApp_event_loop_0:
   \   000040                ; Setup parameters for call to function osal_msg_receive
   \   000040   90....       MOV     DPTR,#ZDAppTaskID
   \   000043   E0           MOVX    A,@DPTR
   \   000044   F9           MOV     R1,A
   \   000045   12....       LCALL   ??osal_msg_receive?relay
   \   000048   8A..         MOV     ?V0 + 0,R2
   \   00004A   8B..         MOV     ?V0 + 1,R3
   \   00004C   A9..         MOV     R1,?V0 + 1
   \   00004E   EA           MOV     A,R2
   \   00004F   49           ORL     A,R1
   \   000050   70E4         JNZ     ??ZDApp_event_loop_5
   \   000052   EE           MOV     A,R6
   \   000053   FA           MOV     R2,A
   \   000054   EF           MOV     A,R7
   \   000055   6480         XRL     A,#0x80
   \   000057   80DA         SJMP    ??ZDApp_event_loop_3
    397          
    398            if ( ZSTACK_ROUTER_BUILD )
    399            {
    400              if ( events & ZDO_NETWORK_START )
    401              {
    402                ZDApp_NetworkStartEvt();
    403          
    404                // Return unprocessed events
    405                return (events ^ ZDO_NETWORK_START);
    406              }
    407          
    408              if ( events & ZDO_ROUTER_START )
    409              {
    410                if ( nwkStatus == ZSuccess )
    411                {
    412                  if ( devState == DEV_END_DEVICE )
    413                    devState = DEV_ROUTER;
    414          
    415                  osal_pwrmgr_device( PWRMGR_ALWAYS_ON );
    416                }
    417                else
    418                {
    419                  // remain as end device!!
    420                }
    421                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
    422          
    423                // Return unprocessed events
    424                return (events ^ ZDO_ROUTER_START);
    425              }
    426            }
    427          
    428            if ( events & ZDO_STATE_CHANGE_EVT )
   \                     ??ZDApp_event_loop_1:
   \   000059   5410         ANL     A,#0x10
   \   00005B   6023         JZ      ??ZDApp_event_loop_6
    429            {
    430              ZDO_UpdateNwkStatus( devState );
   \   00005D                ; Setup parameters for call to function ZDO_UpdateNwkStatus
   \   00005D   90....       MOV     DPTR,#devState
   \   000060   E0           MOVX    A,@DPTR
   \   000061   F9           MOV     R1,A
   \   000062   12....       LCALL   ??ZDO_UpdateNwkStatus?relay
    431          
    432              // At start up, do one MTO route discovery if the device is a concentrator
    433              if ( zgConcentratorEnable == TRUE )
   \   000065   90....       MOV     DPTR,#zgConcentratorEnable
   \   000068   E0           MOVX    A,@DPTR
   \   000069   6401         XRL     A,#0x1
   \   00006B   700E         JNZ     ??CrossCallReturnLabel_88
    434              {
    435                // Start next event
    436                osal_start_timerEx( NWK_TaskID, NWK_MTO_RTG_REQ_EVT, 100 );
   \   00006D                ; Setup parameters for call to function osal_start_timerEx
   \   00006D   7C64         MOV     R4,#0x64
   \   00006F   7D00         MOV     R5,#0x0
   \   000071   7A00         MOV     R2,#0x0
   \   000073   7B08         MOV     R3,#0x8
   \   000075   90....       MOV     DPTR,#NWK_TaskID
   \   000078   12....       LCALL   ??Subroutine49_0 & 0xFFFF
    437              }
    438          
    439              // Return unprocessed events
    440              return (events ^ ZDO_STATE_CHANGE_EVT);
   \                     ??CrossCallReturnLabel_88:
   \   00007B   EE           MOV     A,R6
   \   00007C   6410         XRL     A,#0x10
   \   00007E   80B1         SJMP    ??ZDApp_event_loop_2
    441            }
    442          
    443            if ( events & ZDO_COMMAND_CNF )
   \                     ??ZDApp_event_loop_6:
   \   000080   EE           MOV     A,R6
   \   000081   5408         ANL     A,#0x8
   \   000083   6006         JZ      ??ZDApp_event_loop_7
    444            {
    445              // User defined logic
    446          
    447              // Return unprocessed events
    448              return (events ^ ZDO_COMMAND_CNF);
   \   000085   EE           MOV     A,R6
   \   000086   6408         XRL     A,#0x8
   \   000088   FA           MOV     R2,A
   \   000089   801D         SJMP    ??ZDApp_event_loop_4
    449            }
    450          
    451            if ( events & ZDO_NWK_UPDATE_NV )
   \                     ??ZDApp_event_loop_7:
   \   00008B   EF           MOV     A,R7
   \   00008C   5402         ANL     A,#0x2
   \   00008E   6005         JZ      ??ZDApp_event_loop_8
    452            {
    453              ZDApp_SaveNetworkStateEvt();
    454          
    455              // Return unprocessed events
    456              return (events ^ ZDO_NWK_UPDATE_NV);
   \   000090   EF           MOV     A,R7
   \   000091   6402         XRL     A,#0x2
   \   000093   809E         SJMP    ??ZDApp_event_loop_3
    457            }
    458          
    459            if ( events & ZDO_DEVICE_RESET )
   \                     ??ZDApp_event_loop_8:
   \   000095   EE           MOV     A,R6
   \   000096   5404         ANL     A,#0x4
   \   000098   600A         JZ      ??ZDApp_event_loop_9
    460            {
    461          #ifdef ZBA_FALLBACK_NWKKEY
    462              if ( devState == DEV_END_DEVICE_UNAUTH )
    463              {
    464                ZDSecMgrFallbackNwkKey();
    465              }
    466              else
    467          #endif
    468              {
    469                // Set the NV startup option to force a "new" join.
    470                zgWriteStartupOptions( ZG_STARTUP_SET, ZCD_STARTOPT_DEFAULT_NETWORK_STATE );
   \   00009A                ; Setup parameters for call to function zgWriteStartupOptions
   \   00009A   7A02         MOV     R2,#0x2
   \   00009C   79FF         MOV     R1,#-0x1
   \   00009E   12....       LCALL   ??zgWriteStartupOptions?relay
    471          
    472                // The device has been in the UNAUTH state, so reset
    473                // Note: there will be no return from this call
    474                SystemResetSoft();
   \   0000A1                ; Setup parameters for call to function Onboard_soft_reset
   \   0000A1   12....       LCALL   Onboard_soft_reset & 0xFFFF
    475              }
    476            }
    477          
    478            if ( ZG_SECURE_ENABLED )
    479            {
    480              return ( ZDApp_ProcessSecEvent( task_id, events ) );
    481            }
    482            else
    483            {
    484              // Discard or make more handlers
    485              return 0;
   \                     ??ZDApp_event_loop_9:
   \   0000A4   7A00         MOV     R2,#0x0
   \   0000A6   7B00         MOV     R3,#0x0
    486            }
   \                     ??ZDApp_event_loop_4:
   \   0000A8   02....       LJMP    ??Subroutine52_0 & 0xFFFF
    487          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine18:
   \   000000   7A10         MOV     R2,#0x10
   \   000002                REQUIRE ??Subroutine42_0
   \   000002                ; // Fall through to label ??Subroutine42_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine42_0:
   \   000000   7B00         MOV     R3,#0x0
   \   000002   90....       MOV     DPTR,#ZDAppTaskID
   \   000005   E0           MOVX    A,@DPTR
   \   000006   F9           MOV     R1,A
   \   000007   12....       LCALL   ??osal_set_event?relay
   \   00000A   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine49_0:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F9           MOV     R1,A
   \   000002   12....       LCALL   ??osal_start_timerEx?relay
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine52_0:
   \   000000   7F02         MOV     R7,#0x2
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA
    488          
    489          /*********************************************************************
    490           * @fn      ZDApp_ProcessSecEvent()
    491           *
    492           * @brief   Process incoming security events.
    493           *
    494           * @param   task_id - Task ID
    495           * @param   events  - Bitmap of events
    496           *
    497           * @return  none
    498           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    499          UINT16 ZDApp_ProcessSecEvent( uint8 task_id, UINT16 events )
   \                     ZDApp_ProcessSecEvent:
    500          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    501            (void)task_id;  // Intentionally unreferenced parameter
    502          
    503            if ( ZSTACK_ROUTER_BUILD )
    504            {
    505              if ( events & ZDO_NEW_DEVICE )
    506              {
    507                // process the new device event
    508                if ( ZDSecMgrNewDeviceEvent() == TRUE )
    509                {
    510                  osal_start_timerEx( ZDAppTaskID, ZDO_NEW_DEVICE, 1000 );
    511                }
    512          
    513                // Return unprocessed events
    514                return (events ^ ZDO_NEW_DEVICE);
    515              }
    516            }
    517          
    518            if ( (ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH)
    519                || (ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD) )
    520            {
    521              if ( ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE )
    522              {
    523                if ( events & ZDO_SECMGR_EVENT )
    524                {
    525                  ZDSecMgrEvent();
    526          
    527                  // Return unprocessed events
    528                  return (events ^ ZDO_SECMGR_EVENT);
    529                }
    530              }
    531            }
    532          
    533            if ( events & ZDO_DEVICE_AUTH )
   \   000009   EE           MOV     A,R6
   \   00000A   5480         ANL     A,#0x80
   \   00000C   600B         JZ      ??ZDApp_ProcessSecEvent_0
    534            {
    535              ZDApp_DeviceAuthEvt();
   \   00000E                ; Setup parameters for call to function ZDApp_DeviceAuthEvt
   \   00000E   12....       LCALL   ??ZDApp_DeviceAuthEvt?relay
    536          
    537              // Return unprocessed events
    538              return (events ^ ZDO_DEVICE_AUTH);
   \   000011   EE           MOV     A,R6
   \   000012   6480         XRL     A,#0x80
   \   000014   FA           MOV     R2,A
   \   000015   EF           MOV     A,R7
   \                     ??ZDApp_ProcessSecEvent_1:
   \   000016   FB           MOV     R3,A
   \   000017   8049         SJMP    ??ZDApp_ProcessSecEvent_2
    539            }
    540          
    541            if ( events & ZDO_FRAMECOUNTER_CHANGE )
   \                     ??ZDApp_ProcessSecEvent_0:
   \   000019   EF           MOV     A,R7
   \   00001A   5404         ANL     A,#0x4
   \   00001C   6027         JZ      ??ZDApp_ProcessSecEvent_3
    542            {
    543              if ( nwkFrameCounterChanges++ > MAX_NWK_FRAMECOUNTER_CHANGES )
   \   00001E   90....       MOV     DPTR,#nwkFrameCounterChanges
   \   000021   12....       LCALL   ??Subroutine44_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_71:
   \   000024   E8           MOV     A,R0
   \   000025   2401         ADD     A,#0x1
   \   000027   FA           MOV     R2,A
   \   000028   E9           MOV     A,R1
   \   000029   3400         ADDC    A,#0x0
   \   00002B   FB           MOV     R3,A
   \   00002C   90....       MOV     DPTR,#nwkFrameCounterChanges
   \   00002F   12....       LCALL   ??Subroutine61_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_122:
   \   000032   C3           CLR     C
   \   000033   E8           MOV     A,R0
   \   000034   94E9         SUBB    A,#-0x17
   \   000036   E9           MOV     A,R1
   \   000037   9403         SUBB    A,#0x3
   \   000039   4003         JC      ??ZDApp_ProcessSecEvent_4
    544              {
    545                ZDApp_SaveNwkKey();
   \   00003B                ; Setup parameters for call to function ZDApp_SaveNwkKey
   \   00003B   12....       LCALL   ??ZDApp_SaveNwkKey?relay
    546              }
    547          
    548              // Return unprocessed events
    549              return (events ^ ZDO_FRAMECOUNTER_CHANGE);
   \                     ??ZDApp_ProcessSecEvent_4:
   \   00003E   EE           MOV     A,R6
   \   00003F   FA           MOV     R2,A
   \   000040   EF           MOV     A,R7
   \   000041   6404         XRL     A,#0x4
   \   000043   80D1         SJMP    ??ZDApp_ProcessSecEvent_1
    550            }
    551          
    552            if ( events & ZDO_APS_FRAMECOUNTER_CHANGE )
   \                     ??ZDApp_ProcessSecEvent_3:
   \   000045   EF           MOV     A,R7
   \   000046   5410         ANL     A,#0x10
   \   000048   6005         JZ      ??ZDApp_ProcessSecEvent_5
    553            {
    554          #if defined (NV_RESTORE)
    555              ZDSecMgrSaveApsLinkKey();
    556          #endif // (NV_RESTORE)
    557          
    558              // Return unprocessed events
    559              return (events ^ ZDO_APS_FRAMECOUNTER_CHANGE);
   \   00004A   EF           MOV     A,R7
   \   00004B   6410         XRL     A,#0x10
   \   00004D   80C7         SJMP    ??ZDApp_ProcessSecEvent_1
    560            }
    561          
    562            if ( events & ZDO_TCLK_FRAMECOUNTER_CHANGE )
   \                     ??ZDApp_ProcessSecEvent_5:
   \   00004F   EF           MOV     A,R7
   \   000050   5408         ANL     A,#0x8
   \   000052   600A         JZ      ??ZDApp_ProcessSecEvent_6
    563            {
    564              ZDSecMgrSaveTCLinkKey();
   \   000054                ; Setup parameters for call to function ZDSecMgrSaveTCLinkKey
   \   000054   12....       LCALL   ??ZDSecMgrSaveTCLinkKey?relay
    565          
    566              // Return unprocessed events
    567              return (events ^ ZDO_TCLK_FRAMECOUNTER_CHANGE);
   \   000057   EE           MOV     A,R6
   \   000058   FA           MOV     R2,A
   \   000059   EF           MOV     A,R7
   \   00005A   6408         XRL     A,#0x8
   \   00005C   80B8         SJMP    ??ZDApp_ProcessSecEvent_1
    568            }
    569          
    570            // Discard or make more handlers
    571            return 0;
   \                     ??ZDApp_ProcessSecEvent_6:
   \   00005E   7A00         MOV     R2,#0x0
   \   000060   7B00         MOV     R3,#0x0
   \                     ??ZDApp_ProcessSecEvent_2:
   \   000062   02....       LJMP    ??Subroutine50_0 & 0xFFFF
    572          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine44_0:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F8           MOV     R0,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F9           MOV     R1,A
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine61_0:
   \   000000   EA           MOV     A,R2
   \   000001   F0           MOVX    @DPTR,A
   \   000002   A3           INC     DPTR
   \   000003   EB           MOV     A,R3
   \   000004   F0           MOVX    @DPTR,A
   \   000005   22           RET
    573          
    574          /*********************************************************************
    575           * Application Functions
    576           */
    577          
    578          /*********************************************************************
    579           * @fn      ZDOInitDevice
    580           *
    581           * @brief   Start the device in the network.  This function will read
    582           *   ZCD_NV_STARTUP_OPTION (NV item) to determine whether or not to
    583           *   restore the network state of the device.
    584           *
    585           * @param   startDelay - timeDelay to start device (in milliseconds).
    586           *                       There is a jitter added to this delay:
    587           *                       ((NWK_START_DELAY + startDelay)
    588           *                       + (osal_rand() & EXTENDED_JOINING_RANDOM_MASK))
    589           *                       When startDelay is set to ZDO_INIT_HOLD_NWK_START
    590           *                       this function will hold the network init. Application
    591           *                       can start the device.
    592           *
    593           * NOTE:    If the application would like to force a "new" join, the
    594           *          application should set the ZCD_STARTOPT_DEFAULT_NETWORK_STATE
    595           *          bit in the ZCD_NV_STARTUP_OPTION NV item before calling
    596           *          this function. "new" join means to not restore the network
    597           *          state of the device. Use zgWriteStartupOptions() to set these
    598           *          options.
    599           *
    600           * @return
    601           *    ZDO_INITDEV_RESTORED_NETWORK_STATE  - The device's network state was
    602           *          restored.
    603           *    ZDO_INITDEV_NEW_NETWORK_STATE - The network state was initialized.
    604           *          This could mean that ZCD_NV_STARTUP_OPTION said to not restore, or
    605           *          it could mean that there was no network state to restore.
    606           *    ZDO_INITDEV_LEAVE_NOT_STARTED - Before the reset, a network leave was issued
    607           *          with the rejoin option set to TRUE.  So, the device was not
    608           *          started in the network (one time only).  The next time this
    609           *          function is called it will start.
    610           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    611          uint8 ZDOInitDevice( uint16 startDelay )
   \                     ZDOInitDevice:
    612          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   12....       LCALL   ?Subroutine14 & 0xFFFF
    613            uint8 networkStateNV = ZDO_INITDEV_NEW_NETWORK_STATE;
    614            uint16 extendedDelay = 0;
    615          
    616            if ( devState == DEV_HOLD )
   \                     ??CrossCallReturnLabel_127:
   \   00000D   90....       MOV     DPTR,#devState
   \   000010   E0           MOVX    A,@DPTR
   \   000011   7005         JNZ     ??ZDOInitDevice_0
    617            {
    618              // Initialize the RAM items table, in case an NV item has been updated.
    619              zgInitItems( FALSE );
   \   000013                ; Setup parameters for call to function zgInitItems
   \   000013   7900         MOV     R1,#0x0
   \   000015   12....       LCALL   ??zgInitItems?relay
    620            }
    621          
    622            ZDConfig_InitDescriptors();
   \                     ??ZDOInitDevice_0:
   \   000018                ; Setup parameters for call to function ZDConfig_InitDescriptors
   \   000018   12....       LCALL   ??ZDConfig_InitDescriptors?relay
    623            //devtag.071807.todo - fix this temporary solution
    624            _NIB.CapabilityFlags = ZDO_Config_Node_Descriptor.CapabilityFlags;
   \   00001B   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   00001E   E0           MOVX    A,@DPTR
   \   00001F   90....       MOV     DPTR,#_NIB + 14
   \   000022   F0           MOVX    @DPTR,A
    625          
    626          #if defined ( NV_RESTORE )
    627            // Get Keypad directly to see if a reset nv is needed.
    628            // Hold down the SW_BYPASS_NV key (defined in OnBoard.h)
    629            // while booting to skip past NV Restore.
    630            if ( HalKeyRead() == SW_BYPASS_NV )
    631              networkStateNV = ZDO_INITDEV_NEW_NETWORK_STATE;
    632            else
    633            {
    634              // Determine if NV should be restored
    635              networkStateNV = ZDApp_ReadNetworkRestoreState();
    636            }
    637          
    638            if ( networkStateNV == ZDO_INITDEV_RESTORED_NETWORK_STATE )
    639            {
    640              networkStateNV = ZDApp_RestoreNetworkState();
    641            }
    642            else
    643            {
    644              // Wipe out the network state in NV
    645              NLME_InitNV();
    646              NLME_SetDefaultNV();
    647              // clear NWK key values
    648              ZDSecMgrClearNVKeyValues();
    649            }
    650          #endif
    651          
    652            if ( networkStateNV == ZDO_INITDEV_NEW_NETWORK_STATE )
    653            {
    654              ZDAppDetermineDeviceType();
   \   000023                ; Setup parameters for call to function ZDAppDetermineDeviceType
   \   000023   12....       LCALL   ??ZDAppDetermineDeviceType?relay
    655          
    656              // Only delay if joining network - not restoring network state
    657              extendedDelay = (uint16)((NWK_START_DELAY + startDelay)
    658                        + (osal_rand() & EXTENDED_JOINING_RANDOM_MASK));
   \   000026                ; Setup parameters for call to function osal_rand
   \   000026   12....       LCALL   ??osal_rand?relay
   \   000029   85..82       MOV     DPL,?XSP + 0
   \   00002C   85..83       MOV     DPH,?XSP + 1
   \   00002F   EA           MOV     A,R2
   \   000030   547F         ANL     A,#0x7f
   \   000032   F8           MOV     R0,A
   \   000033   E0           MOVX    A,@DPTR
   \   000034   28           ADD     A,R0
   \   000035   F8           MOV     R0,A
   \   000036   A3           INC     DPTR
   \   000037   E0           MOVX    A,@DPTR
   \   000038   3400         ADDC    A,#0x0
   \   00003A   F9           MOV     R1,A
   \   00003B   E8           MOV     A,R0
   \   00003C   2464         ADD     A,#0x64
   \   00003E   FE           MOV     R6,A
   \   00003F   E9           MOV     A,R1
   \   000040   3400         ADDC    A,#0x0
   \   000042   FF           MOV     R7,A
    659            }
    660          
    661            // Initialize the security for type of device
    662            ZDApp_SecInit( networkStateNV );
   \   000043                ; Setup parameters for call to function ZDSecMgrInit
   \   000043   7901         MOV     R1,#0x1
   \   000045   12....       LCALL   ??ZDSecMgrInit?relay
    663          
    664            if( ZDO_INIT_HOLD_NWK_START != startDelay )
   \   000048   85..82       MOV     DPL,?XSP + 0
   \   00004B   85..83       MOV     DPH,?XSP + 1
   \   00004E   E0           MOVX    A,@DPTR
   \   00004F   F4           CPL     A
   \   000050   7003         JNZ     ??ZDOInitDevice_1
   \   000052   A3           INC     DPTR
   \   000053   E0           MOVX    A,@DPTR
   \   000054   F4           CPL     A
   \                     ??ZDOInitDevice_1:
   \   000055   6035         JZ      ??ZDOInitDevice_2
    665            {
    666              devState = DEV_INIT;    // Remove the Hold state
   \   000057   90....       MOV     DPTR,#devState
   \   00005A   7401         MOV     A,#0x1
   \   00005C   F0           MOVX    @DPTR,A
    667          
    668              // Initialize leave control logic
    669              ZDApp_LeaveCtrlInit();
   \   00005D                ; Setup parameters for call to function ZDApp_LeaveCtrlInit
   \   00005D   12....       LCALL   ??ZDApp_LeaveCtrlInit?relay
    670          
    671              // Check leave control reset settings
    672              ZDApp_LeaveCtrlStartup( &devState, &startDelay );
   \   000060                ; Setup parameters for call to function ZDApp_LeaveCtrlStartup
   \   000060   85..82       MOV     DPL,?XSP + 0
   \   000063   85..83       MOV     DPH,?XSP + 1
   \   000066   AC82         MOV     R4,DPL
   \   000068   AD83         MOV     R5,DPH
   \   00006A   7A..         MOV     R2,#devState & 0xff
   \   00006C   7B..         MOV     R3,#(devState >> 8) & 0xff
   \   00006E   12....       LCALL   ??ZDApp_LeaveCtrlStartup?relay
    673          
    674              // Leave may make the hold state come back
    675              if ( devState == DEV_HOLD )
   \   000071   90....       MOV     DPTR,#devState
   \   000074   E0           MOVX    A,@DPTR
   \   000075   700E         JNZ     ??ZDOInitDevice_3
    676              {
    677                // Set the NV startup option to force a "new" join.
    678                zgWriteStartupOptions( ZG_STARTUP_SET, ZCD_STARTOPT_DEFAULT_NETWORK_STATE );
   \   000077                ; Setup parameters for call to function zgWriteStartupOptions
   \   000077   7A02         MOV     R2,#0x2
   \   000079   79FF         MOV     R1,#-0x1
   \   00007B   12....       LCALL   ??zgWriteStartupOptions?relay
    679          
    680                // Notify the applications
    681                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   00007E                ; Setup parameters for call to function osal_set_event
   \   00007E   12....       LCALL   ?Subroutine18 & 0xFFFF
    682          
    683                return ( ZDO_INITDEV_LEAVE_NOT_STARTED );   // Don't join - (one time).
   \                     ??CrossCallReturnLabel_61:
   \   000081   7902         MOV     R1,#0x2
   \   000083   8011         SJMP    ??ZDOInitDevice_4
    684              }
    685          
    686              // Trigger the network start
    687          //********************开启联网功能********************************************//
    688              ZDApp_NetworkInit( extendedDelay );
   \                     ??ZDOInitDevice_3:
   \   000085                ; Setup parameters for call to function ZDApp_NetworkInit
   \   000085   EE           MOV     A,R6
   \   000086   FA           MOV     R2,A
   \   000087   EF           MOV     A,R7
   \   000088   FB           MOV     R3,A
   \   000089   12....       LCALL   ??ZDApp_NetworkInit?relay
    689            }
    690          
    691            // set broadcast address mask to support broadcast filtering
    692            NLME_SetBroadcastFilter( ZDO_Config_Node_Descriptor.CapabilityFlags );
   \                     ??ZDOInitDevice_2:
   \   00008C                ; Setup parameters for call to function NLME_SetBroadcastFilter
   \   00008C   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   00008F   E0           MOVX    A,@DPTR
   \   000090   F9           MOV     R1,A
   \   000091   12....       LCALL   ??NLME_SetBroadcastFilter?relay
    693          
    694            return ( networkStateNV );
   \   000094   7901         MOV     R1,#0x1
   \                     ??ZDOInitDevice_4:
   \   000096                REQUIRE ?Subroutine7
   \   000096                ; // Fall through to label ?Subroutine7
    695          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine7:
   \   000000   7402         MOV     A,#0x2
   \   000002   02....       LJMP    ??Subroutine51_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine51_0:
   \   000000   12....       LCALL   ?DEALLOC_XSTACK8
   \   000003                REQUIRE ??Subroutine52_0
   \   000003                ; // Fall through to label ??Subroutine52_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine14:
   \   000000   85..82       MOV     DPL,?XSP + 0
   \   000003   85..83       MOV     DPH,?XSP + 1
   \   000006                REQUIRE ??Subroutine61_0
   \   000006                ; // Fall through to label ??Subroutine61_0
    696          
    697          /*********************************************************************
    698           * @fn      ZDApp_ReadNetworkRestoreState
    699           *
    700           * @brief   Read the ZCD_NV_STARTUP_OPTION NV Item to state whether
    701           *          or not to restore the network state.
    702           *          If the read value has the ZCD_STARTOPT_DEFAULT_NETWORK_STATE
    703           *          bit set return the ZDO_INITDEV_NEW_NETWORK_STATE.
    704           *
    705           * @param   none
    706           *
    707           * @return  ZDO_INITDEV_NEW_NETWORK_STATE
    708           *          or ZDO_INITDEV_RESTORED_NETWORK_STATE based on whether or
    709           *          not ZCD_STARTOPT_DEFAULT_NETWORK_STATE bit is set in
    710           *          ZCD_NV_STARTUP_OPTION
    711           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    712          uint8 ZDApp_ReadNetworkRestoreState( void )
   \                     ZDApp_ReadNetworkRestoreState:
    713          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    714            uint8 networkStateNV = ZDO_INITDEV_RESTORED_NETWORK_STATE;
   \   000005   7E00         MOV     R6,#0x0
    715          
    716            // Look for the New Network State option.
    717            if ( zgReadStartupOptions() & ZCD_STARTOPT_DEFAULT_NETWORK_STATE )
   \   000007                ; Setup parameters for call to function zgReadStartupOptions
   \   000007   12....       LCALL   ??zgReadStartupOptions?relay
   \   00000A   E9           MOV     A,R1
   \   00000B   A2E1         MOV     C,0xE0 /* A   */.1
   \   00000D   5001         JNC     ??ZDApp_ReadNetworkRestoreState_0
    718            {
    719              networkStateNV = ZDO_INITDEV_NEW_NETWORK_STATE;
   \   00000F   0E           INC     R6
    720            }
    721          
    722            return ( networkStateNV );
   \                     ??ZDApp_ReadNetworkRestoreState_0:
   \   000010   EE           MOV     A,R6
   \   000011   F9           MOV     R1,A
   \   000012   02....       LJMP    ??Subroutine50_0 & 0xFFFF
    723          }
    724          
    725          /*********************************************************************
    726           * @fn      ZDAppDetermineDeviceType()
    727           *
    728           * @brief   Determines the type of device to start.
    729           *
    730           *          Looks at zgDeviceLogicalType and determines what type of
    731           *          device to start.  The types are:
    732           *            ZG_DEVICETYPE_COORDINATOR
    733           *            ZG_DEVICETYPE_ROUTER
    734           *            ZG_DEVICETYPE_ENDDEVICE
    735           *
    736           * @param   none
    737           *
    738           * @return  none
    739           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    740          void ZDAppDetermineDeviceType( void )
   \                     ZDAppDetermineDeviceType:
    741          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    742            if ( zgDeviceLogicalType == ZG_DEVICETYPE_COORDINATOR )
   \   000004   90....       MOV     DPTR,#zgDeviceLogicalType
   \   000007   E0           MOVX    A,@DPTR
   \   000008   700E         JNZ     ??ZDAppDetermineDeviceType_0
    743            {
    744              devStartMode = MODE_HARD;     // Start as a coordinator
   \   00000A   90....       MOV     DPTR,#devStartMode
   \   00000D   7402         MOV     A,#0x2
   \   00000F   F0           MOVX    @DPTR,A
    745              ZDO_Config_Node_Descriptor.LogicalType = NODETYPE_COORDINATOR;
   \   000010   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000013   E0           MOVX    A,@DPTR
   \   000014   54F8         ANL     A,#0xf8
   \   000016   802E         SJMP    ??ZDAppDetermineDeviceType_1
    746            }
    747            else
    748            {
    749              if ( zgDeviceLogicalType == ZG_DEVICETYPE_ROUTER  )
   \                     ??ZDAppDetermineDeviceType_0:
   \   000018   6401         XRL     A,#0x1
   \   00001A   700A         JNZ     ??ZDAppDetermineDeviceType_2
    750                ZDO_Config_Node_Descriptor.LogicalType = NODETYPE_ROUTER;
   \   00001C   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   00001F   E0           MOVX    A,@DPTR
   \   000020   54F8         ANL     A,#0xf8
   \   000022   4401         ORL     A,#0x1
   \   000024   800D         SJMP    ??ZDAppDetermineDeviceType_3
    751              else if ( zgDeviceLogicalType == ZG_DEVICETYPE_ENDDEVICE )
   \                     ??ZDAppDetermineDeviceType_2:
   \   000026   E0           MOVX    A,@DPTR
   \   000027   6402         XRL     A,#0x2
   \   000029   7009         JNZ     ??ZDAppDetermineDeviceType_4
    752                ZDO_Config_Node_Descriptor.LogicalType = NODETYPE_DEVICE;
   \   00002B   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   00002E   E0           MOVX    A,@DPTR
   \   00002F   54F8         ANL     A,#0xf8
   \   000031   4402         ORL     A,#0x2
   \                     ??ZDAppDetermineDeviceType_3:
   \   000033   F0           MOVX    @DPTR,A
    753          
    754              // If AIB_apsUseExtendedPANID is set to a non-zero value by commissioning
    755              // The device shall do rejoin the network. Otherwise, do normal join
    756              if ( nwk_ExtPANIDValid( AIB_apsUseExtendedPANID ) == false )
   \                     ??ZDAppDetermineDeviceType_4:
   \   000034                ; Setup parameters for call to function nwk_ExtPANIDValid
   \   000034   7A..         MOV     R2,#AIB_apsUseExtendedPANID & 0xff
   \   000036   7B..         MOV     R3,#(AIB_apsUseExtendedPANID >> 8) & 0xff
   \   000038   12....       LCALL   ??nwk_ExtPANIDValid?relay
   \   00003B   E9           MOV     A,R1
   \   00003C   90....       MOV     DPTR,#devStartMode
   \   00003F   7003         JNZ     ??ZDAppDetermineDeviceType_5
    757              {
    758                devStartMode = MODE_JOIN;     // Assume joining
   \   000041   E4           CLR     A
   \   000042   8002         SJMP    ??ZDAppDetermineDeviceType_1
    759              }
    760              else
    761              {
    762                devStartMode = MODE_REJOIN;
   \                     ??ZDAppDetermineDeviceType_5:
   \   000044   7403         MOV     A,#0x3
   \                     ??ZDAppDetermineDeviceType_1:
   \   000046   F0           MOVX    @DPTR,A
    763              }
    764            }
    765          }
   \   000047   02....       LJMP    ?Subroutine2 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   D083         POP     DPH
   \   000002   D082         POP     DPL
   \   000004   02....       LJMP    ?BRET
    766          
    767          /*********************************************************************
    768           * @fn      ZDApp_NetworkStartEvt()
    769           *
    770           * @brief   Process the Network Start Event
    771           *
    772           * @param   none
    773           *
    774           * @return  none
    775           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    776          void ZDApp_NetworkStartEvt( void )
   \                     ZDApp_NetworkStartEvt:
    777          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    778            if ( nwkStatus == ZSuccess )
   \   000004   90....       MOV     DPTR,#nwkStatus
   \   000007   E0           MOVX    A,@DPTR
   \   000008   7012         JNZ     ??ZDApp_NetworkStartEvt_0
    779            {
    780              // Successfully started a ZigBee network
    781              if ( devState == DEV_COORD_STARTING )
   \   00000A   90....       MOV     DPTR,#devState
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   6408         XRL     A,#0x8
   \   000010   7003         JNZ     ??ZDApp_NetworkStartEvt_1
    782              {
    783                devState = DEV_ZB_COORD;
   \   000012   7409         MOV     A,#0x9
   \   000014   F0           MOVX    @DPTR,A
    784              }
    785          
    786              osal_pwrmgr_device( PWRMGR_ALWAYS_ON );
   \                     ??ZDApp_NetworkStartEvt_1:
   \   000015                ; Setup parameters for call to function osal_pwrmgr_device
   \   000015   7900         MOV     R1,#0x0
   \   000017   12....       LCALL   ??osal_pwrmgr_device?relay
    787              osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   00001A                ; Setup parameters for call to function osal_set_event
   \   00001A   802B         SJMP    ??ZDApp_NetworkStartEvt_2
    788            }
    789            else
    790            {
    791              // Try again with a higher energy threshold !!
    792              if ( ( NLME_GetEnergyThreshold() + ENERGY_SCAN_INCREMENT ) < 0xff )
   \                     ??ZDApp_NetworkStartEvt_0:
   \   00001C                ; Setup parameters for call to function NLME_GetEnergyThreshold
   \   00001C   12....       LCALL   ??NLME_GetEnergyThreshold?relay
   \   00001F   E9           MOV     A,R1
   \   000020   2410         ADD     A,#0x10
   \   000022   F8           MOV     R0,A
   \   000023   E4           CLR     A
   \   000024   3400         ADDC    A,#0x0
   \   000026   F9           MOV     R1,A
   \   000027   E8           MOV     A,R0
   \   000028   94FF         SUBB    A,#-0x1
   \   00002A   E9           MOV     A,R1
   \   00002B   9400         SUBB    A,#0x0
   \   00002D   C3           CLR     C
   \   00002E   65D0         XRL     A,PSW
   \   000030   33           RLC     A
   \   000031   500E         JNC     ??ZDApp_NetworkStartEvt_3
    793              {
    794                NLME_SetEnergyThreshold( (uint8)(NLME_GetEnergyThreshold() + ENERGY_SCAN_INCREMENT) );
   \   000033                ; Setup parameters for call to function NLME_SetEnergyThreshold
   \   000033                ; Setup parameters for call to function NLME_GetEnergyThreshold
   \   000033   12....       LCALL   ??NLME_GetEnergyThreshold?relay
   \   000036   E9           MOV     A,R1
   \   000037   2410         ADD     A,#0x10
   \   000039   F9           MOV     R1,A
   \   00003A   12....       LCALL   ??NLME_SetEnergyThreshold?relay
    795                osal_set_event( ZDAppTaskID, ZDO_NETWORK_INIT );
   \   00003D                ; Setup parameters for call to function osal_set_event
   \   00003D   7A01         MOV     R2,#0x1
   \   00003F   8008         SJMP    ??ZDApp_NetworkStartEvt_4
    796              }
    797              else
    798              {
    799                // Failed to start network. Enter a dormant state (until user intervenes)
    800                devState = DEV_INIT;
   \                     ??ZDApp_NetworkStartEvt_3:
   \   000041   90....       MOV     DPTR,#devState
   \   000044   7401         MOV     A,#0x1
   \   000046   F0           MOVX    @DPTR,A
    801                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   000047                ; Setup parameters for call to function osal_set_event
   \                     ??ZDApp_NetworkStartEvt_2:
   \   000047   7A10         MOV     R2,#0x10
    802              }
    803            }
   \                     ??ZDApp_NetworkStartEvt_4:
   \   000049   12....       LCALL   ??Subroutine42_0 & 0xFFFF
    804          }
   \                     ??CrossCallReturnLabel_65:
   \   00004C   02....       LJMP    ?Subroutine2 & 0xFFFF
    805          
    806          /*********************************************************************
    807           * @fn      ZDApp_DeviceAuthEvt()
    808           *
    809           * @brief   Process the Device Authentic Event
    810           *
    811           * @param   none
    812           *
    813           * @return  none
    814           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    815          void ZDApp_DeviceAuthEvt( void )
   \                     ZDApp_DeviceAuthEvt:
    816          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    817            // received authentication from trust center
    818            if ( devState == DEV_END_DEVICE_UNAUTH )
   \   000004   90....       MOV     DPTR,#devState
   \   000007   E0           MOVX    A,@DPTR
   \   000008   6405         XRL     A,#0x5
   \   00000A   701D         JNZ     ??ZDApp_DeviceAuthEvt_0
    819            {
    820              // Stop the reset timer so it doesn't reset
    821              ZDApp_ResetTimerCancel();
   \   00000C                ; Setup parameters for call to function ZDApp_ResetTimerCancel
   \   00000C   12....       LCALL   ??ZDApp_ResetTimerCancel?relay
    822          
    823              devState = DEV_END_DEVICE;
   \   00000F   12....       LCALL   ?Subroutine9 & 0xFFFF
    824              osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
    825          
    826              // Set the Power Manager Device
    827          #if defined ( POWER_SAVING )
    828              osal_pwrmgr_device( PWRMGR_BATTERY );
    829          #endif
    830          
    831              if ( ZSTACK_ROUTER_BUILD )
    832              {
    833                if ( ZDO_Config_Node_Descriptor.LogicalType != NODETYPE_DEVICE )
    834                {
    835                  // NOTE: first two parameters are not used, see NLMEDE.h for details
    836                  NLME_StartRouterRequest( 0, 0, false );
    837                }
    838              }
    839          
    840              // Notify to save info into NV
    841              ZDApp_NVUpdate();
    842          
    843              // Save off the security
    844              ZDApp_SaveNwkKey();
   \                     ??CrossCallReturnLabel_0:
   \   000012                ; Setup parameters for call to function ZDApp_SaveNwkKey
   \   000012   12....       LCALL   ??ZDApp_SaveNwkKey?relay
    845          
    846              ZDApp_AnnounceNewAddress();
   \   000015                ; Setup parameters for call to function ZDApp_AnnounceNewAddress
   \   000015   12....       LCALL   ??ZDApp_AnnounceNewAddress?relay
    847          
    848              if ( (ZDO_Config_Node_Descriptor.CapabilityFlags & CAPINFO_RCVR_ON_IDLE) == 0 )
   \   000018   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   00001B   E0           MOVX    A,@DPTR
   \   00001C   A2E3         MOV     C,0xE0 /* A   */.3
   \   00001E   4009         JC      ??ZDApp_DeviceAuthEvt_0
    849              {
    850                NLME_SetPollRate( ZDApp_SavedPollRate );
   \   000020                ; Setup parameters for call to function NLME_SetPollRate
   \   000020   90....       MOV     DPTR,#ZDApp_SavedPollRate
   \   000023   12....       LCALL   ?Subroutine24 & 0xFFFF
    851              }
    852            }
   \                     ??CrossCallReturnLabel_28:
   \   000026   12....       LCALL   ??NLME_SetPollRate?relay
    853            else
    854            {
    855              ZDApp_NVUpdate();
    856            }
    857          }
   \                     ??ZDApp_DeviceAuthEvt_0:
   \   000029   02....       LJMP    ?Subroutine2 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine9:
   \   000000   90....       MOV     DPTR,#devState
   \   000003   7406         MOV     A,#0x6
   \   000005   F0           MOVX    @DPTR,A
   \   000006                ; Setup parameters for call to function osal_set_event
   \   000006                ; Setup parameters for call to function osal_set_event
   \   000006   7A10         MOV     R2,#0x10
   \   000008   7B00         MOV     R3,#0x0
   \   00000A   90....       MOV     DPTR,#ZDAppTaskID
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   F9           MOV     R1,A
   \   00000F   12....       LCALL   ??osal_set_event?relay
   \   000012                ; Setup parameters for call to function osal_pwrmgr_device
   \   000012                ; Setup parameters for call to function osal_pwrmgr_device
   \   000012   7901         MOV     R1,#0x1
   \   000014   12....       LCALL   ??osal_pwrmgr_device?relay
   \   000017   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine24:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   FA           MOV     R2,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   FB           MOV     R3,A
   \   000005   22           RET
    858          
    859          /*********************************************************************
    860           * @fn      ZDApp_SaveNetworkStateEvt()
    861           *
    862           * @brief   Process the Save the Network State Event
    863           *
    864           * @param   none
    865           *
    866           * @return  none
    867           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    868          void ZDApp_SaveNetworkStateEvt( void )
   \                     ZDApp_SaveNetworkStateEvt:
    869          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    870          #if defined ( NV_RESTORE )
    871           #if defined ( NV_TURN_OFF_RADIO )
    872            // Turn off the radio's receiver during an NV update
    873            uint8 RxOnIdle;
    874            uint8 x = false;
    875            ZMacGetReq( ZMacRxOnIdle, &RxOnIdle );
    876            ZMacSetReq( ZMacRxOnIdle, &x );
    877           #endif
    878          
    879            // Update the Network State in NV
    880            NLME_UpdateNV( NWK_NV_NIB_ENABLE        |
    881                           NWK_NV_DEVICELIST_ENABLE |
    882                           NWK_NV_BINDING_ENABLE    |
    883                           NWK_NV_ADDRMGR_ENABLE );
    884          
    885            // Reset the NV startup option to resume from NV by
    886            // clearing the "New" join option.
    887            zgWriteStartupOptions( FALSE, ZCD_STARTOPT_DEFAULT_NETWORK_STATE );
    888          
    889           #if defined ( NV_TURN_OFF_RADIO )
    890            ZMacSetReq( ZMacRxOnIdle, &RxOnIdle );
    891           #endif
    892          #endif  // NV_RESTORE
    893          }
   \   000000   02....       LJMP    ?BRET
    894          
    895          /*********************************************************************
    896           * @fn      ZDApp_RestoreNetworkState()
    897           *
    898           * @brief   This function will restore the network state of the
    899           *          device if the network state is stored in NV.
    900           *
    901           * @param   none
    902           *
    903           * @return
    904           *    ZDO_INITDEV_RESTORED_NETWORK_STATE  - The device's network state was
    905           *          restored.
    906           *    ZDO_INITDEV_NEW_NETWORK_STATE - The network state was not used.
    907           *          This could mean that zgStartupOption said to not restore, or
    908           *          it could mean that there was no network state to restore.
    909           *
    910           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    911          uint8 ZDApp_RestoreNetworkState( void )
   \                     ZDApp_RestoreNetworkState:
    912          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    913            uint8 nvStat;
    914          
    915            // Initialize NWK NV items
    916            nvStat = NLME_InitNV();
   \   000005                ; Setup parameters for call to function NLME_InitNV
   \   000005   12....       LCALL   ??NLME_InitNV?relay
   \   000008   E9           MOV     A,R1
   \   000009   FE           MOV     R6,A
    917          
    918            if ( nvStat != NV_OPER_FAILED )
   \   00000A   740A         MOV     A,#0xa
   \   00000C   6E           XRL     A,R6
   \   00000D   602D         JZ      ??ZDApp_RestoreNetworkState_0
    919            {
    920              if ( NLME_RestoreFromNV() )
   \   00000F                ; Setup parameters for call to function NLME_RestoreFromNV
   \   00000F   12....       LCALL   ??NLME_RestoreFromNV?relay
   \   000012   E9           MOV     A,R1
   \   000013   6027         JZ      ??ZDApp_RestoreNetworkState_0
    921              {
    922                // Are we a coordinator
    923                ZDAppNwkAddr.addr.shortAddr = NLME_GetShortAddr();
   \   000015                ; Setup parameters for call to function NLME_GetShortAddr
   \   000015   12....       LCALL   ??NLME_GetShortAddr?relay
   \   000018   90....       MOV     DPTR,#ZDAppNwkAddr
   \   00001B   12....       LCALL   ??Subroutine61_0 & 0xFFFF
    924                if ( ZDAppNwkAddr.addr.shortAddr == 0 )
   \                     ??CrossCallReturnLabel_123:
   \   00001E   90....       MOV     DPTR,#ZDAppNwkAddr
   \   000021   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_12:
   \   000024   7007         JNZ     ??ZDApp_RestoreNetworkState_1
    925                  ZDO_Config_Node_Descriptor.LogicalType = NODETYPE_COORDINATOR;
   \   000026   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000029   E0           MOVX    A,@DPTR
   \   00002A   54F8         ANL     A,#0xf8
   \   00002C   F0           MOVX    @DPTR,A
    926                devStartMode = MODE_RESUME;
   \                     ??ZDApp_RestoreNetworkState_1:
   \   00002D   90....       MOV     DPTR,#devStartMode
   \   000030   7401         MOV     A,#0x1
   \   000032   12....       LCALL   ?Subroutine11 & 0xFFFF
    927                osal_cpyExtAddr( ZDO_UseExtendedPANID, _NIB.extendedPANID );
    928              }
    929              else
    930                nvStat = NV_ITEM_UNINIT;
    931          
    932              if ( ZG_SECURE_ENABLED )
    933              {
    934                nwkFrameCounterChanges = 0;
    935          
    936                if ( ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE )
    937                {
    938                  ZDApp_RestoreNwkKey();
    939                }
    940              }
    941          
    942              // The default for RxOnWhenIdle is true for Routers and false for end devices
    943              // [setup in the NLME_RestoreFromNV()].  Change it here if you want something
    944              // other than default.
    945            }
    946          
    947            if ( nvStat == ZSUCCESS )
   \                     ??CrossCallReturnLabel_4:
   \   000035   EE           MOV     A,R6
   \   000036   7004         JNZ     ??ZDApp_RestoreNetworkState_0
    948              return ( ZDO_INITDEV_RESTORED_NETWORK_STATE );
   \   000038   7900         MOV     R1,#0x0
   \   00003A   8002         SJMP    ??ZDApp_RestoreNetworkState_2
    949            else
    950              return ( ZDO_INITDEV_NEW_NETWORK_STATE );
   \                     ??ZDApp_RestoreNetworkState_0:
   \   00003C   7901         MOV     R1,#0x1
   \                     ??ZDApp_RestoreNetworkState_2:
   \   00003E   02....       LJMP    ??Subroutine50_0 & 0xFFFF
    951          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine11:
   \   000000   F0           MOVX    @DPTR,A
   \   000001                ; Setup parameters for call to function sAddrExtCpy
   \   000001                ; Setup parameters for call to function sAddrExtCpy
   \   000001   7C..         MOV     R4,#(_NIB + 53) & 0xff
   \   000003   7D..         MOV     R5,#((_NIB + 53) >> 8) & 0xff
   \   000005   7A..         MOV     R2,#ZDO_UseExtendedPANID & 0xff
   \   000007   7B..         MOV     R3,#(ZDO_UseExtendedPANID >> 8) & 0xff
   \   000009   12....       LCALL   ??sAddrExtCpy?relay
   \   00000C   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine16:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F8           MOV     R0,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F9           MOV     R1,A
   \   000005   E8           MOV     A,R0
   \   000006   49           ORL     A,R1
   \   000007   22           RET
    952          
    953          /*********************************************************************
    954           * @fn      ZDApp_InitUserDesc()
    955           *
    956           * @brief   Initialize the User Descriptor, the descriptor is read from NV
    957           *          when needed.  If you want to initialize the User descriptor to
    958           *          something other than all zero, do it here.
    959           *
    960           * @param   none
    961           *
    962           * @return  none
    963           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    964          void ZDApp_InitUserDesc( void )
   \                     ZDApp_InitUserDesc:
    965          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 17
   \   000005   74EF         MOV     A,#-0x11
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    966            UserDescriptorFormat_t ZDO_DefaultUserDescriptor;
    967          
    968            // Initialize the User Descriptor, the descriptor is read from NV
    969            // when needed.  If you want to initialize the User descriptor to something
    970            // other than all zero, do it here.
    971            osal_memset( &ZDO_DefaultUserDescriptor, 0, sizeof( UserDescriptorFormat_t ) );
   \   00000A                ; Setup parameters for call to function osal_memset
   \   00000A   7C11         MOV     R4,#0x11
   \   00000C   12....       LCALL   ?Subroutine33 & 0xFFFF
    972            if ( ZSUCCESS == osal_nv_item_init( ZCD_NV_USERDESC,
    973                   sizeof(UserDescriptorFormat_t), (void*)&ZDO_DefaultUserDescriptor ) )
   \                     ??CrossCallReturnLabel_42:
   \   00000F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000012   7C11         MOV     R4,#0x11
   \   000014   7D00         MOV     R5,#0x0
   \   000016   7A81         MOV     R2,#-0x7f
   \   000018   7B00         MOV     R3,#0x0
   \   00001A   12....       LCALL   ??osal_nv_item_init?relay
   \   00001D   7402         MOV     A,#0x2
   \   00001F   12....       LCALL   ?DEALLOC_XSTACK8
   \   000022   E9           MOV     A,R1
   \   000023   702F         JNZ     ??ZDApp_InitUserDesc_0
    974            {
    975              if ( ZSUCCESS == osal_nv_read( ZCD_NV_USERDESC, 0,
    976                   sizeof(UserDescriptorFormat_t), (void*)&ZDO_DefaultUserDescriptor ) )
   \   000025                ; Setup parameters for call to function osal_nv_read
   \   000025   78..         MOV     R0,#?V0 + 0
   \   000027   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00002A   75..11       MOV     ?V0 + 0,#0x11
   \   00002D   75..00       MOV     ?V0 + 1,#0x0
   \   000030   78..         MOV     R0,#?V0 + 0
   \   000032   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000035   7C00         MOV     R4,#0x0
   \   000037   7D00         MOV     R5,#0x0
   \   000039   7A81         MOV     R2,#-0x7f
   \   00003B   12....       LCALL   ?Subroutine35 & 0xFFFF
   \                     ??CrossCallReturnLabel_44:
   \   00003E   12....       LCALL   ?DEALLOC_XSTACK8
   \   000041   E9           MOV     A,R1
   \   000042   7010         JNZ     ??ZDApp_InitUserDesc_0
    977              {
    978                if ( ZDO_DefaultUserDescriptor.len != 0 )
   \   000044   85..82       MOV     DPL,?XSP + 0
   \   000047   85..83       MOV     DPH,?XSP + 1
   \   00004A   E0           MOVX    A,@DPTR
   \   00004B   6007         JZ      ??ZDApp_InitUserDesc_0
    979                {
    980                  ZDO_Config_Node_Descriptor.UserDescAvail = TRUE;
   \   00004D   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000050   E0           MOVX    A,@DPTR
   \   000051   D2E4         SETB    0xE0 /* A   */.4
   \   000053   F0           MOVX    @DPTR,A
    981                }
    982              }
    983            }
    984          }
   \                     ??ZDApp_InitUserDesc_0:
   \   000054   7411         MOV     A,#0x11
   \   000056   02....       LJMP    ??Subroutine51_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine33:
   \   000000   7D00         MOV     R5,#0x0
   \   000002   7900         MOV     R1,#0x0
   \   000004   85..82       MOV     DPL,?XSP + 0
   \   000007   85..83       MOV     DPH,?XSP + 1
   \   00000A   AA82         MOV     R2,DPL
   \   00000C   AB83         MOV     R3,DPH
   \   00000E   12....       LCALL   ??osal_memset?relay
   \   000011                ; Setup parameters for call to function osal_nv_item_init
   \   000011                ; Setup parameters for call to function osal_nv_write
   \   000011   85..82       MOV     DPL,?XSP + 0
   \   000014   85..83       MOV     DPH,?XSP + 1
   \   000017   8582..       MOV     ?V0 + 0,DPL
   \   00001A   8583..       MOV     ?V0 + 1,DPH
   \   00001D   78..         MOV     R0,#?V0 + 0
   \   00001F   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine35:
   \   000000   7B00         MOV     R3,#0x0
   \   000002   12....       LCALL   ??osal_nv_read?relay
   \   000005   7404         MOV     A,#0x4
   \   000007   22           RET
    985          
    986          /*********************************************************************
    987           * @fn      ZDAppCheckForHoldKey()
    988           *
    989           * @brief   Check for key to set the device into Hold Auto Start
    990           *
    991           * @param   none
    992           *
    993           * @return  none
    994           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    995          void ZDAppCheckForHoldKey( void )
   \                     ZDAppCheckForHoldKey:
    996          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    997          #if (defined HAL_KEY) && (HAL_KEY == TRUE)
    998            // Get Keypad directly to see if a HOLD_START is needed.
    999            // Hold down the SW_BYPASS_START key (see OnBoard.h)
   1000            // while booting to avoid starting up the device.
   1001            if ( HalKeyRead () == SW_BYPASS_START)
   \   000004                ; Setup parameters for call to function HalKeyRead
   \   000004   12....       LCALL   ??HalKeyRead?relay
   \   000007   E9           MOV     A,R1
   \   000008   6401         XRL     A,#0x1
   \   00000A   7005         JNZ     ??ZDAppCheckForHoldKey_0
   1002            {
   1003              // Change the device state to HOLD on start up
   1004              devState = DEV_HOLD;
   \   00000C   90....       MOV     DPTR,#devState
   \   00000F   E4           CLR     A
   \   000010   F0           MOVX    @DPTR,A
   1005            }
   1006          #endif // HAL_KEY
   1007          }
   \                     ??ZDAppCheckForHoldKey_0:
   \   000011   02....       LJMP    ?Subroutine2 & 0xFFFF
   1008          
   1009          /*********************************************************************
   1010           * @fn      ZDApp_ProcessOSALMsg()
   1011           *
   1012           * @brief   Process the incoming task message.
   1013           *
   1014           * @param   msgPtr - message to process
   1015           *
   1016           * @return  none
   1017           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1018          void ZDApp_ProcessOSALMsg( osal_event_hdr_t *msgPtr )
   \                     ZDApp_ProcessOSALMsg:
   1019          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1020            // Data Confirmation message fields
   1021            uint8 sentEP;       // This should always be 0
   1022            uint8 sentStatus;
   1023            afDataConfirm_t *afDataConfirm;
   1024            uint8 tmp;
   1025          
   1026            switch ( msgPtr->event )
   \   00000A   8A82         MOV     DPL,R2
   \   00000C   8B83         MOV     DPH,R3
   \   00000E   E0           MOVX    A,@DPTR
   \   00000F   14           DEC     A
   \   000010   6023         JZ      ??ZDApp_ProcessOSALMsg_0
   \   000012   14           DEC     A
   \   000013   7003         JNZ     $+5
   \   000015   02....       LJMP    ??ZDApp_ProcessOSALMsg_1 & 0xFFFF
   \   000018   14           DEC     A
   \   000019   7003         JNZ     $+5
   \   00001B   02....       LJMP    ??ZDApp_ProcessOSALMsg_2 & 0xFFFF
   \   00001E   24E9         ADD     A,#-0x17
   \   000020   6007         JZ      ??ZDApp_ProcessOSALMsg_3
   \   000022   2447         ADD     A,#0x47
   \   000024   6009         JZ      ??ZDApp_ProcessOSALMsg_4
   \   000026   02....       LJMP    ??ZDApp_ProcessOSALMsg_5 & 0xFFFF
   1027            {
   1028              // Incoming ZDO Message
   1029              case AF_INCOMING_MSG_CMD:
   1030                ZDP_IncomingData( (afIncomingMSGPacket_t *)msgPtr );
   \                     ??ZDApp_ProcessOSALMsg_3:
   \   000029                ; Setup parameters for call to function ZDP_IncomingData
   \   000029   12....       LCALL   ??ZDP_IncomingData?relay
   1031                break;
   \   00002C   02....       LJMP    ??ZDApp_ProcessOSALMsg_5 & 0xFFFF
   1032          
   1033              case ZDO_CB_MSG:
   1034                ZDApp_ProcessMsgCBs( (zdoIncomingMsg_t *)msgPtr );
   \                     ??ZDApp_ProcessOSALMsg_4:
   \   00002F                ; Setup parameters for call to function ZDApp_ProcessMsgCBs
   \   00002F   12....       LCALL   ??ZDApp_ProcessMsgCBs?relay
   1035                break;
   \   000032   02....       LJMP    ??ZDApp_ProcessOSALMsg_5 & 0xFFFF
   1036          
   1037              case AF_DATA_CONFIRM_CMD:
   1038                // This message is received as a confirmation of a data packet sent.
   1039                // The status is of ZStatus_t type [defined in NLMEDE.h]
   1040                // The message fields are defined in AF.h
   1041                afDataConfirm = (afDataConfirm_t *)msgPtr;
   1042                sentEP = afDataConfirm->endpoint;
   1043                sentStatus = afDataConfirm->hdr.status;
   1044          
   1045                // Action taken when confirmation is received.
   1046          #if defined ( ZIGBEE_FREQ_AGILITY )
   1047                if ( pZDNwkMgr_ProcessDataConfirm )
   1048                  pZDNwkMgr_ProcessDataConfirm( afDataConfirm );
   1049          #endif
   1050                (void)sentEP;
   1051                (void)sentStatus;
   1052                break;
   1053          
   1054          //*******************触发DISC事件*********************************************//
   1055              case ZDO_NWK_DISC_CNF:
   1056                if (devState != DEV_NWK_DISC)
   \                     ??ZDApp_ProcessOSALMsg_0:
   \   000035   90....       MOV     DPTR,#devState
   \   000038   E0           MOVX    A,@DPTR
   \   000039   6402         XRL     A,#0x2
   \   00003B   6003         JZ      $+5
   \   00003D   02....       LJMP    ??ZDApp_ProcessOSALMsg_5 & 0xFFFF
   1057                  break;
   1058          
   1059                if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   \   000040   90....       MOV     DPTR,#zgDeviceLogicalType
   \   000043   E0           MOVX    A,@DPTR
   \   000044   6401         XRL     A,#0x1
   \   000046   6008         JZ      ??ZDApp_ProcessOSALMsg_6
   \   000048   E0           MOVX    A,@DPTR
   \   000049   6402         XRL     A,#0x2
   \   00004B   6003         JZ      $+5
   \   00004D   02....       LJMP    ??ZDApp_ProcessOSALMsg_5 & 0xFFFF
   1060                {
   1061                  // Process the network discovery scan results and choose a parent
   1062                  // device to join/rejoin itself
   1063                  networkDesc_t *pChosenNwk;
   1064                  if ( ( (pChosenNwk = ZDApp_NwkDescListProcessing()) != NULL ) && (zdoDiscCounter > NUM_DISC_ATTEMPTS) )
   \                     ??ZDApp_ProcessOSALMsg_6:
   \   000050                ; Setup parameters for call to function ZDApp_NwkDescListProcessing
   \   000050   12....       LCALL   ??ZDApp_NwkDescListProcessing?relay
   \   000053   8A..         MOV     ?V0 + 0,R2
   \   000055   8B..         MOV     ?V0 + 1,R3
   \   000057   A8..         MOV     R0,?V0 + 0
   \   000059   A9..         MOV     R1,?V0 + 1
   \   00005B   E8           MOV     A,R0
   \   00005C   FE           MOV     R6,A
   \   00005D   E9           MOV     A,R1
   \   00005E   FF           MOV     R7,A
   \   00005F   E8           MOV     A,R0
   \   000060   49           ORL     A,R1
   \   000061   7003         JNZ     $+5
   \   000063   02....       LJMP    ??ZDApp_ProcessOSALMsg_7 & 0xFFFF
   \   000066   90....       MOV     DPTR,#zdoDiscCounter
   \   000069   E0           MOVX    A,@DPTR
   \   00006A   C3           CLR     C
   \   00006B   9403         SUBB    A,#0x3
   \   00006D   5003         JNC     $+5
   \   00006F   02....       LJMP    ??ZDApp_ProcessOSALMsg_7 & 0xFFFF
   1065                  {
   1066                    if ( devStartMode == MODE_JOIN )
   \   000072   90....       MOV     DPTR,#devStartMode
   \   000075   E0           MOVX    A,@DPTR
   \   000076   7059         JNZ     ??ZDApp_ProcessOSALMsg_8
   1067                    {
   1068                      devState = DEV_NWK_JOINING;
   \   000078   90....       MOV     DPTR,#devState
   \   00007B   7403         MOV     A,#0x3
   \   00007D   12....       LCALL   ?Subroutine12 & 0xFFFF
   1069          
   1070                      ZDApp_NodeProfileSync( pChosenNwk->stackProfile);
   \                     ??CrossCallReturnLabel_6:
   \   000080   E0           MOVX    A,@DPTR
   \   000081   F9           MOV     R1,A
   \   000082   12....       LCALL   ??ZDApp_NodeProfileSync?relay
   1071          
   1072                      if ( NLME_JoinRequest( pChosenNwk->extendedPANID, pChosenNwk->panId,
   1073                                            pChosenNwk->logicalChannel,
   1074                                            ZDO_Config_Node_Descriptor.CapabilityFlags,
   1075                                            pChosenNwk->chosenRouter, pChosenNwk->chosenRouterDepth ) != ZSuccess )
   \   000085                ; Setup parameters for call to function NLME_JoinRequest
   \   000085   8E82         MOV     DPL,R6
   \   000087   8F83         MOV     DPH,R7
   \   000089   A3           INC     DPTR
   \   00008A   A3           INC     DPTR
   \   00008B   A3           INC     DPTR
   \   00008C   A3           INC     DPTR
   \   00008D   A3           INC     DPTR
   \   00008E   A3           INC     DPTR
   \   00008F   A3           INC     DPTR
   \   000090   A3           INC     DPTR
   \   000091   A3           INC     DPTR
   \   000092   A3           INC     DPTR
   \   000093   E0           MOVX    A,@DPTR
   \   000094   F5..         MOV     ?V0 + 0,A
   \   000096   78..         MOV     R0,#?V0 + 0
   \   000098   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   00009B   8E82         MOV     DPL,R6
   \   00009D   8F83         MOV     DPH,R7
   \   00009F   A3           INC     DPTR
   \   0000A0   A3           INC     DPTR
   \   0000A1   A3           INC     DPTR
   \   0000A2   A3           INC     DPTR
   \   0000A3   A3           INC     DPTR
   \   0000A4   A3           INC     DPTR
   \   0000A5   A3           INC     DPTR
   \   0000A6   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   0000A9   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   0000AC   E0           MOVX    A,@DPTR
   \   0000AD   F5..         MOV     ?V0 + 0,A
   \   0000AF   78..         MOV     R0,#?V0 + 0
   \   0000B1   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0000B4   8E82         MOV     DPL,R6
   \   0000B6   8F83         MOV     DPH,R7
   \   0000B8   A3           INC     DPTR
   \   0000B9   A3           INC     DPTR
   \   0000BA   E0           MOVX    A,@DPTR
   \   0000BB   F9           MOV     R1,A
   \   0000BC   8E82         MOV     DPL,R6
   \   0000BE   8F83         MOV     DPH,R7
   \   0000C0   E0           MOVX    A,@DPTR
   \   0000C1   FC           MOV     R4,A
   \   0000C2   A3           INC     DPTR
   \   0000C3   E0           MOVX    A,@DPTR
   \   0000C4   12....       LCALL   ?Subroutine34 & 0xFFFF
   1076                      {
   1077                        ZDApp_NetworkInit( (uint16)(NWK_START_DELAY
   1078                                                    + ((uint16)(osal_rand()& EXTENDED_JOINING_RANDOM_MASK))) );
   1079                      }
   1080                    } // if ( devStartMode == MODE_JOIN )
   \                     ??CrossCallReturnLabel_69:
   \   0000C7   12....       LCALL   ??NLME_JoinRequest?relay
   \   0000CA   7404         MOV     A,#0x4
   \   0000CC   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000CF   806B         SJMP    ??ZDApp_ProcessOSALMsg_9
   1081                    else if ( devStartMode == MODE_REJOIN )
   \                     ??ZDApp_ProcessOSALMsg_8:
   \   0000D1   6403         XRL     A,#0x3
   \   0000D3   706D         JNZ     ??CrossCallReturnLabel_34
   1082                    {
   1083                      devState = DEV_NWK_REJOIN;
   \   0000D5   90....       MOV     DPTR,#devState
   \   0000D8   7404         MOV     A,#0x4
   \   0000DA   F0           MOVX    @DPTR,A
   1084          
   1085                      // Before trying to do rejoin, check if the device has a valid short address
   1086                      // If not, generate a random short address for itself
   1087                      if ( _NIB.nwkDevAddress == INVALID_NODE_ADDR )
   \   0000DB   90....       MOV     DPTR,#_NIB + 20
   \   0000DE   E0           MOVX    A,@DPTR
   \   0000DF   64FE         XRL     A,#0xfe
   \   0000E1   7003         JNZ     ??ZDApp_ProcessOSALMsg_10
   \   0000E3   A3           INC     DPTR
   \   0000E4   E0           MOVX    A,@DPTR
   \   0000E5   F4           CPL     A
   \                     ??ZDApp_ProcessOSALMsg_10:
   \   0000E6   7012         JNZ     ??ZDApp_ProcessOSALMsg_11
   1088                      {
   1089                        _NIB.nwkDevAddress = osal_rand();
   \   0000E8                ; Setup parameters for call to function osal_rand
   \   0000E8   12....       LCALL   ??osal_rand?relay
   \   0000EB   90....       MOV     DPTR,#_NIB + 20
   \   0000EE   12....       LCALL   ??Subroutine61_0 & 0xFFFF
   1090                        ZMacSetReq( ZMacShortAddress, (byte*)&_NIB.nwkDevAddress );
   \                     ??CrossCallReturnLabel_124:
   \   0000F1                ; Setup parameters for call to function ZMacSetReq
   \   0000F1   7A..         MOV     R2,#(_NIB + 20) & 0xff
   \   0000F3   7B..         MOV     R3,#((_NIB + 20) >> 8) & 0xff
   \   0000F5   7953         MOV     R1,#0x53
   \   0000F7   12....       LCALL   ??ZMacSetReq?relay
   1091                      }
   1092          
   1093                      if ( ZG_SECURE_ENABLED )
   1094                      {
   1095                        ZDApp_RestoreNwkKey();
   1096                      }
   1097          
   1098                      // Check if the device has a valid PanID, if not, set it to the discovered Pan
   1099                      if ( _NIB.nwkPanId == INVALID_PAN_ID )
   \                     ??ZDApp_ProcessOSALMsg_11:
   \   0000FA   90....       MOV     DPTR,#_NIB + 33
   \   0000FD   E0           MOVX    A,@DPTR
   \   0000FE   64FE         XRL     A,#0xfe
   \   000100   7003         JNZ     ??ZDApp_ProcessOSALMsg_12
   \   000102   A3           INC     DPTR
   \   000103   E0           MOVX    A,@DPTR
   \   000104   F4           CPL     A
   \                     ??ZDApp_ProcessOSALMsg_12:
   \   000105   7014         JNZ     ??ZDApp_ProcessOSALMsg_13
   1100                      {
   1101                        _NIB.nwkPanId = pChosenNwk->panId;
   \   000107   12....       LCALL   ?Subroutine19 & 0xFFFF
   \                     ??CrossCallReturnLabel_75:
   \   00010A   90....       MOV     DPTR,#_NIB + 33
   \   00010D   E8           MOV     A,R0
   \   00010E   F0           MOVX    @DPTR,A
   \   00010F   A3           INC     DPTR
   \   000110   E9           MOV     A,R1
   \   000111   F0           MOVX    @DPTR,A
   1102                        ZMacSetReq( ZMacPanId, (byte*)&(_NIB.nwkPanId) );
   \   000112                ; Setup parameters for call to function ZMacSetReq
   \   000112   7A..         MOV     R2,#(_NIB + 33) & 0xff
   \   000114   7B..         MOV     R3,#((_NIB + 33) >> 8) & 0xff
   \   000116   7950         MOV     R1,#0x50
   \   000118   12....       LCALL   ??ZMacSetReq?relay
   1103                      }
   1104          
   1105                      tmp = true;
   \                     ??ZDApp_ProcessOSALMsg_13:
   \   00011B   85..82       MOV     DPL,?XSP + 0
   \   00011E   85..83       MOV     DPH,?XSP + 1
   \   000121   7401         MOV     A,#0x1
   \   000123   F0           MOVX    @DPTR,A
   1106                      ZMacSetReq( ZMacRxOnIdle, &tmp ); // Set receiver always on during rejoin
   \   000124                ; Setup parameters for call to function ZMacSetReq
   \   000124   AA82         MOV     R2,DPL
   \   000126   AB83         MOV     R3,DPH
   \   000128   7952         MOV     R1,#0x52
   \   00012A   12....       LCALL   ??ZMacSetReq?relay
   1107                      if ( NLME_ReJoinRequest( ZDO_UseExtendedPANID, pChosenNwk->logicalChannel) != ZSuccess )
   \   00012D                ; Setup parameters for call to function NLME_ReJoinRequest
   \   00012D   8E82         MOV     DPL,R6
   \   00012F   8F83         MOV     DPH,R7
   \   000131   A3           INC     DPTR
   \   000132   A3           INC     DPTR
   \   000133   E0           MOVX    A,@DPTR
   \   000134   F9           MOV     R1,A
   \   000135   7A..         MOV     R2,#ZDO_UseExtendedPANID & 0xff
   \   000137   7B..         MOV     R3,#(ZDO_UseExtendedPANID >> 8) & 0xff
   \   000139   12....       LCALL   ??NLME_ReJoinRequest?relay
   \                     ??ZDApp_ProcessOSALMsg_9:
   \   00013C   E9           MOV     A,R1
   \   00013D   6003         JZ      ??CrossCallReturnLabel_34
   1108                      {
   1109                        ZDApp_NetworkInit( (uint16)(NWK_START_DELAY
   1110                                                    + ((uint16)(osal_rand()& EXTENDED_JOINING_RANDOM_MASK))) );
   \   00013F                ; Setup parameters for call to function ZDApp_NetworkInit
   \   00013F                ; Setup parameters for call to function osal_rand
   \   00013F   12....       LCALL   ?Subroutine28 & 0xFFFF
   1111                      }
   1112                    } // else if ( devStartMode == MODE_REJOIN )
   1113          
   1114                    if ( ZDO_Config_Node_Descriptor.CapabilityFlags & CAPINFO_RCVR_ON_IDLE )
   \                     ??CrossCallReturnLabel_34:
   \   000142   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   000145   E0           MOVX    A,@DPTR
   \   000146   A2E3         MOV     C,0xE0 /* A   */.3
   \   000148   4003         JC      $+5
   \   00014A   02....       LJMP    ??ZDApp_ProcessOSALMsg_5 & 0xFFFF
   1115                    {
   1116                      // The receiver is on, turn network layer polling off.
   1117                      NLME_SetPollRate( 0 );
   \   00014D                ; Setup parameters for call to function NLME_SetPollRate
   \   00014D   12....       LCALL   ?Subroutine27 & 0xFFFF
   1118                      NLME_SetQueuedPollRate( 0 );
   1119                      NLME_SetResponseRate( 0 );
   1120                    }
   1121                    else
   1122                    {
   1123                      if ( (ZG_SECURE_ENABLED) && (devStartMode == MODE_JOIN) )
   1124                      {
   1125                        ZDApp_SavedPollRate = zgPollRate;
   1126                        NLME_SetPollRate( zgRejoinPollRate );
   1127                      }
   1128                    }
   1129                  }
   \                     ??CrossCallReturnLabel_83:
   \   000150   02....       LJMP    ??ZDApp_ProcessOSALMsg_5 & 0xFFFF
   1130          //************************如果不成功******************************************//
   1131                  else
   1132                  {
   1133                    if ( continueJoining )
   \                     ??ZDApp_ProcessOSALMsg_7:
   \   000153   90....       MOV     DPTR,#continueJoining
   \   000156   E0           MOVX    A,@DPTR
   \   000157   7003         JNZ     $+5
   \   000159   02....       LJMP    ??ZDApp_ProcessOSALMsg_5 & 0xFFFF
   1134                    {
   1135              #if defined ( MANAGED_SCAN )
   1136                      ZDApp_NetworkInit( MANAGEDSCAN_DELAY_BETWEEN_SCANS );
   1137              #else
   1138          //********睡眠然后重连********************************************************//
   1139          //* 失败后进入睡眠
   1140          //* 初始睡眠时间为5S，之后每次翻倍，当睡眠时间大于一个小时，则设置睡眠时间为一个小时
   1141                      zdoDiscCounter++;
   \   00015C   90....       MOV     DPTR,#zdoDiscCounter
   \   00015F   E0           MOVX    A,@DPTR
   \   000160   04           INC     A
   \   000161   F0           MOVX    @DPTR,A
   1142          			linkedCount++;
   \   000162   90....       MOV     DPTR,#linkedCount
   \   000165   E0           MOVX    A,@DPTR
   \   000166   04           INC     A
   \   000167   F0           MOVX    @DPTR,A
   1143          			
   1144          			if(linkedCount > 3) {
   \   000168   C3           CLR     C
   \   000169   9404         SUBB    A,#0x4
   \   00016B   5003         JNC     $+5
   \   00016D   02....       LJMP    ??ZDApp_ProcessOSALMsg_14 & 0xFFFF
   1145          			  	linkedCount = 0;
   \   000170   E4           CLR     A
   \   000171   F0           MOVX    @DPTR,A
   1146          			  	P1DIR |= 0X03;                 
   \   000172   43FE03       ORL     0xfe,#0x3
   1147          				SWLED = 0;                     //LED关闭
   \   000175   C291         CLR     0x90.1
   1148          				   
   1149          				NLME_SetPollRate(0);         
   \   000177                ; Setup parameters for call to function NLME_SetPollRate
   \   000177   FA           MOV     R2,A
   \   000178   FB           MOV     R3,A
   \   000179   12....       LCALL   ??Subroutine48_0 & 0xFFFF
   1150          				NLME_SetQueuedPollRate(0);
   1151          				NLME_SetResponseRate(0);
   1152          				  
   1153          				// 设置睡眠所用参数
   1154          				shutdown();
   \                     ??CrossCallReturnLabel_85:
   \   00017C                ; Setup parameters for call to function shutdown
   \   00017C   12....       LCALL   ??shutdown?relay
   1155          				sleepMode = START_SLEEP;
   \   00017F   90....       MOV     DPTR,#sleepMode
   \   000182   7401         MOV     A,#0x1
   \   000184   F0           MOVX    @DPTR,A
   1156          				CountF = 1;
   \   000185   90....       MOV     DPTR,#CountF
   \   000188   F0           MOVX    @DPTR,A
   1157          				// 初始睡眠时间为5S，之后每次翻倍，当睡眠时间大于一个小时，则设置睡眠时间为一个小时
   1158          				startSleepTime *= 2;  
   \   000189   90....       MOV     DPTR,#startSleepTime
   \   00018C   78..         MOV     R0,#?V0 + 0
   \   00018E   12....       LCALL   ?L_MOV_X
   \   000191   7401         MOV     A,#0x1
   \   000193   78..         MOV     R0,#?V0 + 0
   \   000195   12....       LCALL   ?L_SHL
   \   000198   90....       MOV     DPTR,#startSleepTime
   \   00019B   78..         MOV     R0,#?V0 + 0
   \   00019D   12....       LCALL   ?L_MOV_TO_X
   1159          				if(startSleepTime > 3600000) {
   \   0001A0   90....       MOV     DPTR,#startSleepTime
   \   0001A3   C082         PUSH    DPL
   \   0001A5   90....       MOV     DPTR,#__Constant_36ee81
   \   0001A8   78..         MOV     R0,#?V0 + 0
   \   0001AA   12....       LCALL   ?L_MOV_X
   \   0001AD   7583..       MOV     DPH,#(startSleepTime >> 8) & 0xff
   \   0001B0   D082         POP     DPL
   \   0001B2   78..         MOV     R0,#?V0 + 0
   \   0001B4   12....       LCALL   ?UL_GT_X
   \   0001B7   400C         JC      ??ZDApp_ProcessOSALMsg_15
   1160          					startSleepTime = 3600000;
   \   0001B9   90....       MOV     DPTR,#__Constant_36ee80
   \   0001BC   12....       LCALL   ?XLOAD_R2345
   \   0001BF   90....       MOV     DPTR,#startSleepTime
   \   0001C2   12....       LCALL   ?XSTORE_R2345
   1161          				}
   1162          				halSleep(5000);		// 睡眠函数，参数无意义
   \                     ??ZDApp_ProcessOSALMsg_15:
   \   0001C5                ; Setup parameters for call to function halSleep
   1163          				while(CountF == 0) {
   1164          					halSleep(5000);
   \   0001C5                ; Setup parameters for call to function halSleep
   \   0001C5   7A88         MOV     R2,#-0x78
   \   0001C7   7B13         MOV     R3,#0x13
   \   0001C9   12....       LCALL   ??halSleep?relay
   1165          				}
   \   0001CC   90....       MOV     DPTR,#CountF
   \   0001CF   E0           MOVX    A,@DPTR
   \   0001D0   60F3         JZ      ??ZDApp_ProcessOSALMsg_15
   1166          				turnOnRFX2401C();
   \   0001D2                ; Setup parameters for call to function turnOnRFX2401C
   \   0001D2   12....       LCALL   ??turnOnRFX2401C?relay
   1167          				sleepMode = FREE_SLEEP;
   \   0001D5   90....       MOV     DPTR,#sleepMode
   \   0001D8   E4           CLR     A
   \   0001D9   F0           MOVX    @DPTR,A
   1168          				NLME_SetPollRate(1000);
   \   0001DA                ; Setup parameters for call to function NLME_SetPollRate
   \   0001DA   7AE8         MOV     R2,#-0x18
   \   0001DC   7B03         MOV     R3,#0x3
   \   0001DE   12....       LCALL   ??NLME_SetPollRate?relay
   1169          				NLME_SetQueuedPollRate(100);
   \   0001E1                ; Setup parameters for call to function NLME_SetQueuedPollRate
   \   0001E1   7A64         MOV     R2,#0x64
   \   0001E3   7B00         MOV     R3,#0x0
   \   0001E5   12....       LCALL   ??NLME_SetQueuedPollRate?relay
   1170          				NLME_SetResponseRate(100);
   \   0001E8                ; Setup parameters for call to function NLME_SetResponseRate
   \   0001E8   7A64         MOV     R2,#0x64
   \   0001EA   7B00         MOV     R3,#0x0
   \   0001EC   12....       LCALL   ??NLME_SetResponseRate?relay
   1171          				
   1172          				SWLED = 1;                     //LED开启
   \   0001EF   D291         SETB    0x90.1
   1173          			}
   1174                      ZDApp_NetworkInit( (uint16)(BEACON_REQUEST_DELAY
   1175                            + ((uint16)(osal_rand()& BEACON_REQ_DELAY_MASK))) );
   \                     ??ZDApp_ProcessOSALMsg_14:
   \   0001F1                ; Setup parameters for call to function ZDApp_NetworkInit
   \   0001F1                ; Setup parameters for call to function osal_rand
   \   0001F1   12....       LCALL   ??osal_rand?relay
   \   0001F4   EA           MOV     A,R2
   \   0001F5   24F4         ADD     A,#-0xc
   \   0001F7   FA           MOV     R2,A
   \   0001F8   E4           CLR     A
   \   0001F9   3401         ADDC    A,#0x1
   \   0001FB   FB           MOV     R3,A
   \   0001FC   8039         SJMP    ??ZDApp_ProcessOSALMsg_16
   1176              #endif
   1177                    }
   1178                  }
   1179                }
   1180                break;
   1181          
   1182              case ZDO_NWK_JOIN_IND:
   1183                if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   \                     ??ZDApp_ProcessOSALMsg_1:
   \   0001FE   90....       MOV     DPTR,#zgDeviceLogicalType
   \   000201   E0           MOVX    A,@DPTR
   \   000202   6401         XRL     A,#0x1
   \   000204   6005         JZ      ??ZDApp_ProcessOSALMsg_17
   \   000206   E0           MOVX    A,@DPTR
   \   000207   6402         XRL     A,#0x2
   \   000209   702F         JNZ     ??ZDApp_ProcessOSALMsg_5
   1184                {
   1185                  ZDApp_ProcessNetworkJoin();
   \                     ??ZDApp_ProcessOSALMsg_17:
   \   00020B                ; Setup parameters for call to function ZDApp_ProcessNetworkJoin
   \   00020B   12....       LCALL   ??ZDApp_ProcessNetworkJoin?relay
   \   00020E   802A         SJMP    ??ZDApp_ProcessOSALMsg_5
   1186                }
   1187                break;
   1188          
   1189              case ZDO_NWK_JOIN_REQ:
   1190                if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   \                     ??ZDApp_ProcessOSALMsg_2:
   \   000210   90....       MOV     DPTR,#zgDeviceLogicalType
   \   000213   E0           MOVX    A,@DPTR
   \   000214   6401         XRL     A,#0x1
   \   000216   6005         JZ      ??ZDApp_ProcessOSALMsg_18
   \   000218   E0           MOVX    A,@DPTR
   \   000219   6402         XRL     A,#0x2
   \   00021B   701D         JNZ     ??ZDApp_ProcessOSALMsg_5
   1191                {
   1192                  retryCnt = 0;
   \                     ??ZDApp_ProcessOSALMsg_18:
   \   00021D   90....       MOV     DPTR,#retryCnt
   \   000220   E4           CLR     A
   \   000221   F0           MOVX    @DPTR,A
   1193                  devStartMode = MODE_RESUME;
   \   000222   90....       MOV     DPTR,#devStartMode
   \   000225   04           INC     A
   \   000226   F0           MOVX    @DPTR,A
   1194                  _tmpRejoinState = true;
   \   000227   90....       MOV     DPTR,#_tmpRejoinState
   \   00022A   12....       LCALL   ?Subroutine11 & 0xFFFF
   1195                  osal_cpyExtAddr( ZDO_UseExtendedPANID, _NIB.extendedPANID );
   1196                  zgDefaultStartingScanDuration = BEACON_ORDER_60_MSEC;
   \                     ??CrossCallReturnLabel_5:
   \   00022D   90....       MOV     DPTR,#zgDefaultStartingScanDuration
   \   000230   7402         MOV     A,#0x2
   \   000232   F0           MOVX    @DPTR,A
   1197                  ZDApp_NetworkInit( 0 );
   \   000233                ; Setup parameters for call to function ZDApp_NetworkInit
   \   000233   7A00         MOV     R2,#0x0
   \   000235   7B00         MOV     R3,#0x0
   \                     ??ZDApp_ProcessOSALMsg_16:
   \   000237   12....       LCALL   ??ZDApp_NetworkInit?relay
   1198                }
   1199                break;
   1200          
   1201              default:
   1202                if ( ZG_SECURE_ENABLED )
   1203                  ZDApp_ProcessSecMsg( msgPtr );
   1204                break;
   1205            }
   1206          
   1207          }
   \                     ??ZDApp_ProcessOSALMsg_5:
   \   00023A   7401         MOV     A,#0x1
   \   00023C   80..         SJMP    ??Subroutine45_0
   \   00023E                REQUIRE P1DIR
   \   00023E                REQUIRE _A_P1

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine34:
   \   000000   FD           MOV     R5,A
   \   000001                REQUIRE ??Subroutine43_0
   \   000001                ; // Fall through to label ??Subroutine43_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine43_0:
   \   000000   EE           MOV     A,R6
   \   000001   240B         ADD     A,#0xb
   \   000003   FA           MOV     R2,A
   \   000004   EF           MOV     A,R7
   \   000005   3400         ADDC    A,#0x0
   \   000007   FB           MOV     R3,A
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine19:
   \   000000   8E82         MOV     DPL,R6
   \   000002   8F83         MOV     DPH,R7
   \   000004                REQUIRE ??Subroutine44_0
   \   000004                ; // Fall through to label ??Subroutine44_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine45_0:
   \   000000   12....       LCALL   ?DEALLOC_XSTACK8
   \   000003                REQUIRE ??Subroutine46_0
   \   000003                ; // Fall through to label ??Subroutine46_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine46_0:
   \   000000   7F04         MOV     R7,#0x4
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine28:
   \   000000   12....       LCALL   ??osal_rand?relay
   \   000003   EA           MOV     A,R2
   \   000004   547F         ANL     A,#0x7f
   \   000006   2464         ADD     A,#0x64
   \   000008   FA           MOV     R2,A
   \   000009   7B00         MOV     R3,#0x0
   \   00000B   12....       LCALL   ??ZDApp_NetworkInit?relay
   \   00000E   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine27:
   \   000000   7A00         MOV     R2,#0x0
   \   000002   7B00         MOV     R3,#0x0
   \   000004                REQUIRE ??Subroutine48_0
   \   000004                ; // Fall through to label ??Subroutine48_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine48_0:
   \   000000   12....       LCALL   ??NLME_SetPollRate?relay
   \   000003                ; Setup parameters for call to function NLME_SetQueuedPollRate
   \   000003                ; Setup parameters for call to function NLME_SetQueuedPollRate
   \   000003                ; Setup parameters for call to function NLME_SetQueuedPollRate
   \   000003   7A00         MOV     R2,#0x0
   \   000005   7B00         MOV     R3,#0x0
   \   000007   12....       LCALL   ??NLME_SetQueuedPollRate?relay
   \   00000A                ; Setup parameters for call to function NLME_SetResponseRate
   \   00000A                ; Setup parameters for call to function NLME_SetResponseRate
   \   00000A                ; Setup parameters for call to function NLME_SetResponseRate
   \   00000A   7A00         MOV     R2,#0x0
   \   00000C   7B00         MOV     R3,#0x0
   \   00000E   12....       LCALL   ??NLME_SetResponseRate?relay
   \   000011   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine12:
   \   000000   F0           MOVX    @DPTR,A
   \   000001                ; Setup parameters for call to function ZDApp_NodeProfileSync
   \   000001   8E82         MOV     DPL,R6
   \   000003   8F83         MOV     DPH,R7
   \   000005   A3           INC     DPTR
   \   000006   A3           INC     DPTR
   \   000007   A3           INC     DPTR
   \   000008   A3           INC     DPTR
   \   000009   A3           INC     DPTR
   \   00000A   A3           INC     DPTR
   \   00000B   22           RET
   1208          
   1209          /*********************************************************************
   1210           * @fn      ZDApp_ProcessMsgCBs()
   1211           *
   1212           * @brief   Process response messages
   1213           *
   1214           * @param   none
   1215           *
   1216           * @return  none
   1217           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1218          void ZDApp_ProcessMsgCBs( zdoIncomingMsg_t *inMsg )
   \                     ZDApp_ProcessMsgCBs:
   1219          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 21
   \   000005   74EB         MOV     A,#-0x15
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
   1220            switch ( inMsg->clusterID )
   \   00000E   12....       LCALL   ?Subroutine31 & 0xFFFF
   \                     ??CrossCallReturnLabel_40:
   \   000011   F5..         MOV     ?V0 + 1,A
   \   000013   78..         MOV     R0,#?V0 + 0
   \   000015   12....       LCALL   ?US_SWITCH_SPARSE
   \                     `?<Jumptable for ZDApp_ProcessMsgCBs>_0`:
   \   000018   0200         DW        2
   \   00001A   2100         DW        33
   \   00001C   2200         DW        34
   \   00001E   ....         DW        ??ZDApp_ProcessMsgCBs_0
   \   000020   0080         DW        32768
   \   000022   0180         DW        32769
   \   000024   ....         DW        ??ZDApp_ProcessMsgCBs_1
   \   000026   0000         DW        0
   \   000028   ....         DW        ??ZDApp_ProcessMsgCBs_2
   1221            {
   1222          #if defined ( ZDO_NWKADDR_REQUEST ) || defined ( ZDO_IEEEADDR_REQUEST ) || defined ( REFLECTOR )
   1223              case NWK_addr_rsp:
   1224              case IEEE_addr_rsp:
   1225                {
   1226                  ZDO_NwkIEEEAddrResp_t *pAddrRsp;
   1227                  pAddrRsp = ZDO_ParseAddrRsp( inMsg );
   \                     ??ZDApp_ProcessMsgCBs_1:
   \   00002A                ; Setup parameters for call to function ZDO_ParseAddrRsp
   \   00002A   12....       LCALL   ??ZDO_ParseAddrRsp?relay
   \   00002D   8A..         MOV     ?V0 + 0,R2
   \   00002F   8B..         MOV     ?V0 + 1,R3
   \   000031   AE..         MOV     R6,?V0 + 0
   \   000033   AF..         MOV     R7,?V0 + 1
   1228                  if ( pAddrRsp )
   \   000035   EE           MOV     A,R6
   \   000036   4F           ORL     A,R7
   \   000037   603D         JZ      ??ZDApp_ProcessMsgCBs_2
   1229                  {
   1230                    if ( pAddrRsp->status == ZSuccess )
   \   000039   8E82         MOV     DPL,R6
   \   00003B   8F83         MOV     DPH,R7
   \   00003D   E0           MOVX    A,@DPTR
   \   00003E   700F         JNZ     ??ZDApp_ProcessMsgCBs_3
   1231                    {
   1232                      ZDO_UpdateAddrManager( pAddrRsp->nwkAddr, pAddrRsp->extAddr );
   \   000040                ; Setup parameters for call to function ZDO_UpdateAddrManager
   \   000040   EE           MOV     A,R6
   \   000041   2403         ADD     A,#0x3
   \   000043   FC           MOV     R4,A
   \   000044   EF           MOV     A,R7
   \   000045   3400         ADDC    A,#0x0
   \   000047   FD           MOV     R5,A
   \   000048   A3           INC     DPTR
   \   000049   12....       LCALL   ?Subroutine24 & 0xFFFF
   1233                    }
   \                     ??CrossCallReturnLabel_29:
   \   00004C   12....       LCALL   ??ZDO_UpdateAddrManager?relay
   1234                    osal_mem_free( pAddrRsp );
   \                     ??ZDApp_ProcessMsgCBs_3:
   \   00004F                ; Setup parameters for call to function osal_mem_free
   \   00004F   EE           MOV     A,R6
   \   000050   FA           MOV     R2,A
   \   000051   EF           MOV     A,R7
   \   000052   FB           MOV     R3,A
   \   000053   12....       LCALL   ??osal_mem_free?relay
   \   000056   801E         SJMP    ??ZDApp_ProcessMsgCBs_2
   1235                  }
   1236                }
   1237                break;
   1238          #endif
   1239          
   1240          #if defined ( REFLECTOR )
   1241              case Bind_req:
   1242              case Unbind_req:
   1243                {
   1244                  ZDO_BindUnbindReq_t bindReq;
   1245                  ZDO_ParseBindUnbindReq( inMsg, &bindReq );
   \                     ??ZDApp_ProcessMsgCBs_0:
   \   000058                ; Setup parameters for call to function ZDO_ParseBindUnbindReq
   \   000058   85..82       MOV     DPL,?XSP + 0
   \   00005B   85..83       MOV     DPH,?XSP + 1
   \   00005E   AC82         MOV     R4,DPL
   \   000060   AD83         MOV     R5,DPH
   \   000062   12....       LCALL   ??ZDO_ParseBindUnbindReq?relay
   1246                  ZDO_ProcessBindUnbindReq( inMsg, &bindReq );
   \   000065                ; Setup parameters for call to function ZDO_ProcessBindUnbindReq
   \   000065   85..82       MOV     DPL,?XSP + 0
   \   000068   85..83       MOV     DPH,?XSP + 1
   \   00006B   AC82         MOV     R4,DPL
   \   00006D   AD83         MOV     R5,DPH
   \   00006F   EE           MOV     A,R6
   \   000070   FA           MOV     R2,A
   \   000071   EF           MOV     A,R7
   \   000072   FB           MOV     R3,A
   \   000073   12....       LCALL   ??ZDO_ProcessBindUnbindReq?relay
   1247                }
   1248                break;
   1249          #endif
   1250          
   1251          #if ( ZG_BUILD_COORDINATOR_TYPE )
   1252              case Bind_rsp:
   1253              case Unbind_rsp:
   1254                if (ZG_DEVICE_COORDINATOR_TYPE && matchED)
   1255                {
   1256                  ZDMatchSendState(
   1257                       (uint8)((inMsg->clusterID == Bind_rsp) ? ZDMATCH_REASON_BIND_RSP : ZDMATCH_REASON_UNBIND_RSP),
   1258                       ZDO_ParseBindRsp(inMsg), inMsg->TransSeq );
   1259                }
   1260                break;
   1261          
   1262              case End_Device_Bind_req:
   1263                if (ZG_DEVICE_COORDINATOR_TYPE)
   1264                {
   1265                  ZDEndDeviceBind_t bindReq;
   1266                  ZDO_ParseEndDeviceBindReq( inMsg, &bindReq );
   1267                  ZDO_MatchEndDeviceBind( &bindReq );
   1268          
   1269                  // Freeing the cluster lists - if allocated.
   1270                  if ( bindReq.numInClusters )
   1271                    osal_mem_free( bindReq.inClusters );
   1272                  if ( bindReq.numOutClusters )
   1273                    osal_mem_free( bindReq.outClusters );
   1274                }
   1275                break;
   1276          #endif
   1277            }
   1278          }
   \                     ??ZDApp_ProcessMsgCBs_2:
   \   000076                REQUIRE ?Subroutine8
   \   000076                ; // Fall through to label ?Subroutine8

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine8:
   \   000000   7415         MOV     A,#0x15
   \   000002   02....       LJMP    ??Subroutine51_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine40:
   \   000000   EE           MOV     A,R6
   \   000001   240C         ADD     A,#0xc
   \   000003                REQUIRE ??Subroutine54_0
   \   000003                ; // Fall through to label ??Subroutine54_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine54_0:
   \   000000   F582         MOV     DPL,A
   \   000002   EF           MOV     A,R7
   \   000003                REQUIRE ??Subroutine55_0
   \   000003                ; // Fall through to label ??Subroutine55_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine55_0:
   \   000000   3400         ADDC    A,#0x0
   \   000002   F583         MOV     DPH,A
   \   000004   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine31:
   \   000000   12....       LCALL   ?Subroutine40 & 0xFFFF
   \                     ??CrossCallReturnLabel_120:
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F5..         MOV     ?V0 + 0,A
   \   000006   A3           INC     DPTR
   \   000007   E0           MOVX    A,@DPTR
   \   000008   22           RET
   1279          
   1280          /*********************************************************************
   1281           * @fn      ZDApp_RegisterCBs()
   1282           *
   1283           * @brief   Process response messages
   1284           *
   1285           * @param   none
   1286           *
   1287           * @return  none
   1288           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1289          void ZDApp_RegisterCBs( void )
   \                     ZDApp_RegisterCBs:
   1290          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1291          #if defined ( ZDO_IEEEADDR_REQUEST ) || defined ( REFLECTOR )
   1292            ZDO_RegisterForZDOMsg( ZDAppTaskID, IEEE_addr_rsp );
   \   000004                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   000004   7A01         MOV     R2,#0x1
   \   000006   12....       LCALL   ?Subroutine22 & 0xFFFF
   1293          #endif
   1294          #if defined ( ZDO_NWKADDR_REQUEST ) || defined ( REFLECTOR )
   1295            ZDO_RegisterForZDOMsg( ZDAppTaskID, NWK_addr_rsp );
   \                     ??CrossCallReturnLabel_79:
   \   000009                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   000009   7A00         MOV     R2,#0x0
   \   00000B   12....       LCALL   ?Subroutine22 & 0xFFFF
   1296          #endif
   1297          #if ZG_BUILD_COORDINATOR_TYPE
   1298            ZDO_RegisterForZDOMsg( ZDAppTaskID, Bind_rsp );
   1299            ZDO_RegisterForZDOMsg( ZDAppTaskID, Unbind_rsp );
   1300            ZDO_RegisterForZDOMsg( ZDAppTaskID, End_Device_Bind_req );
   1301          #endif
   1302          #if defined ( REFLECTOR )
   1303            ZDO_RegisterForZDOMsg( ZDAppTaskID, Bind_req );
   \                     ??CrossCallReturnLabel_80:
   \   00000E                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   00000E   7A21         MOV     R2,#0x21
   \   000010   7B00         MOV     R3,#0x0
   \   000012   12....       LCALL   ??Subroutine47_0 & 0xFFFF
   1304            ZDO_RegisterForZDOMsg( ZDAppTaskID, Unbind_req );
   \                     ??CrossCallReturnLabel_81:
   \   000015                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   000015   7A22         MOV     R2,#0x22
   \   000017   7B00         MOV     R3,#0x0
   \   000019   12....       LCALL   ??Subroutine47_0 & 0xFFFF
   1305          #endif
   1306          }
   \                     ??CrossCallReturnLabel_82:
   \   00001C   02....       LJMP    ?Subroutine2 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine22:
   \   000000   7B80         MOV     R3,#-0x80
   \   000002                REQUIRE ??Subroutine47_0
   \   000002                ; // Fall through to label ??Subroutine47_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine47_0:
   \   000000   90....       MOV     DPTR,#ZDAppTaskID
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F9           MOV     R1,A
   \   000005   12....       LCALL   ??ZDO_RegisterForZDOMsg?relay
   \   000008   22           RET
   1307          
   1308          /*********************************************************************
   1309           * @fn      ZDApp_ProcessSecMsg()
   1310           *
   1311           * @brief   Process the incoming security message.
   1312           *
   1313           * @param   msgPtr - message to process
   1314           *
   1315           * @return  none
   1316           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1317          void ZDApp_ProcessSecMsg( osal_event_hdr_t *msgPtr )
   \                     ZDApp_ProcessSecMsg:
   1318          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1319            switch ( msgPtr->event )
   \   000004   8A82         MOV     DPL,R2
   \   000006   8B83         MOV     DPH,R3
   \   000008   E0           MOVX    A,@DPTR
   \   000009   24FA         ADD     A,#-0x6
   \   00000B   6006         JZ      ??ZDApp_ProcessSecMsg_0
   \   00000D   24FC         ADD     A,#-0x4
   \   00000F   6014         JZ      ??ZDApp_ProcessSecMsg_1
   \   000011   8022         SJMP    ??ZDApp_ProcessSecMsg_2
   1320            {
   1321              case ZDO_ESTABLISH_KEY_CFM:
   1322                if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
   1323                {
   1324                  ZDSecMgrEstablishKeyCfm( (ZDO_EstablishKeyCfm_t*)msgPtr );
   1325                }
   1326                break;
   1327          
   1328              case ZDO_ESTABLISH_KEY_IND:
   1329                if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
   1330                {
   1331                  if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   1332                  {
   1333                    ZDSecMgrEstablishKeyInd( (ZDO_EstablishKeyInd_t*)msgPtr );
   1334                  }
   1335                }
   1336                break;
   1337          
   1338              case ZDO_TRANSPORT_KEY_IND:
   1339                if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   \                     ??ZDApp_ProcessSecMsg_0:
   \   000013   90....       MOV     DPTR,#zgDeviceLogicalType
   \   000016   E0           MOVX    A,@DPTR
   \   000017   6401         XRL     A,#0x1
   \   000019   6005         JZ      ??ZDApp_ProcessSecMsg_3
   \   00001B   E0           MOVX    A,@DPTR
   \   00001C   6402         XRL     A,#0x2
   \   00001E   7015         JNZ     ??ZDApp_ProcessSecMsg_2
   1340                {
   1341                  ZDSecMgrTransportKeyInd( (ZDO_TransportKeyInd_t*)msgPtr );
   \                     ??ZDApp_ProcessSecMsg_3:
   \   000020                ; Setup parameters for call to function ZDSecMgrTransportKeyInd
   \   000020   12....       LCALL   ??ZDSecMgrTransportKeyInd?relay
   \   000023   8010         SJMP    ??ZDApp_ProcessSecMsg_2
   1342                }
   1343                break;
   1344          
   1345              case ZDO_UPDATE_DEVICE_IND:
   1346                if ( ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE )
   1347                {
   1348                  ZDSecMgrUpdateDeviceInd( (ZDO_UpdateDeviceInd_t*)msgPtr );
   1349                }
   1350                break;
   1351          
   1352              case ZDO_REMOVE_DEVICE_IND:
   1353                if ( ZG_BUILD_RTRONLY_TYPE && ( zgDeviceLogicalType == ZG_DEVICETYPE_ROUTER ) )
   1354                {
   1355                  ZDSecMgrRemoveDeviceInd( (ZDO_RemoveDeviceInd_t*)msgPtr );
   1356                }
   1357                break;
   1358          
   1359              case ZDO_REQUEST_KEY_IND:
   1360                if (( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH ) ||
   1361                    ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD ))
   1362                {
   1363                  if ( ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE )
   1364                  {
   1365                    ZDSecMgrRequestKeyInd( (ZDO_RequestKeyInd_t*)msgPtr );
   1366                  }
   1367                }
   1368                break;
   1369          
   1370              case ZDO_SWITCH_KEY_IND:
   1371                if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   \                     ??ZDApp_ProcessSecMsg_1:
   \   000025   90....       MOV     DPTR,#zgDeviceLogicalType
   \   000028   E0           MOVX    A,@DPTR
   \   000029   6401         XRL     A,#0x1
   \   00002B   6005         JZ      ??ZDApp_ProcessSecMsg_4
   \   00002D   E0           MOVX    A,@DPTR
   \   00002E   6402         XRL     A,#0x2
   \   000030   7003         JNZ     ??ZDApp_ProcessSecMsg_2
   1372                {
   1373                  ZDSecMgrSwitchKeyInd( (ZDO_SwitchKeyInd_t*)msgPtr );
   \                     ??ZDApp_ProcessSecMsg_4:
   \   000032                ; Setup parameters for call to function ZDSecMgrSwitchKeyInd
   \   000032   12....       LCALL   ??ZDSecMgrSwitchKeyInd?relay
   1374                }
   1375                break;
   1376          
   1377              case ZDO_AUTHENTICATE_IND:
   1378                if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
   1379                {
   1380                  ZDSecMgrAuthenticateInd( (ZDO_AuthenticateInd_t*)msgPtr );
   1381                }
   1382                break;
   1383          
   1384              case ZDO_AUTHENTICATE_CFM:
   1385                if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
   1386                {
   1387                  ZDSecMgrAuthenticateCfm( (ZDO_AuthenticateCfm_t*)msgPtr );
   1388                }
   1389                break;
   1390          
   1391              default:
   1392                // Unsupported messages
   1393                break;
   1394            }
   1395          }
   \                     ??ZDApp_ProcessSecMsg_2:
   \   000035   02....       LJMP    ?Subroutine2 & 0xFFFF
   1396          
   1397          /*********************************************************************
   1398           * @fn      ZDApp_ProcessNetworkJoin()
   1399           *
   1400           * @brief
   1401           *
   1402           *   Save off the Network key information.
   1403           *
   1404           * @param   none
   1405           *
   1406           * @return  none
   1407           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1408          void ZDApp_ProcessNetworkJoin( void )
   \                     ZDApp_ProcessNetworkJoin:
   1409          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1410            if ( (devState == DEV_NWK_JOINING) ||
   1411                ((devState == DEV_NWK_ORPHAN)  &&
   1412                 (ZDO_Config_Node_Descriptor.LogicalType == NODETYPE_ROUTER)) )
   \   00000A   90....       MOV     DPTR,#devState
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   6403         XRL     A,#0x3
   \   000010   6015         JZ      ??ZDApp_ProcessNetworkJoin_0
   \   000012   E0           MOVX    A,@DPTR
   \   000013   640A         XRL     A,#0xa
   \   000015   6003         JZ      $+5
   \   000017   02....       LJMP    ??ZDApp_ProcessNetworkJoin_1 & 0xFFFF
   \   00001A   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   5407         ANL     A,#0x7
   \   000020   6401         XRL     A,#0x1
   \   000022   6003         JZ      $+5
   \   000024   02....       LJMP    ??ZDApp_ProcessNetworkJoin_2 & 0xFFFF
   1413            {
   1414              // Result of a Join attempt by this device.
   1415              if ( nwkStatus == ZSuccess )
   \                     ??ZDApp_ProcessNetworkJoin_0:
   \   000027   90....       MOV     DPTR,#nwkStatus
   \   00002A   E0           MOVX    A,@DPTR
   \   00002B   701C         JNZ     ??ZDApp_ProcessNetworkJoin_3
   1416              {
   1417                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   00002D                ; Setup parameters for call to function osal_set_event
   \   00002D   12....       LCALL   ?Subroutine18 & 0xFFFF
   1418          
   1419          #if defined ( POWER_SAVING )
   1420                osal_pwrmgr_device( PWRMGR_BATTERY );
   \                     ??CrossCallReturnLabel_62:
   \   000030                ; Setup parameters for call to function osal_pwrmgr_device
   \   000030   7901         MOV     R1,#0x1
   \   000032   12....       LCALL   ??osal_pwrmgr_device?relay
   1421          #endif
   1422          
   1423                if ( ZG_SECURE_ENABLED && ( ZDApp_RestoreNwkKey() == false ) )
   1424                {
   1425                  // wait for auth from trust center!!
   1426                  devState = DEV_END_DEVICE_UNAUTH;
   1427          
   1428                  // Start the reset timer for MAX UNAUTH time
   1429                  ZDApp_ResetTimerStart( 10000 );//MAX_DEVICE_UNAUTH_TIMEOUT );
   1430                }
   1431                else
   1432                {
   1433                  if ( ZSTACK_ROUTER_BUILD )
   1434                  {
   1435                    if ( devState == DEV_NWK_ORPHAN
   1436                      && ZDO_Config_Node_Descriptor.LogicalType != NODETYPE_DEVICE )
   1437                    {
   1438                      // Change NIB state to router for restore
   1439                      _NIB.nwkState = NWK_ROUTER;
   1440                    }
   1441                  }
   1442          
   1443                  if ( devState == DEV_NWK_JOINING )
   \   000035   90....       MOV     DPTR,#devState
   \   000038   E0           MOVX    A,@DPTR
   \   000039   6403         XRL     A,#0x3
   \   00003B   7003         JNZ     ??ZDApp_ProcessNetworkJoin_4
   1444                  {
   1445                    ZDApp_AnnounceNewAddress();
   \   00003D                ; Setup parameters for call to function ZDApp_AnnounceNewAddress
   \   00003D   12....       LCALL   ??ZDApp_AnnounceNewAddress?relay
   1446                  }
   1447          
   1448                  devState = DEV_END_DEVICE;
   \                     ??ZDApp_ProcessNetworkJoin_4:
   \   000040   90....       MOV     DPTR,#devState
   \   000043   7406         MOV     A,#0x6
   \   000045   F0           MOVX    @DPTR,A
   1449                  if ( ZSTACK_ROUTER_BUILD )
   \   000046   02....       LJMP    ??CrossCallReturnLabel_63 & 0xFFFF
   1450                  {
   1451                    // NOTE: first two parameters are not used, see NLMEDE.h for details
   1452                    if ( ZDO_Config_Node_Descriptor.LogicalType != NODETYPE_DEVICE )
   1453                    {
   1454                      NLME_StartRouterRequest( 0, 0, false );
   1455                    }
   1456                  }
   1457                }
   1458              }
   1459              else
   1460              {
   1461                if ( (devStartMode == MODE_RESUME) && (++retryCnt >= MAX_RESUME_RETRY) )
   \                     ??ZDApp_ProcessNetworkJoin_3:
   \   000049   90....       MOV     DPTR,#devStartMode
   \   00004C   E0           MOVX    A,@DPTR
   \   00004D   6401         XRL     A,#0x1
   \   00004F   7036         JNZ     ??ZDApp_ProcessNetworkJoin_5
   \   000051   90....       MOV     DPTR,#retryCnt
   \   000054   E0           MOVX    A,@DPTR
   \   000055   04           INC     A
   \   000056   F0           MOVX    @DPTR,A
   \   000057   C3           CLR     C
   \   000058   9403         SUBB    A,#0x3
   \   00005A   402B         JC      ??ZDApp_ProcessNetworkJoin_5
   1462                {
   1463                  if ( _NIB.nwkPanId == 0xFFFF || _NIB.nwkPanId == INVALID_PAN_ID )
   \   00005C   90....       MOV     DPTR,#_NIB + 33
   \   00005F   E0           MOVX    A,@DPTR
   \   000060   F4           CPL     A
   \   000061   7003         JNZ     ??ZDApp_ProcessNetworkJoin_6
   \   000063   A3           INC     DPTR
   \   000064   E0           MOVX    A,@DPTR
   \   000065   F4           CPL     A
   \                     ??ZDApp_ProcessNetworkJoin_6:
   \   000066   600D         JZ      ??ZDApp_ProcessNetworkJoin_7
   \   000068   90....       MOV     DPTR,#_NIB + 33
   \   00006B   E0           MOVX    A,@DPTR
   \   00006C   64FE         XRL     A,#0xfe
   \   00006E   7003         JNZ     ??ZDApp_ProcessNetworkJoin_8
   \   000070   A3           INC     DPTR
   \   000071   E0           MOVX    A,@DPTR
   \   000072   F4           CPL     A
   \                     ??ZDApp_ProcessNetworkJoin_8:
   \   000073   7006         JNZ     ??ZDApp_ProcessNetworkJoin_9
   1464                    devStartMode = MODE_JOIN;
   \                     ??ZDApp_ProcessNetworkJoin_7:
   \   000075   90....       MOV     DPTR,#devStartMode
   \   000078   E4           CLR     A
   \   000079   800B         SJMP    ??ZDApp_ProcessNetworkJoin_10
   1465                  else
   1466                  {
   1467                    devStartMode = MODE_REJOIN;
   \                     ??ZDApp_ProcessNetworkJoin_9:
   \   00007B   90....       MOV     DPTR,#devStartMode
   \   00007E   7403         MOV     A,#0x3
   \   000080   F0           MOVX    @DPTR,A
   1468                    _tmpRejoinState = true;
   \   000081   90....       MOV     DPTR,#_tmpRejoinState
   \   000084   7401         MOV     A,#0x1
   \                     ??ZDApp_ProcessNetworkJoin_10:
   \   000086   F0           MOVX    @DPTR,A
   1469                  }
   1470                }
   1471          
   1472                if ( (NLME_GetShortAddr() != INVALID_NODE_ADDR) ||
   1473                     (_NIB.nwkDevAddress != INVALID_NODE_ADDR) )
   \                     ??ZDApp_ProcessNetworkJoin_5:
   \   000087                ; Setup parameters for call to function NLME_GetShortAddr
   \   000087   12....       LCALL   ??NLME_GetShortAddr?relay
   \   00008A   8A..         MOV     ?V0 + 0,R2
   \   00008C   8B..         MOV     ?V0 + 1,R3
   \   00008E   74FE         MOV     A,#-0x2
   \   000090   65..         XRL     A,?V0 + 0
   \   000092   7004         JNZ     ??ZDApp_ProcessNetworkJoin_11
   \   000094   74FF         MOV     A,#-0x1
   \   000096   65..         XRL     A,?V0 + 1
   \                     ??ZDApp_ProcessNetworkJoin_11:
   \   000098   700D         JNZ     ??ZDApp_ProcessNetworkJoin_12
   \   00009A   90....       MOV     DPTR,#_NIB + 20
   \   00009D   E0           MOVX    A,@DPTR
   \   00009E   64FE         XRL     A,#0xfe
   \   0000A0   7003         JNZ     ??ZDApp_ProcessNetworkJoin_13
   \   0000A2   A3           INC     DPTR
   \   0000A3   E0           MOVX    A,@DPTR
   \   0000A4   F4           CPL     A
   \                     ??ZDApp_ProcessNetworkJoin_13:
   \   0000A5   601B         JZ      ??ZDApp_ProcessNetworkJoin_14
   1474                {
   1475                  uint16 addr = INVALID_NODE_ADDR;
   \                     ??ZDApp_ProcessNetworkJoin_12:
   \   0000A7   85..82       MOV     DPL,?XSP + 0
   \   0000AA   85..83       MOV     DPH,?XSP + 1
   \   0000AD   74FE         MOV     A,#-0x2
   \   0000AF   F0           MOVX    @DPTR,A
   \   0000B0   A3           INC     DPTR
   \   0000B1   04           INC     A
   \   0000B2   F0           MOVX    @DPTR,A
   1476                  // Invalidate nwk addr so end device does not use in its data reqs.
   1477                  _NIB.nwkDevAddress = INVALID_NODE_ADDR;
   \   0000B3   90....       MOV     DPTR,#_NIB + 20
   \   0000B6   14           DEC     A
   \   0000B7   F0           MOVX    @DPTR,A
   \   0000B8   A3           INC     DPTR
   \   0000B9   04           INC     A
   \   0000BA   12....       LCALL   ?Subroutine13 & 0xFFFF
   1478                  ZMacSetReq( ZMacShortAddress, (uint8 *)&addr );
   1479                }
   \                     ??CrossCallReturnLabel_8:
   \   0000BD   7953         MOV     R1,#0x53
   \   0000BF   12....       LCALL   ??ZMacSetReq?relay
   1480          
   1481                // Clear the neighbor Table and network discovery tables.
   1482                nwkNeighborInitTable();
   \                     ??ZDApp_ProcessNetworkJoin_14:
   \   0000C2                ; Setup parameters for call to function nwkNeighborInitTable
   \   0000C2   12....       LCALL   ??nwkNeighborInitTable?relay
   1483                NLME_NwkDiscTerm();
   \   0000C5                ; Setup parameters for call to function NLME_NwkDiscTerm
   \   0000C5   12....       LCALL   ??NLME_NwkDiscTerm?relay
   1484          
   1485                zdoDiscCounter = 1;
   \   0000C8   90....       MOV     DPTR,#zdoDiscCounter
   \   0000CB   7401         MOV     A,#0x1
   \   0000CD   F0           MOVX    @DPTR,A
   1486          
   1487          //      ZDApp_NetworkInit( (uint16)
   1488          //                         ((NWK_START_DELAY * (osal_rand() & 0x0F)) +
   1489          //                          (NWK_START_DELAY * 5)) );
   1490                ZDApp_NetworkInit( (uint16)(NWK_START_DELAY
   1491                     + ((uint16)(osal_rand()& EXTENDED_JOINING_RANDOM_MASK))) );
   \   0000CE                ; Setup parameters for call to function ZDApp_NetworkInit
   \   0000CE                ; Setup parameters for call to function osal_rand
   1492              }
   1493            }
   \                     ??ZDApp_ProcessNetworkJoin_15:
   \   0000CE   12....       LCALL   ?Subroutine28 & 0xFFFF
   \                     ??CrossCallReturnLabel_35:
   \   0000D1   807C         SJMP    ??CrossCallReturnLabel_63
   1494            else if ( devState == DEV_NWK_ORPHAN || devState == DEV_NWK_REJOIN )
   \                     ??ZDApp_ProcessNetworkJoin_1:
   \   0000D3   E0           MOVX    A,@DPTR
   \   0000D4   6404         XRL     A,#0x4
   \   0000D6   7069         JNZ     ??ZDApp_ProcessNetworkJoin_16
   1495            {
   1496              // results of an orphaning attempt by this device
   1497              if (nwkStatus == ZSuccess)
   \                     ??ZDApp_ProcessNetworkJoin_2:
   \   0000D8   90....       MOV     DPTR,#nwkStatus
   \   0000DB   E0           MOVX    A,@DPTR
   \   0000DC   7013         JNZ     ??ZDApp_ProcessNetworkJoin_17
   1498              {
   1499                if ( ZG_SECURE_ENABLED )
   1500                {
   1501                  ZDApp_RestoreNwkKey();
   1502                }
   1503          
   1504                devState = DEV_END_DEVICE;
   \   0000DE   12....       LCALL   ?Subroutine9 & 0xFFFF
   1505                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   1506                // setup Power Manager Device
   1507          #if defined ( POWER_SAVING )
   1508                osal_pwrmgr_device( PWRMGR_BATTERY );
   1509          #endif
   1510          
   1511                if ( ZDO_Config_Node_Descriptor.CapabilityFlags & CAPINFO_RCVR_ON_IDLE )
   \                     ??CrossCallReturnLabel_1:
   \   0000E1   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   0000E4   E0           MOVX    A,@DPTR
   \   0000E5   A2E3         MOV     C,0xE0 /* A   */.3
   \   0000E7   5003         JNC     ??CrossCallReturnLabel_84
   1512                {
   1513                  // The receiver is on, turn network layer polling off.
   1514                  NLME_SetPollRate( 0 );
   \   0000E9                ; Setup parameters for call to function NLME_SetPollRate
   \   0000E9   12....       LCALL   ?Subroutine27 & 0xFFFF
   1515                  NLME_SetQueuedPollRate( 0 );
   1516                  NLME_SetResponseRate( 0 );
   1517                }
   1518          
   1519                if ( ZSTACK_ROUTER_BUILD )
   1520                {
   1521                  // NOTE: first two parameters are not used, see NLMEDE.h for details
   1522                  if ( ZDO_Config_Node_Descriptor.LogicalType != NODETYPE_DEVICE )
   1523                  {
   1524                    NLME_StartRouterRequest( 0, 0, false );
   1525                  }
   1526                }
   1527          
   1528                ZDApp_AnnounceNewAddress();
   \                     ??CrossCallReturnLabel_84:
   \   0000EC                ; Setup parameters for call to function ZDApp_AnnounceNewAddress
   \   0000EC   12....       LCALL   ??ZDApp_AnnounceNewAddress?relay
   \   0000EF   805E         SJMP    ??CrossCallReturnLabel_63
   1529              }
   1530              else
   1531              {
   1532                if ( devStartMode == MODE_RESUME )
   \                     ??ZDApp_ProcessNetworkJoin_17:
   \   0000F1   90....       MOV     DPTR,#devStartMode
   \   0000F4   E0           MOVX    A,@DPTR
   \   0000F5   6401         XRL     A,#0x1
   \   0000F7   7040         JNZ     ??ZDApp_ProcessNetworkJoin_18
   1533                {
   1534                  if ( ++retryCnt <= MAX_RESUME_RETRY )
   \   0000F9   90....       MOV     DPTR,#retryCnt
   \   0000FC   E0           MOVX    A,@DPTR
   \   0000FD   04           INC     A
   \   0000FE   F0           MOVX    @DPTR,A
   \   0000FF   C3           CLR     C
   \   000100   9404         SUBB    A,#0x4
   \   000102   502D         JNC     ??ZDApp_ProcessNetworkJoin_19
   1535                  {
   1536                    if ( _NIB.nwkPanId == 0xFFFF || _NIB.nwkPanId == INVALID_PAN_ID )
   \   000104   90....       MOV     DPTR,#_NIB + 33
   \   000107   E0           MOVX    A,@DPTR
   \   000108   F4           CPL     A
   \   000109   7003         JNZ     ??ZDApp_ProcessNetworkJoin_20
   \   00010B   A3           INC     DPTR
   \   00010C   E0           MOVX    A,@DPTR
   \   00010D   F4           CPL     A
   \                     ??ZDApp_ProcessNetworkJoin_20:
   \   00010E   600D         JZ      ??ZDApp_ProcessNetworkJoin_21
   \   000110   90....       MOV     DPTR,#_NIB + 33
   \   000113   E0           MOVX    A,@DPTR
   \   000114   64FE         XRL     A,#0xfe
   \   000116   7003         JNZ     ??ZDApp_ProcessNetworkJoin_22
   \   000118   A3           INC     DPTR
   \   000119   E0           MOVX    A,@DPTR
   \   00011A   F4           CPL     A
   \                     ??ZDApp_ProcessNetworkJoin_22:
   \   00011B   7007         JNZ     ??ZDApp_ProcessNetworkJoin_23
   1537                      devStartMode = MODE_JOIN;
   \                     ??ZDApp_ProcessNetworkJoin_21:
   \   00011D   90....       MOV     DPTR,#devStartMode
   \   000120   E4           CLR     A
   \                     ??ZDApp_ProcessNetworkJoin_24:
   \   000121   F0           MOVX    @DPTR,A
   \   000122   8015         SJMP    ??ZDApp_ProcessNetworkJoin_18
   1538                    else
   1539                    {
   1540                      devStartMode = MODE_REJOIN;
   \                     ??ZDApp_ProcessNetworkJoin_23:
   \   000124   90....       MOV     DPTR,#devStartMode
   \   000127   7403         MOV     A,#0x3
   \   000129   F0           MOVX    @DPTR,A
   1541                      _tmpRejoinState = true;
   \   00012A   90....       MOV     DPTR,#_tmpRejoinState
   \   00012D   7401         MOV     A,#0x1
   \   00012F   80F0         SJMP    ??ZDApp_ProcessNetworkJoin_24
   1542                    }
   1543                  }
   1544                  // Do a normal join to the network after certain times of rejoin retries
   1545                  else if( AIB_apsUseInsecureJoin == true )
   \                     ??ZDApp_ProcessNetworkJoin_19:
   \   000131   90....       MOV     DPTR,#AIB_apsUseInsecureJoin
   \   000134   E0           MOVX    A,@DPTR
   \   000135   6401         XRL     A,#0x1
   \   000137   60E4         JZ      ??ZDApp_ProcessNetworkJoin_21
   1546                  {
   1547                    devStartMode = MODE_JOIN;
   1548                  }
   1549                }
   1550          
   1551                // Clear the neighbor Table and network discovery tables.
   1552                nwkNeighborInitTable();
   \                     ??ZDApp_ProcessNetworkJoin_18:
   \   000139                ; Setup parameters for call to function nwkNeighborInitTable
   \   000139   12....       LCALL   ??nwkNeighborInitTable?relay
   1553                NLME_NwkDiscTerm();
   \   00013C                ; Setup parameters for call to function NLME_NwkDiscTerm
   \   00013C   12....       LCALL   ??NLME_NwkDiscTerm?relay
   1554          
   1555                // setup a retry for later...
   1556                ZDApp_NetworkInit( (uint16)(NWK_START_DELAY
   1557                     + (osal_rand()& EXTENDED_JOINING_RANDOM_MASK)) );
   \   00013F                ; Setup parameters for call to function ZDApp_NetworkInit
   \   00013F                ; Setup parameters for call to function osal_rand
   \   00013F   808D         SJMP    ??ZDApp_ProcessNetworkJoin_15
   1558              }
   1559            }
   1560          #if defined ( ZIGBEE_STOCHASTIC_ADDRESSING )
   1561            else
   1562            {
   1563              // Assume from address conflict
   1564              if ( _NIB.nwkAddrAlloc == NWK_ADDRESSING_STOCHASTIC )
   \                     ??ZDApp_ProcessNetworkJoin_16:
   \   000141   90....       MOV     DPTR,#_NIB + 96
   \   000144   E0           MOVX    A,@DPTR
   \   000145   6402         XRL     A,#0x2
   \   000147   7006         JNZ     ??CrossCallReturnLabel_63
   1565              {
   1566                // Notify the network
   1567                ZDApp_AnnounceNewAddress();
   \   000149                ; Setup parameters for call to function ZDApp_AnnounceNewAddress
   \   000149   12....       LCALL   ??ZDApp_AnnounceNewAddress?relay
   1568          
   1569                // Notify apps
   1570                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   00014C                ; Setup parameters for call to function osal_set_event
   \   00014C   12....       LCALL   ?Subroutine18 & 0xFFFF
   1571              }
   1572            }
   1573          #endif
   1574          }
   \                     ??CrossCallReturnLabel_63:
   \   00014F   02....       LJMP    ?Subroutine7 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine13:
   \   000000   F0           MOVX    @DPTR,A
   \   000001                ; Setup parameters for call to function ZMacSetReq
   \   000001                ; Setup parameters for indirect call
   \   000001   85..82       MOV     DPL,?XSP + 0
   \   000004   85..83       MOV     DPH,?XSP + 1
   \   000007   AA82         MOV     R2,DPL
   \   000009   AB83         MOV     R3,DPH
   \   00000B   22           RET
   1575          
   1576          /*********************************************************************
   1577           * @fn      ZDApp_SaveNwkKey()
   1578           *
   1579           * @brief   Save off the Network key information.
   1580           *
   1581           * @param   none
   1582           *
   1583           * @return  none
   1584           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine4:
   \   000000   7415         MOV     A,#0x15
   \   000002                REQUIRE ??Subroutine45_0
   \   000002                ; // Fall through to label ??Subroutine45_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1585          void ZDApp_SaveNwkKey( void )
   \                     ZDApp_SaveNwkKey:
   1586          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 21
   \   000005   74EB         MOV     A,#-0x15
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1587            nwkActiveKeyItems keyItems;
   1588          
   1589            SSP_ReadNwkActiveKey( &keyItems );
   \   00000A                ; Setup parameters for call to function SSP_ReadNwkActiveKey
   \   00000A   85..82       MOV     DPL,?XSP + 0
   \   00000D   85..83       MOV     DPH,?XSP + 1
   \   000010   AA82         MOV     R2,DPL
   \   000012   AB83         MOV     R3,DPH
   \   000014   12....       LCALL   ??SSP_ReadNwkActiveKey?relay
   1590            keyItems.frameCounter++;
   \   000017   90....       MOV     DPTR,#__Constant_1
   \   00001A   78..         MOV     R0,#?V0 + 0
   \   00001C   12....       LCALL   ?L_MOV_X
   \   00001F   7411         MOV     A,#0x11
   \   000021   12....       LCALL   ?XSTACK_DISP0_8
   \   000024   78..         MOV     R0,#?V0 + 0
   \   000026   12....       LCALL   ?L_ADD_TO_X
   1591          
   1592            osal_nv_write( ZCD_NV_NWKKEY, 0, sizeof( nwkActiveKeyItems ),
   1593                          (void *)&keyItems );
   \   000029                ; Setup parameters for call to function osal_nv_write
   \   000029   85..82       MOV     DPL,?XSP + 0
   \   00002C   85..83       MOV     DPH,?XSP + 1
   \   00002F   8582..       MOV     ?V0 + 0,DPL
   \   000032   8583..       MOV     ?V0 + 1,DPH
   \   000035   78..         MOV     R0,#?V0 + 0
   \   000037   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00003A   75..15       MOV     ?V0 + 0,#0x15
   \   00003D   75..00       MOV     ?V0 + 1,#0x0
   \   000040   78..         MOV     R0,#?V0 + 0
   \   000042   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000045   7C00         MOV     R4,#0x0
   \   000047   7D00         MOV     R5,#0x0
   \   000049   7A82         MOV     R2,#-0x7e
   \   00004B   7B00         MOV     R3,#0x0
   \   00004D   12....       LCALL   ??osal_nv_write?relay
   \   000050   7404         MOV     A,#0x4
   \   000052   12....       LCALL   ?DEALLOC_XSTACK8
   1594          
   1595            nwkFrameCounterChanges = 0;
   \   000055   90....       MOV     DPTR,#nwkFrameCounterChanges
   \   000058   E4           CLR     A
   \   000059   F0           MOVX    @DPTR,A
   \   00005A   A3           INC     DPTR
   \   00005B   F0           MOVX    @DPTR,A
   1596          
   1597            // Clear copy in RAM before return.
   1598            osal_memset( &keyItems, 0x00, sizeof(keyItems) );
   \   00005C                ; Setup parameters for call to function osal_memset
   \   00005C   7C15         MOV     R4,#0x15
   \   00005E   FD           MOV     R5,A
   \   00005F   F9           MOV     R1,A
   \   000060   85..82       MOV     DPL,?XSP + 0
   \   000063   85..83       MOV     DPH,?XSP + 1
   \   000066   AA82         MOV     R2,DPL
   \   000068   AB83         MOV     R3,DPH
   \   00006A   12....       LCALL   ??osal_memset?relay
   1599          
   1600          }
   \   00006D   02....       LJMP    ?Subroutine4 & 0xFFFF
   1601          
   1602          /*********************************************************************
   1603           * @fn      ZDApp_ResetNwkKey()
   1604           *
   1605           * @brief   Reset the Network key information in NV.
   1606           *
   1607           * @param   none
   1608           *
   1609           * @return  none
   1610           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1611          void ZDApp_ResetNwkKey( void )
   \                     ZDApp_ResetNwkKey:
   1612          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 21
   \   000005   74EB         MOV     A,#-0x15
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1613            nwkActiveKeyItems keyItems;
   1614          
   1615            osal_memset( &keyItems, 0, sizeof( nwkActiveKeyItems ) );
   \   00000A                ; Setup parameters for call to function osal_memset
   \   00000A   7C15         MOV     R4,#0x15
   \   00000C   12....       LCALL   ?Subroutine33 & 0xFFFF
   1616            osal_nv_write( ZCD_NV_NWKKEY, 0, sizeof( nwkActiveKeyItems ),
   1617                          (void *)&keyItems );
   \                     ??CrossCallReturnLabel_43:
   \   00000F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000012   75..15       MOV     ?V0 + 0,#0x15
   \   000015   75..00       MOV     ?V0 + 1,#0x0
   \   000018   78..         MOV     R0,#?V0 + 0
   \   00001A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00001D   7C00         MOV     R4,#0x0
   \   00001F   7D00         MOV     R5,#0x0
   \   000021   7A82         MOV     R2,#-0x7e
   \   000023   7B00         MOV     R3,#0x0
   \   000025   12....       LCALL   ??osal_nv_write?relay
   \   000028   7404         MOV     A,#0x4
   \   00002A   12....       LCALL   ?DEALLOC_XSTACK8
   1618          }
   \   00002D   02....       LJMP    ?Subroutine8 & 0xFFFF
   1619          
   1620          /*********************************************************************
   1621           * @fn      ZDApp_RestoreNwkKey()
   1622           *
   1623           * @brief
   1624           *
   1625           *   Save off the Network key information.
   1626           *
   1627           * @param   none
   1628           *
   1629           * @return  true if restored from NV, false if not
   1630           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1631          uint8 ZDApp_RestoreNwkKey( void )
   \                     ZDApp_RestoreNwkKey:
   1632          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 21
   \   000005   74EB         MOV     A,#-0x15
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1633            nwkActiveKeyItems keyItems;
   1634            uint8 ret = false;
   \   00000A   7E00         MOV     R6,#0x0
   1635          
   1636            if ( osal_nv_read( ZCD_NV_NWKKEY, 0, sizeof(nwkActiveKeyItems), (void*)&keyItems )
   1637                == ZSUCCESS )
   \   00000C                ; Setup parameters for call to function osal_nv_read
   \   00000C   85..82       MOV     DPL,?XSP + 0
   \   00000F   85..83       MOV     DPH,?XSP + 1
   \   000012   8582..       MOV     ?V0 + 0,DPL
   \   000015   8583..       MOV     ?V0 + 1,DPH
   \   000018   78..         MOV     R0,#?V0 + 0
   \   00001A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00001D   75..15       MOV     ?V0 + 0,#0x15
   \   000020   8E..         MOV     ?V0 + 1,R6
   \   000022   78..         MOV     R0,#?V0 + 0
   \   000024   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000027   7C00         MOV     R4,#0x0
   \   000029   7D00         MOV     R5,#0x0
   \   00002B   7A82         MOV     R2,#-0x7e
   \   00002D   12....       LCALL   ?Subroutine35 & 0xFFFF
   \                     ??CrossCallReturnLabel_45:
   \   000030   12....       LCALL   ?DEALLOC_XSTACK8
   \   000033   E9           MOV     A,R1
   \   000034   703F         JNZ     ??ZDApp_RestoreNwkKey_0
   1638            {
   1639              if ( keyItems.frameCounter > 0 )
   \   000036   7411         MOV     A,#0x11
   \   000038   12....       LCALL   ?XSTACK_DISP0_8
   \   00003B   78..         MOV     R0,#?V0 + 0
   \   00003D   12....       LCALL   ?L_MOV_X
   \   000040   E5..         MOV     A,?V0 + 0
   \   000042   45..         ORL     A,?V0 + 1
   \   000044   45..         ORL     A,?V0 + 2
   \   000046   45..         ORL     A,?V0 + 3
   \   000048   6021         JZ      ??ZDApp_RestoreNwkKey_1
   1640              {
   1641                // Restore the key information
   1642                keyItems.frameCounter += MAX_NWK_FRAMECOUNTER_CHANGES;
   \   00004A   90....       MOV     DPTR,#__Constant_3e8
   \   00004D   78..         MOV     R0,#?V0 + 0
   \   00004F   12....       LCALL   ?L_MOV_X
   \   000052   7411         MOV     A,#0x11
   \   000054   12....       LCALL   ?XSTACK_DISP0_8
   \   000057   78..         MOV     R0,#?V0 + 0
   \   000059   12....       LCALL   ?L_ADD_TO_X
   1643                nwkFrameCounter = keyItems.frameCounter;
   \   00005C   7411         MOV     A,#0x11
   \   00005E   12....       LCALL   ?XSTACK_DISP0_8
   \   000061   12....       LCALL   ?XLOAD_R2345
   \   000064   90....       MOV     DPTR,#nwkFrameCounter
   \   000067   12....       LCALL   ?XSTORE_R2345
   1644                ret = true;
   \   00006A   0E           INC     R6
   1645              }
   1646          
   1647              // Force a save for the first frame counter increment
   1648              nwkFrameCounterChanges = MAX_NWK_FRAMECOUNTER_CHANGES + 1;
   \                     ??ZDApp_RestoreNwkKey_1:
   \   00006B   90....       MOV     DPTR,#nwkFrameCounterChanges
   \   00006E   74E9         MOV     A,#-0x17
   \   000070   F0           MOVX    @DPTR,A
   \   000071   A3           INC     DPTR
   \   000072   7403         MOV     A,#0x3
   \   000074   F0           MOVX    @DPTR,A
   1649            }
   1650            // Clear copy in RAM before return.
   1651            osal_memset( &keyItems, 0x00, sizeof(keyItems) );
   \                     ??ZDApp_RestoreNwkKey_0:
   \   000075                ; Setup parameters for call to function osal_memset
   \   000075   7C15         MOV     R4,#0x15
   \   000077   7D00         MOV     R5,#0x0
   \   000079   7900         MOV     R1,#0x0
   \   00007B   85..82       MOV     DPL,?XSP + 0
   \   00007E   85..83       MOV     DPH,?XSP + 1
   \   000081   AA82         MOV     R2,DPL
   \   000083   AB83         MOV     R3,DPH
   \   000085   12....       LCALL   ??osal_memset?relay
   1652          
   1653            return ( ret );
   \   000088   EE           MOV     A,R6
   \   000089   F9           MOV     R1,A
   \   00008A   02....       LJMP    ?Subroutine4 & 0xFFFF
   1654          }
   1655          
   1656          /*********************************************************************
   1657           * @fn      ZDApp_ResetTimerStart
   1658           *
   1659           * @brief   Start the reset timer.
   1660           *
   1661           * @param   delay - delay time(ms) before reset
   1662           *
   1663           * @return  none
   1664           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1665          void ZDApp_ResetTimerStart( uint16 delay )
   \                     ZDApp_ResetTimerStart:
   1666          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1667            // Start the rest timer
   1668            osal_start_timerEx( ZDAppTaskID, ZDO_DEVICE_RESET, delay );
   \   000004                ; Setup parameters for call to function osal_start_timerEx
   \   000004   EA           MOV     A,R2
   \   000005   FC           MOV     R4,A
   \   000006   EB           MOV     A,R3
   \   000007   FD           MOV     R5,A
   \   000008   7A04         MOV     R2,#0x4
   \   00000A   12....       LCALL   ?Subroutine25 & 0xFFFF
   1669          }
   \                     ??CrossCallReturnLabel_86:
   \   00000D   02....       LJMP    ?Subroutine2 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine25:
   \   000000   7B00         MOV     R3,#0x0
   \   000002   90....       MOV     DPTR,#ZDAppTaskID
   \   000005                REQUIRE ??Subroutine49_0
   \   000005                ; // Fall through to label ??Subroutine49_0
   1670          
   1671          /*********************************************************************
   1672           * @fn      ZDApp_ResetTimerCancel
   1673           *
   1674           * @brief   Cancel the reset timer.
   1675           *
   1676           * @param   none
   1677           *
   1678           * @return  none
   1679           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1680          void ZDApp_ResetTimerCancel( void )
   \                     ZDApp_ResetTimerCancel:
   1681          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1682            // Cancel the reset timer
   1683            osal_stop_timerEx( ZDAppTaskID, ZDO_DEVICE_RESET );
   \   000004                ; Setup parameters for call to function osal_stop_timerEx
   \   000004   7A04         MOV     R2,#0x4
   \   000006   7B00         MOV     R3,#0x0
   \   000008   90....       MOV     DPTR,#ZDAppTaskID
   \   00000B   E0           MOVX    A,@DPTR
   \   00000C   F9           MOV     R1,A
   \   00000D   12....       LCALL   ??osal_stop_timerEx?relay
   1684          }
   \   000010   02....       LJMP    ?Subroutine2 & 0xFFFF
   1685          
   1686          /*********************************************************************
   1687           * @fn      ZDApp_LeaveCtrlInit
   1688           *
   1689           * @brief   Initialize the leave control logic.
   1690           *
   1691           * @param   none
   1692           *
   1693           * @return  none
   1694           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1695          void ZDApp_LeaveCtrlInit( void )
   \                     ZDApp_LeaveCtrlInit:
   1696          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   1697            uint8 status;
   1698          
   1699          
   1700            // Initialize control state
   1701            ZDApp_LeaveCtrl = ZDAPP_LEAVE_CTRL_INIT;
   \   000005   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   000008   E4           CLR     A
   \   000009   F0           MOVX    @DPTR,A
   1702          
   1703            status = osal_nv_item_init( ZCD_NV_LEAVE_CTRL,
   1704                                        sizeof(ZDApp_LeaveCtrl),
   1705                                        &ZDApp_LeaveCtrl );
   1706          
   1707            if ( status == ZSUCCESS )
   \   00000A                ; Setup parameters for call to function osal_nv_item_init
   \   00000A   75....       MOV     ?V0 + 0,#ZDApp_LeaveCtrl & 0xff
   \   00000D   75....       MOV     ?V0 + 1,#(ZDApp_LeaveCtrl >> 8) & 0xff
   \   000010   78..         MOV     R0,#?V0 + 0
   \   000012   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000015   7C01         MOV     R4,#0x1
   \   000017   7D00         MOV     R5,#0x0
   \   000019   7A85         MOV     R2,#-0x7b
   \   00001B   7B00         MOV     R3,#0x0
   \   00001D   12....       LCALL   ??osal_nv_item_init?relay
   \   000020   7402         MOV     A,#0x2
   \   000022   12....       LCALL   ?DEALLOC_XSTACK8
   \   000025   E9           MOV     A,R1
   \   000026   701C         JNZ     ??ZDApp_LeaveCtrlInit_0
   1708            {
   1709              // Read saved control
   1710              osal_nv_read( ZCD_NV_LEAVE_CTRL,
   1711                            0,
   1712                            sizeof( uint8 ),
   1713                            &ZDApp_LeaveCtrl);
   \   000028                ; Setup parameters for call to function osal_nv_read
   \   000028   78..         MOV     R0,#?V0 + 0
   \   00002A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00002D   75..01       MOV     ?V0 + 0,#0x1
   \   000030   75..00       MOV     ?V0 + 1,#0x0
   \   000033   78..         MOV     R0,#?V0 + 0
   \   000035   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000038   7C00         MOV     R4,#0x0
   \   00003A   7D00         MOV     R5,#0x0
   \   00003C   7A85         MOV     R2,#-0x7b
   \   00003E   12....       LCALL   ?Subroutine35 & 0xFFFF
   1714            }
   \                     ??CrossCallReturnLabel_46:
   \   000041   12....       LCALL   ?DEALLOC_XSTACK8
   1715          }
   \                     ??ZDApp_LeaveCtrlInit_0:
   \   000044   02....       LJMP    ??Subroutine52_0 & 0xFFFF
   1716          
   1717          /*********************************************************************
   1718           * @fn      ZDApp_LeaveCtrlSet
   1719           *
   1720           * @brief   Set the leave control logic.
   1721           *
   1722           * @param   ra - reassociate flag
   1723           *
   1724           * @return  none
   1725           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1726          void ZDApp_LeaveCtrlSet( uint8 ra )
   \                     ZDApp_LeaveCtrlSet:
   1727          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   1728            ZDApp_LeaveCtrl = ZDAPP_LEAVE_CTRL_SET;
   \   000007   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   00000A   7401         MOV     A,#0x1
   \   00000C   F0           MOVX    @DPTR,A
   1729          
   1730            if ( ra == TRUE )
   \   00000D   6E           XRL     A,R6
   \   00000E   7003         JNZ     ??ZDApp_LeaveCtrlSet_0
   1731            {
   1732              ZDApp_LeaveCtrl |= ZDAPP_LEAVE_CTRL_RA;
   \   000010   7403         MOV     A,#0x3
   \   000012   F0           MOVX    @DPTR,A
   1733            }
   1734          
   1735            // Write the leave control
   1736            osal_nv_write( ZCD_NV_LEAVE_CTRL,
   1737                           0,
   1738                           sizeof( uint8 ),
   1739                           &ZDApp_LeaveCtrl);
   \                     ??ZDApp_LeaveCtrlSet_0:
   \   000013                ; Setup parameters for call to function osal_nv_write
   \   000013   02....       LJMP    ?Subroutine1 & 0xFFFF
   1740          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   75....       MOV     ?V0 + 0,#ZDApp_LeaveCtrl & 0xff
   \   000003   75....       MOV     ?V0 + 1,#(ZDApp_LeaveCtrl >> 8) & 0xff
   \   000006   78..         MOV     R0,#?V0 + 0
   \   000008   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00000B   75..01       MOV     ?V0 + 0,#0x1
   \   00000E   75..00       MOV     ?V0 + 1,#0x0
   \   000011   78..         MOV     R0,#?V0 + 0
   \   000013   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000016   7C00         MOV     R4,#0x0
   \   000018   7D00         MOV     R5,#0x0
   \   00001A   7A85         MOV     R2,#-0x7b
   \   00001C   7B00         MOV     R3,#0x0
   \   00001E   12....       LCALL   ??osal_nv_write?relay
   \   000021   7404         MOV     A,#0x4
   \   000023                REQUIRE ??Subroutine51_0
   \   000023                ; // Fall through to label ??Subroutine51_0
   1741          
   1742          /*********************************************************************
   1743           * @fn      ZDApp_LeaveCtrlReset
   1744           *
   1745           * @brief   Re-initialize the leave control logic.
   1746           *
   1747           * @param   none
   1748           *
   1749           * @return  none
   1750           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1751          void ZDApp_LeaveCtrlReset( void )
   \                     ZDApp_LeaveCtrlReset:
   1752          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   1753            // Set leave control to initialized state
   1754            ZDApp_LeaveCtrl = ZDAPP_LEAVE_CTRL_INIT;
   \   000005   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   000008   E4           CLR     A
   \   000009   F0           MOVX    @DPTR,A
   1755          
   1756            // Write initialized control
   1757            osal_nv_write( ZCD_NV_LEAVE_CTRL,
   1758                          0,
   1759                          sizeof( uint8 ),
   1760                          &ZDApp_LeaveCtrl);
   \   00000A                ; Setup parameters for call to function osal_nv_write
   \   00000A   02....       LJMP    ?Subroutine1 & 0xFFFF
   1761          }
   1762          
   1763          /*********************************************************************
   1764           * @fn      ZDApp_LeaveCtrlBypass
   1765           *
   1766           * @brief   Check if NV restore should be skipped during a leave reset.
   1767           *
   1768           * @param   none
   1769           *
   1770           * @return  uint8 - (TRUE bypass:FALSE do not bypass)
   1771           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1772          uint8 ZDApp_LeaveCtrlBypass( void )
   \                     ZDApp_LeaveCtrlBypass:
   1773          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1774            uint8 bypass;
   1775          
   1776            if ( ZDApp_LeaveCtrl & ZDAPP_LEAVE_CTRL_SET )
   1777            {
   1778              bypass = TRUE;
   1779            }
   1780            else
   1781            {
   1782              bypass = FALSE;
   1783            }
   1784          
   1785            return bypass;
   \   000004   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   000007   E0           MOVX    A,@DPTR
   \   000008   A2E0         MOV     C,0xE0 /* A   */.0
   \   00000A   E4           CLR     A
   \   00000B   33           RLC     A
   \   00000C   F9           MOV     R1,A
   \   00000D   80..         SJMP    ?Subroutine2
   1786          }
   1787          
   1788          /*********************************************************************
   1789           * @fn      ZDApp_LeaveCtrlStartup
   1790           *
   1791           * @brief   Check for startup conditions during a leave reset.
   1792           *
   1793           * @param   state      - devState_t determined by leave control logic
   1794           * @param   startDelay - startup delay
   1795           *
   1796           * @return  none
   1797           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1798          void ZDApp_LeaveCtrlStartup( devStates_t* state, uint16* startDelay )
   \                     ZDApp_LeaveCtrlStartup:
   1799          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1800            *startDelay = 0;
   \   000004   8C82         MOV     DPL,R4
   \   000006   8D83         MOV     DPH,R5
   \   000008   E4           CLR     A
   \   000009   F0           MOVX    @DPTR,A
   \   00000A   A3           INC     DPTR
   \   00000B   F0           MOVX    @DPTR,A
   1801          
   1802            if ( ZDApp_LeaveCtrl & ZDAPP_LEAVE_CTRL_SET )
   \   00000C   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   00000F   E0           MOVX    A,@DPTR
   \   000010   A2E0         MOV     C,0xE0 /* A   */.0
   \   000012   5019         JNC     ??ZDApp_LeaveCtrlStartup_0
   1803            {
   1804              if ( ZDApp_LeaveCtrl & ZDAPP_LEAVE_CTRL_RA )
   \   000014   A2E1         MOV     C,0xE0 /* A   */.1
   \   000016   500C         JNC     ??ZDApp_LeaveCtrlStartup_1
   1805              {
   1806                *startDelay = LEAVE_RESET_DELAY;
   \   000018   8C82         MOV     DPL,R4
   \   00001A   8D83         MOV     DPH,R5
   \   00001C   7488         MOV     A,#-0x78
   \   00001E   F0           MOVX    @DPTR,A
   \   00001F   A3           INC     DPTR
   \   000020   7413         MOV     A,#0x13
   \   000022   8005         SJMP    ??ZDApp_LeaveCtrlStartup_2
   1807              }
   1808              else
   1809              {
   1810                *state = DEV_HOLD;
   \                     ??ZDApp_LeaveCtrlStartup_1:
   \   000024   8A82         MOV     DPL,R2
   \   000026   8B83         MOV     DPH,R3
   \   000028   E4           CLR     A
   \                     ??ZDApp_LeaveCtrlStartup_2:
   \   000029   F0           MOVX    @DPTR,A
   1811              }
   1812          
   1813              // Reset leave control logic
   1814              ZDApp_LeaveCtrlReset();
   \   00002A                ; Setup parameters for call to function ZDApp_LeaveCtrlReset
   \   00002A   12....       LCALL   ??ZDApp_LeaveCtrlReset?relay
   1815            }
   1816          }
   \                     ??ZDApp_LeaveCtrlStartup_0:
   \   00002D                REQUIRE ?Subroutine2
   \   00002D                ; // Fall through to label ?Subroutine2
   1817          
   1818          /*********************************************************************
   1819           * @fn      ZDApp_LeaveReset
   1820           *
   1821           * @brief   Setup a device reset due to a leave indication/confirm.
   1822           *
   1823           * @param   ra - reassociate flag
   1824           *
   1825           * @return  none
   1826           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1827          void ZDApp_LeaveReset( uint8 ra )
   \                     ZDApp_LeaveReset:
   1828          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   1829            ZDApp_LeaveCtrlSet( ra );
   \   000005                ; Setup parameters for call to function ZDApp_LeaveCtrlSet
   \   000005   12....       LCALL   ??ZDApp_LeaveCtrlSet?relay
   1830          
   1831            ZDApp_ResetTimerStart( LEAVE_RESET_DELAY );
   \   000008                ; Setup parameters for call to function ZDApp_ResetTimerStart
   \   000008   7A88         MOV     R2,#-0x78
   \   00000A   7B13         MOV     R3,#0x13
   \   00000C   12....       LCALL   ??ZDApp_ResetTimerStart?relay
   1832          }
   \   00000F   80..         SJMP    ??Subroutine50_0
   1833          
   1834          /*********************************************************************
   1835           * @fn      ZDApp_LeaveUpdate
   1836           *
   1837           * @brief   Update local device data related to leaving device.
   1838           *
   1839           * @param   nwkAddr        - NWK address of leaving device
   1840           * @param   extAddr        - EXT address of leaving device
   1841           * @param   removeChildren - remove children of leaving device
   1842           *
   1843           * @return  none
   1844           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1845          void ZDApp_LeaveUpdate( uint16 nwkAddr, uint8* extAddr,
   \                     ZDApp_LeaveUpdate:
   1846                                  uint8 removeChildren )
   1847          {
   \   000000   74F1         MOV     A,#-0xf
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 15
   \   000005                ; Auto size: 9
   \   000005   74F7         MOV     A,#-0x9
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8A..         MOV     ?V0 + 0,R2
   \   00000C   8B..         MOV     ?V0 + 1,R3
   \   00000E   EC           MOV     A,R4
   \   00000F   FE           MOV     R6,A
   \   000010   ED           MOV     A,R5
   \   000011   FF           MOV     R7,A
   1848            // Remove Apps Key for leaving device
   1849            ZDSecMgrDeviceRemoveByExtAddr(extAddr);
   \   000012                ; Setup parameters for call to function ZDSecMgrDeviceRemoveByExtAddr
   \   000012   EE           MOV     A,R6
   \   000013   FA           MOV     R2,A
   \   000014   EF           MOV     A,R7
   \   000015   FB           MOV     R3,A
   \   000016   12....       LCALL   ??ZDSecMgrDeviceRemoveByExtAddr?relay
   1850          
   1851            // Clear SECURITY bit from Address Manager
   1852            ZDSecMgrAddrClear( extAddr );
   \   000019                ; Setup parameters for call to function ZDSecMgrAddrClear
   \   000019   EE           MOV     A,R6
   \   00001A   FA           MOV     R2,A
   \   00001B   EF           MOV     A,R7
   \   00001C   FB           MOV     R3,A
   \   00001D   12....       LCALL   ??ZDSecMgrAddrClear?relay
   1853          
   1854            if ( pbindRemoveDev )
   \   000020   90....       MOV     DPTR,#pbindRemoveDev
   \   000023   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_13:
   \   000026   603C         JZ      ??ZDApp_LeaveUpdate_0
   1855            {
   1856              zAddrType_t devAddr;
   1857          
   1858              // Remove bind entry and all related data
   1859              devAddr.addrMode = Addr64Bit;
   \   000028   7408         MOV     A,#0x8
   \   00002A   12....       LCALL   ?XSTACK_DISP0_8
   \   00002D   7403         MOV     A,#0x3
   \   00002F   F0           MOVX    @DPTR,A
   1860              osal_memcpy(devAddr.addr.extAddr, extAddr, Z_EXTADDR_LEN);
   \   000030                ; Setup parameters for call to function osal_memcpy
   \   000030   8E..         MOV     ?V0 + 4,R6
   \   000032   8F..         MOV     ?V0 + 5,R7
   \   000034   75..00       MOV     ?V0 + 6,#0x0
   \   000037   78..         MOV     R0,#?V0 + 4
   \   000039   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   00003C   7C08         MOV     R4,#0x8
   \   00003E   7D00         MOV     R5,#0x0
   \   000040   7403         MOV     A,#0x3
   \   000042   12....       LCALL   ?XSTACK_DISP0_8
   \   000045   AA82         MOV     R2,DPL
   \   000047   AB83         MOV     R3,DPH
   \   000049   12....       LCALL   ??osal_memcpy?relay
   \   00004C   7403         MOV     A,#0x3
   \   00004E   12....       LCALL   ?DEALLOC_XSTACK8
   1861          
   1862              pbindRemoveDev(&devAddr);
   \   000051                ; Setup parameters for indirect call
   \   000051   85..82       MOV     DPL,?XSP + 0
   \   000054   85..83       MOV     DPH,?XSP + 1
   \   000057   AA82         MOV     R2,DPL
   \   000059   AB83         MOV     R3,DPH
   \   00005B   90....       MOV     DPTR,#pbindRemoveDev
   \   00005E   12....       LCALL   ??Subroutine57_0 & 0xFFFF
   1863            }
   \                     ??CrossCallReturnLabel_100:
   \   000061   12....       LCALL   ?CALL_IND
   1864          
   1865            // Remove if child
   1866            if ( ZSTACK_ROUTER_BUILD )
   1867            {
   1868              NLME_RemoveChild( extAddr, removeChildren );
   1869            }
   1870          
   1871            // Remove Routing table related entry
   1872            RTG_RemoveRtgEntry( nwkAddr, 0 );
   \                     ??ZDApp_LeaveUpdate_0:
   \   000064                ; Setup parameters for call to function RTG_RemoveRtgEntry
   \   000064   7900         MOV     R1,#0x0
   \   000066   AA..         MOV     R2,?V0 + 0
   \   000068   AB..         MOV     R3,?V0 + 1
   \   00006A   12....       LCALL   ??RTG_RemoveRtgEntry?relay
   1873          
   1874            // Remove entry from neighborTable
   1875            nwkNeighborRemove( nwkAddr, _NIB.nwkPanId );
   \   00006D                ; Setup parameters for call to function nwkNeighborRemove
   \   00006D   90....       MOV     DPTR,#_NIB + 33
   \   000070   E0           MOVX    A,@DPTR
   \   000071   FC           MOV     R4,A
   \   000072   A3           INC     DPTR
   \   000073   E0           MOVX    A,@DPTR
   \   000074   FD           MOV     R5,A
   \   000075   AA..         MOV     R2,?V0 + 0
   \   000077   AB..         MOV     R3,?V0 + 1
   \   000079   12....       LCALL   ??nwkNeighborRemove?relay
   1876          
   1877            // Schedule to save data to NV
   1878            ZDApp_NwkWriteNVRequest();
   1879          }
   \   00007C   7409         MOV     A,#0x9
   \   00007E   12....       LCALL   ?DEALLOC_XSTACK8
   \   000081   7F07         MOV     R7,#0x7
   \   000083   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine57_0:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F8           MOV     R0,A
   \   000002   A3           INC     DPTR
   \   000003                REQUIRE ??Subroutine58_0
   \   000003                ; // Fall through to label ??Subroutine58_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine58_0:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F583         MOV     DPH,A
   \   000003   8882         MOV     DPL,R0
   \   000005   22           RET
   1880          
   1881          /*********************************************************************
   1882           * @fn      ZDApp_NetworkDiscoveryReq
   1883           *
   1884           * @brief   Request a network discovery.
   1885           *
   1886           * @param  scanChannels -
   1887           * @param  scanDuration -
   1888           *
   1889           * @return  ZStatus_t
   1890           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1891          ZStatus_t ZDApp_NetworkDiscoveryReq( uint32 scanChannels, uint8 scanDuration)
   \                     ZDApp_NetworkDiscoveryReq:
   1892          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   1893            // Setup optional filters - tbd
   1894            //自己加的***************************************************************
   1895          /*      NLME_SetPollRate(1000);
   1896                NLME_SetQueuedPollRate(100);
   1897                NLME_SetResponseRate(100);            
   1898                powf=0;
   1899                pf=100;*/
   1900            // Request NLME network discovery
   1901            return NLME_NetworkDiscoveryRequest(scanChannels, scanDuration);
   \   000005                ; Setup parameters for call to function NLME_NetworkDiscoveryRequest
   \   000005   12....       LCALL   ??NLME_NetworkDiscoveryRequest?relay
   \   000008   02....       LJMP    ??Subroutine46_0 & 0xFFFF
   1902          }
   1903          
   1904          /*********************************************************************
   1905           * @fn      ZDApp_JoinReq
   1906           *
   1907           * @brief   Request the device to join a parent in a network.
   1908           *
   1909           * @param   channel -
   1910           * @param   panID -
   1911           *
   1912           * @return  ZStatus_t
   1913           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1914          ZStatus_t ZDApp_JoinReq( uint8 channel, uint16 panID, uint8 *extendedPanID,
   \                     ZDApp_JoinReq:
   1915                                   uint16 chosenParent, uint8 parentDepth, uint8 stackProfile )
   1916          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 4,R1
   \   000007   8A..         MOV     ?V0 + 0,R2
   \   000009   8B..         MOV     ?V0 + 1,R3
   \   00000B   EC           MOV     A,R4
   \   00000C   FE           MOV     R6,A
   \   00000D   ED           MOV     A,R5
   \   00000E   FF           MOV     R7,A
   \   00000F   740E         MOV     A,#0xe
   \   000011   12....       LCALL   ?XSTACK_DISP0_8
   \   000014   E0           MOVX    A,@DPTR
   \   000015   F5..         MOV     ?V0 + 2,A
   \   000017   A3           INC     DPTR
   \   000018   E0           MOVX    A,@DPTR
   \   000019   F5..         MOV     ?V0 + 3,A
   \   00001B   7410         MOV     A,#0x10
   \   00001D   12....       LCALL   ?XSTACK_DISP0_8
   \   000020   E0           MOVX    A,@DPTR
   \   000021   F5..         MOV     ?V0 + 5,A
   \   000023   7411         MOV     A,#0x11
   \   000025   12....       LCALL   ?XSTACK_DISP0_8
   \   000028   E0           MOVX    A,@DPTR
   \   000029   F9           MOV     R1,A
   1917            // Sync up the node with the stack profile (In the case where a pro device
   1918            // joins a non-pro network, or verse versa)
   1919            ZDApp_NodeProfileSync( stackProfile);
   \   00002A                ; Setup parameters for call to function ZDApp_NodeProfileSync
   \   00002A   12....       LCALL   ??ZDApp_NodeProfileSync?relay
   1920          
   1921            // Request NLME Join Request
   1922            return NLME_JoinRequest(extendedPanID, panID,channel,
   1923                                    ZDO_Config_Node_Descriptor.CapabilityFlags,
   1924                                    chosenParent, parentDepth);
   \   00002D                ; Setup parameters for call to function NLME_JoinRequest
   \   00002D   78..         MOV     R0,#?V0 + 5
   \   00002F   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000032   78..         MOV     R0,#?V0 + 2
   \   000034   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000037   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   00003A   E0           MOVX    A,@DPTR
   \   00003B   F5..         MOV     ?V0 + 2,A
   \   00003D   78..         MOV     R0,#?V0 + 2
   \   00003F   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000042   A9..         MOV     R1,?V0 + 4
   \   000044   AC..         MOV     R4,?V0 + 0
   \   000046   AD..         MOV     R5,?V0 + 1
   \   000048   EE           MOV     A,R6
   \   000049   FA           MOV     R2,A
   \   00004A   EF           MOV     A,R7
   \   00004B   FB           MOV     R3,A
   \   00004C   12....       LCALL   ??NLME_JoinRequest?relay
   \   00004F   7404         MOV     A,#0x4
   \   000051   12....       LCALL   ?DEALLOC_XSTACK8
   \   000054                REQUIRE ?Subroutine5
   \   000054                ; // Fall through to label ?Subroutine5
   1925          
   1926          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine5:
   \   000000   7F06         MOV     R7,#0x6
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA
   1927          
   1928          /*********************************************************************
   1929           * @fn      ZDApp_DeviceConfigured
   1930           *
   1931           * @brief   Check to see if the local device is configured (i.e., part
   1932           *          of a network).
   1933           *
   1934           * @param   none
   1935           *
   1936           * @return  TRUE if configured. FALSE, otherwise.
   1937           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1938          uint8 ZDApp_DeviceConfigured( void )
   \                     ZDApp_DeviceConfigured:
   1939          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1940            uint16 nwkAddr = INVALID_NODE_ADDR;
   \   00000A   85..82       MOV     DPL,?XSP + 0
   \   00000D   85..83       MOV     DPH,?XSP + 1
   \   000010   74FE         MOV     A,#-0x2
   \   000012   F0           MOVX    @DPTR,A
   \   000013   A3           INC     DPTR
   \   000014   04           INC     A
   \   000015   F0           MOVX    @DPTR,A
   1941          
   1942            osal_nv_read( ZCD_NV_NIB, osal_offsetof( nwkIB_t, nwkDevAddress ),
   1943                          sizeof( uint16), &nwkAddr );
   \   000016                ; Setup parameters for call to function osal_nv_read
   \   000016   85..82       MOV     DPL,?XSP + 0
   \   000019   85..83       MOV     DPH,?XSP + 1
   \   00001C   8582..       MOV     ?V0 + 0,DPL
   \   00001F   8583..       MOV     ?V0 + 1,DPH
   \   000022   78..         MOV     R0,#?V0 + 0
   \   000024   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000027   75..02       MOV     ?V0 + 0,#0x2
   \   00002A   75..00       MOV     ?V0 + 1,#0x0
   \   00002D   78..         MOV     R0,#?V0 + 0
   \   00002F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000032   7C14         MOV     R4,#0x14
   \   000034   7D00         MOV     R5,#0x0
   \   000036   7A21         MOV     R2,#0x21
   \   000038   12....       LCALL   ?Subroutine35 & 0xFFFF
   \                     ??CrossCallReturnLabel_47:
   \   00003B   12....       LCALL   ?DEALLOC_XSTACK8
   1944          
   1945            // Does the NIB have anything more than default?
   1946            return ( nwkAddr == INVALID_NODE_ADDR ? FALSE : TRUE );
   \   00003E   85..82       MOV     DPL,?XSP + 0
   \   000041   85..83       MOV     DPH,?XSP + 1
   \   000044   E0           MOVX    A,@DPTR
   \   000045   64FE         XRL     A,#0xfe
   \   000047   7003         JNZ     ??ZDApp_DeviceConfigured_0
   \   000049   A3           INC     DPTR
   \   00004A   E0           MOVX    A,@DPTR
   \   00004B   F4           CPL     A
   \                     ??ZDApp_DeviceConfigured_0:
   \   00004C   7004         JNZ     ??ZDApp_DeviceConfigured_1
   \   00004E   7900         MOV     R1,#0x0
   \   000050   8002         SJMP    ??ZDApp_DeviceConfigured_2
   \                     ??ZDApp_DeviceConfigured_1:
   \   000052   7901         MOV     R1,#0x1
   \                     ??ZDApp_DeviceConfigured_2:
   \   000054   02....       LJMP    ?Subroutine7 & 0xFFFF
   1947          }
   1948          
   1949          /*********************************************************************
   1950           * CALLBACK FUNCTIONS
   1951           */
   1952          
   1953          
   1954          /*********************************************************************
   1955           * @fn      ZDApp_SendEventMsg()
   1956           *
   1957           * @brief
   1958           *
   1959           *   Sends a Network Join message
   1960           *
   1961           * @param  cmd - command ID
   1962           * @param  len - length (in bytes) of the buf field
   1963           * @param  buf - buffer for the rest of the message.
   1964           *
   1965           * @return  none
   1966           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1967          void ZDApp_SendEventMsg( uint8 cmd, uint8 len, uint8 *buf )
   \                     ZDApp_SendEventMsg:
   1968          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   \   000007   EA           MOV     A,R2
   1969            ZDApp_SendMsg( ZDAppTaskID, cmd, len, buf );
   \   000008                ; Setup parameters for call to function ZDApp_SendMsg
   \   000008   FB           MOV     R3,A
   \   000009   EE           MOV     A,R6
   \   00000A   FA           MOV     R2,A
   \   00000B   12....       LCALL   ?Subroutine23 & 0xFFFF
   1970          }
   \                     ??CrossCallReturnLabel_24:
   \   00000E   02....       LJMP    ??Subroutine50_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine23:
   \   000000   90....       MOV     DPTR,#ZDAppTaskID
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F9           MOV     R1,A
   \   000005   12....       LCALL   ??ZDApp_SendMsg?relay
   \   000008   22           RET
   1971          
   1972          /*********************************************************************
   1973           * @fn      ZDApp_SendMsg()
   1974           *
   1975           * @brief   Sends a OSAL message
   1976           *
   1977           * @param  taskID - Where to send the message
   1978           * @param  cmd - command ID
   1979           * @param  len - length (in bytes) of the buf field
   1980           * @param  buf - buffer for the rest of the message.
   1981           *
   1982           * @return  none
   1983           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1984          void ZDApp_SendMsg( uint8 taskID, uint8 cmd, uint8 len, uint8 *buf )
   \                     ZDApp_SendMsg:
   1985          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 3,R1
   \   000007   8A..         MOV     ?V0 + 4,R2
   \   000009   8B..         MOV     ?V0 + 5,R3
   \   00000B   8C..         MOV     ?V0 + 0,R4
   \   00000D   8D..         MOV     ?V0 + 1,R5
   1986            osal_event_hdr_t *msgPtr;
   1987          
   1988            // Send the address to the task
   1989            msgPtr = (osal_event_hdr_t *)osal_msg_allocate( len );
   \   00000F                ; Setup parameters for call to function osal_msg_allocate
   \   00000F   8B..         MOV     ?V0 + 6,R3
   \   000011   AA..         MOV     R2,?V0 + 6
   \   000013   7B00         MOV     R3,#0x0
   \   000015   12....       LCALL   ??osal_msg_allocate?relay
   \   000018   8A..         MOV     ?V0 + 6,R2
   \   00001A   8B..         MOV     ?V0 + 7,R3
   \   00001C   AE..         MOV     R6,?V0 + 6
   \   00001E   AF..         MOV     R7,?V0 + 7
   1990            if ( msgPtr )
   \   000020   EE           MOV     A,R6
   \   000021   4F           ORL     A,R7
   \   000022   6031         JZ      ??ZDApp_SendMsg_0
   1991            {
   1992              if ( (len > 0) && (buf != NULL) )
   \   000024   E5..         MOV     A,?V0 + 5
   \   000026   601D         JZ      ??ZDApp_SendMsg_1
   \   000028   E5..         MOV     A,?V0 + 0
   \   00002A   45..         ORL     A,?V0 + 1
   \   00002C   6017         JZ      ??ZDApp_SendMsg_1
   1993                osal_memcpy( msgPtr, buf, len );
   \   00002E                ; Setup parameters for call to function osal_memcpy
   \   00002E   75..00       MOV     ?V0 + 2,#0x0
   \   000031   78..         MOV     R0,#?V0 + 0
   \   000033   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000036   85....       MOV     ?V0 + 0,?V0 + 5
   \   000039   AC..         MOV     R4,?V0 + 0
   \   00003B   7D00         MOV     R5,#0x0
   \   00003D   12....       LCALL   ??osal_memcpy?relay
   \   000040   7403         MOV     A,#0x3
   \   000042   12....       LCALL   ?DEALLOC_XSTACK8
   1994          
   1995              msgPtr->event = cmd;
   \                     ??ZDApp_SendMsg_1:
   \   000045   8E82         MOV     DPL,R6
   \   000047   8F83         MOV     DPH,R7
   \   000049   E5..         MOV     A,?V0 + 4
   \   00004B   F0           MOVX    @DPTR,A
   1996              osal_msg_send( taskID, (uint8 *)msgPtr );
   \   00004C                ; Setup parameters for call to function osal_msg_send
   \   00004C   EE           MOV     A,R6
   \   00004D   FA           MOV     R2,A
   \   00004E   EF           MOV     A,R7
   \   00004F   FB           MOV     R3,A
   \   000050   A9..         MOV     R1,?V0 + 3
   \   000052   12....       LCALL   ??osal_msg_send?relay
   1997            }
   1998          }
   \                     ??ZDApp_SendMsg_0:
   \   000055   7F08         MOV     R7,#0x8
   \   000057   02....       LJMP    ?BANKED_LEAVE_XDATA
   1999          
   2000          /*********************************************************************
   2001           * Call Back Functions from NWK  - API
   2002           */
   2003          
   2004          /*********************************************************************
   2005           * @fn          ZDO_NetworkDiscoveryConfirmCB
   2006           *
   2007           * @brief       This function returns a choice of PAN to join.
   2008           *
   2009           * @param       status - return status of the nwk discovery confirm
   2010           *
   2011           * @return      ZStatus_t
   2012           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2013          ZStatus_t ZDO_NetworkDiscoveryConfirmCB(uint8 status)
   \                     ZDO_NetworkDiscoveryConfirmCB:
   2014          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 3
   \   000004   74FD         MOV     A,#-0x3
   \   000006   12....       LCALL   ?ALLOC_XSTACK8
   \   000009   E9           MOV     A,R1
   \   00000A   85..82       MOV     DPL,?XSP + 0
   \   00000D   85..83       MOV     DPH,?XSP + 1
   \   000010   F0           MOVX    @DPTR,A
   2015            osal_event_hdr_t msg;
   2016          
   2017            // If Scan is initiated by ZDO_MGMT_NWK_DISC_REQ
   2018            // Send ZDO_MGMT_NWK_DISC_RSP back
   2019          #if defined ( ZDO_MGMT_NWKDISC_RESPONSE )
   2020            if ( zdappMgmtNwkDiscReqInProgress )
   2021            {
   2022              zdappMgmtNwkDiscReqInProgress = false;
   2023              ZDO_FinishProcessingMgmtNwkDiscReq();
   2024            }
   2025            else
   2026          #endif
   2027            {
   2028              // Pass the confirm to another task if it registers the callback
   2029              // Otherwise, pass the confirm to ZDApp.
   2030              if (zdoCBFunc[ZDO_NWK_DISCOVERY_CNF_CBID] != NULL )
   \   000011   90....       MOV     DPTR,#zdoCBFunc + 4
   \   000014   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_14:
   \   000017   6015         JZ      ??ZDO_NetworkDiscoveryConfirmCB_0
   2031              {
   2032                zdoCBFunc[ZDO_NWK_DISCOVERY_CNF_CBID]( (void*)&status );
   \   000019                ; Setup parameters for indirect call
   \   000019   85..82       MOV     DPL,?XSP + 0
   \   00001C   85..83       MOV     DPH,?XSP + 1
   \   00001F   AA82         MOV     R2,DPL
   \   000021   AB83         MOV     R3,DPH
   \   000023   90....       MOV     DPTR,#zdoCBFunc + 5
   \   000026   12....       LCALL   ??Subroutine58_0 & 0xFFFF
   2033              }
   \                     ??CrossCallReturnLabel_94:
   \   000029   12....       LCALL   ?CALL_IND
   \   00002C   8016         SJMP    ??CrossCallReturnLabel_25
   2034              else
   2035              {
   2036                // Otherwise, send scan confirm to ZDApp task to proceed
   2037                msg.status = ZDO_SUCCESS;
   \                     ??ZDO_NetworkDiscoveryConfirmCB_0:
   \   00002E   7402         MOV     A,#0x2
   \   000030   12....       LCALL   ?XSTACK_DISP0_8
   \   000033   E4           CLR     A
   \   000034   F0           MOVX    @DPTR,A
   2038                ZDApp_SendMsg( ZDAppTaskID, ZDO_NWK_DISC_CNF, sizeof(osal_event_hdr_t), (uint8 *)&msg );
   \   000035                ; Setup parameters for call to function ZDApp_SendMsg
   \   000035   04           INC     A
   \   000036   12....       LCALL   ?XSTACK_DISP0_8
   \   000039   AC82         MOV     R4,DPL
   \   00003B   AD83         MOV     R5,DPH
   \   00003D   7B02         MOV     R3,#0x2
   \   00003F   7A01         MOV     R2,#0x1
   \   000041   12....       LCALL   ?Subroutine23 & 0xFFFF
   2039              }
   2040            }
   2041            return (ZSuccess);
   \                     ??CrossCallReturnLabel_25:
   \   000044   7900         MOV     R1,#0x0
   \   000046   7403         MOV     A,#0x3
   \   000048   12....       LCALL   ?DEALLOC_XSTACK8
   \   00004B   02....       LJMP    ?Subroutine2 & 0xFFFF
   2042          }  // ZDO_NetworkDiscoveryConfirmCB
   2043          
   2044          /*********************************************************************
   2045           * @fn          ZDApp_NwkDescListProcessing
   2046           *
   2047           * @brief       This function process the network discovery result and select
   2048           *              a parent device to join itself.
   2049           *
   2050           * @param       none
   2051           *
   2052           * @return      ZStatus_t
   2053           */
   2054          #define STACK_PROFILE_MAX 2

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2055          networkDesc_t* ZDApp_NwkDescListProcessing(void)
   \                     ZDApp_NwkDescListProcessing:
   2056          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   2057            networkDesc_t *pNwkDesc;
   2058            uint8 i, ResultCount = 0;
   \   000005   75..00       MOV     ?V0 + 0,#0x0
   2059            uint8 stackProfile;
   2060            uint8 stackProfilePro;
   2061            uint8 selected;
   2062          
   2063            // Count the number of nwk descriptors in the list
   2064            pNwkDesc = nwk_getNwkDescList();
   \   000008                ; Setup parameters for call to function nwk_getNwkDescList
   \   000008   12....       LCALL   ??nwk_getNwkDescList?relay
   \   00000B   8A..         MOV     ?V0 + 2,R2
   \   00000D   8B..         MOV     ?V0 + 3,R3
   \   00000F   AE..         MOV     R6,?V0 + 2
   \   000011   AF..         MOV     R7,?V0 + 3
   \   000013   8005         SJMP    ??CrossCallReturnLabel_91
   2065            while (pNwkDesc)
   2066            {
   2067              ResultCount++;
   \                     ??ZDApp_NwkDescListProcessing_0:
   \   000015   05..         INC     ?V0 + 0
   2068              pNwkDesc = pNwkDesc->nextDesc;
   \   000017   12....       LCALL   ?Subroutine21 & 0xFFFF
   2069            }
   \                     ??CrossCallReturnLabel_91:
   \   00001A   EE           MOV     A,R6
   \   00001B   4F           ORL     A,R7
   \   00001C   70F7         JNZ     ??ZDApp_NwkDescListProcessing_0
   2070          
   2071            // process discovery results
   2072            stackProfilePro = FALSE;
   \   00001E   75..00       MOV     ?V0 + 3,#0x0
   2073            selected = FALSE;
   2074          
   2075          
   2076            for ( stackProfile = 0; stackProfile < STACK_PROFILE_MAX; stackProfile++ )
   \   000021   75..00       MOV     ?V0 + 1,#0x0
   2077            {
   2078              pNwkDesc = nwk_getNwkDescList();
   \                     ??ZDApp_NwkDescListProcessing_1:
   \   000024                ; Setup parameters for call to function nwk_getNwkDescList
   \   000024   12....       LCALL   ??nwk_getNwkDescList?relay
   \   000027   8A..         MOV     ?V0 + 4,R2
   \   000029   8B..         MOV     ?V0 + 5,R3
   \   00002B   AE..         MOV     R6,?V0 + 4
   \   00002D   AF..         MOV     R7,?V0 + 5
   2079              for ( i = 0; i < ResultCount; i++, pNwkDesc = pNwkDesc->nextDesc )
   \   00002F   75..00       MOV     ?V0 + 2,#0x0
   \   000032   8023         SJMP    ??CrossCallReturnLabel_92
   2080              {
   2081                if ( zgConfigPANID != 0xFFFF )
   2082                {
   2083                  // PAN Id is preconfigured. check if it matches
   2084                  if ( pNwkDesc->panId != zgConfigPANID )
   2085                    continue;
   2086                }
   2087          
   2088                if ( nwk_ExtPANIDValid( ZDO_UseExtendedPANID) == true )
   2089                {
   2090                  // If the extended Pan ID is commissioned to a non zero value
   2091                  // Only join the Pan that has match EPID
   2092                  if ( osal_ExtAddrEqual( ZDO_UseExtendedPANID, pNwkDesc->extendedPANID) == false )
   2093                    continue;
   2094          
   2095                }
   2096          
   2097                // check that network is allowing joining
   2098                if ( ZSTACK_ROUTER_BUILD )
   2099                {
   2100                  if ( stackProfilePro == FALSE )
   2101                  {
   2102                    if ( !pNwkDesc->routerCapacity )
   2103                    {
   2104                      continue;
   2105                    }
   2106                  }
   2107                  else
   2108                  {
   2109                    if ( !pNwkDesc->deviceCapacity )
   2110                    {
   2111                      continue;
   2112                    }
   2113                  }
   2114                }
   2115                else if ( ZSTACK_END_DEVICE_BUILD )
   2116                {
   2117                  if ( !pNwkDesc->deviceCapacity )
   2118                  {
   2119                    continue;
   2120                  }
   2121                }
   2122          
   2123                // check version of zigbee protocol
   2124                if ( pNwkDesc->version != _NIB.nwkProtocolVersion )
   2125                  continue;
   2126          
   2127                // check version of stack profile
   2128                if ( pNwkDesc->stackProfile != zgStackProfile  )
   2129                {
   2130                  if ( ((zgStackProfile == HOME_CONTROLS) && (pNwkDesc->stackProfile == ZIGBEEPRO_PROFILE))
   2131                      || ((zgStackProfile == ZIGBEEPRO_PROFILE) && (pNwkDesc->stackProfile == HOME_CONTROLS))  )
   \                     ??ZDApp_NwkDescListProcessing_2:
   \   000034   E0           MOVX    A,@DPTR
   \   000035   6402         XRL     A,#0x2
   \   000037   7012         JNZ     ??ZDApp_NwkDescListProcessing_3
   \   000039   8E82         MOV     DPL,R6
   \   00003B   8F83         MOV     DPH,R7
   \   00003D   A3           INC     DPTR
   \   00003E   A3           INC     DPTR
   \   00003F   A3           INC     DPTR
   \   000040   A3           INC     DPTR
   \   000041   A3           INC     DPTR
   \   000042   A3           INC     DPTR
   \   000043   E0           MOVX    A,@DPTR
   \   000044   6401         XRL     A,#0x1
   \   000046   7003         JNZ     ??ZDApp_NwkDescListProcessing_3
   2132                  {
   2133                    stackProfilePro = TRUE;
   \                     ??ZDApp_NwkDescListProcessing_4:
   \   000048   75..01       MOV     ?V0 + 3,#0x1
   2134                  }
   2135          
   2136                  if ( stackProfile == 0 )
   \                     ??ZDApp_NwkDescListProcessing_3:
   \   00004B   E5..         MOV     A,?V0 + 1
   \   00004D   6003         JZ      $+5
   \   00004F   02....       LJMP    ??ZDApp_NwkDescListProcessing_5 & 0xFFFF
   \                     ??ZDApp_NwkDescListProcessing_6:
   \   000052   05..         INC     ?V0 + 2
   \   000054   12....       LCALL   ?Subroutine21 & 0xFFFF
   \                     ??CrossCallReturnLabel_92:
   \   000057   E5..         MOV     A,?V0 + 2
   \   000059   C3           CLR     C
   \   00005A   95..         SUBB    A,?V0 + 0
   \   00005C   4003         JC      $+5
   \   00005E   02....       LJMP    ??ZDApp_NwkDescListProcessing_7 & 0xFFFF
   \   000061   90....       MOV     DPTR,#zgConfigPANID
   \   000064   E0           MOVX    A,@DPTR
   \   000065   F4           CPL     A
   \   000066   7003         JNZ     ??ZDApp_NwkDescListProcessing_8
   \   000068   A3           INC     DPTR
   \   000069   E0           MOVX    A,@DPTR
   \   00006A   F4           CPL     A
   \                     ??ZDApp_NwkDescListProcessing_8:
   \   00006B   600F         JZ      ??ZDApp_NwkDescListProcessing_9
   \   00006D   12....       LCALL   ?Subroutine19 & 0xFFFF
   \                     ??CrossCallReturnLabel_76:
   \   000070   90....       MOV     DPTR,#zgConfigPANID
   \   000073   E0           MOVX    A,@DPTR
   \   000074   68           XRL     A,R0
   \   000075   7003         JNZ     ??ZDApp_NwkDescListProcessing_10
   \   000077   A3           INC     DPTR
   \   000078   E0           MOVX    A,@DPTR
   \   000079   69           XRL     A,R1
   \                     ??ZDApp_NwkDescListProcessing_10:
   \   00007A   70D6         JNZ     ??ZDApp_NwkDescListProcessing_6
   \                     ??ZDApp_NwkDescListProcessing_9:
   \   00007C                ; Setup parameters for call to function nwk_ExtPANIDValid
   \   00007C   7A..         MOV     R2,#ZDO_UseExtendedPANID & 0xff
   \   00007E   7B..         MOV     R3,#(ZDO_UseExtendedPANID >> 8) & 0xff
   \   000080   12....       LCALL   ??nwk_ExtPANIDValid?relay
   \   000083   E9           MOV     A,R1
   \   000084   6401         XRL     A,#0x1
   \   000086   7012         JNZ     ??ZDApp_NwkDescListProcessing_11
   \   000088                ; Setup parameters for call to function sAddrExtCmp
   \   000088   EE           MOV     A,R6
   \   000089   240B         ADD     A,#0xb
   \   00008B   FC           MOV     R4,A
   \   00008C   EF           MOV     A,R7
   \   00008D   3400         ADDC    A,#0x0
   \   00008F   FD           MOV     R5,A
   \   000090   7A..         MOV     R2,#ZDO_UseExtendedPANID & 0xff
   \   000092   7B..         MOV     R3,#(ZDO_UseExtendedPANID >> 8) & 0xff
   \   000094   12....       LCALL   ??sAddrExtCmp?relay
   \   000097   E9           MOV     A,R1
   \   000098   60B8         JZ      ??ZDApp_NwkDescListProcessing_6
   \                     ??ZDApp_NwkDescListProcessing_11:
   \   00009A   8E82         MOV     DPL,R6
   \   00009C   8F83         MOV     DPH,R7
   \   00009E   A3           INC     DPTR
   \   00009F   A3           INC     DPTR
   \   0000A0   A3           INC     DPTR
   \   0000A1   A3           INC     DPTR
   \   0000A2   E0           MOVX    A,@DPTR
   \   0000A3   60AD         JZ      ??ZDApp_NwkDescListProcessing_6
   \   0000A5   8E82         MOV     DPL,R6
   \   0000A7   8F83         MOV     DPH,R7
   \   0000A9   A3           INC     DPTR
   \   0000AA   A3           INC     DPTR
   \   0000AB   A3           INC     DPTR
   \   0000AC   A3           INC     DPTR
   \   0000AD   A3           INC     DPTR
   \   0000AE   E0           MOVX    A,@DPTR
   \   0000AF   F8           MOV     R0,A
   \   0000B0   90....       MOV     DPTR,#_NIB + 17
   \   0000B3   E0           MOVX    A,@DPTR
   \   0000B4   68           XRL     A,R0
   \   0000B5   709B         JNZ     ??ZDApp_NwkDescListProcessing_6
   \   0000B7   8E82         MOV     DPL,R6
   \   0000B9   8F83         MOV     DPH,R7
   \   0000BB   A3           INC     DPTR
   \   0000BC   A3           INC     DPTR
   \   0000BD   A3           INC     DPTR
   \   0000BE   A3           INC     DPTR
   \   0000BF   A3           INC     DPTR
   \   0000C0   A3           INC     DPTR
   \   0000C1   E0           MOVX    A,@DPTR
   \   0000C2   F8           MOV     R0,A
   \   0000C3   90....       MOV     DPTR,#zgStackProfile
   \   0000C6   E0           MOVX    A,@DPTR
   \   0000C7   68           XRL     A,R0
   \   0000C8   6039         JZ      ??ZDApp_NwkDescListProcessing_5
   \   0000CA   E0           MOVX    A,@DPTR
   \   0000CB   6401         XRL     A,#0x1
   \   0000CD   6003         JZ      $+5
   \   0000CF   02....       LJMP    ??ZDApp_NwkDescListProcessing_2 & 0xFFFF
   \   0000D2   8E82         MOV     DPL,R6
   \   0000D4   8F83         MOV     DPH,R7
   \   0000D6   A3           INC     DPTR
   \   0000D7   A3           INC     DPTR
   \   0000D8   A3           INC     DPTR
   \   0000D9   A3           INC     DPTR
   \   0000DA   A3           INC     DPTR
   \   0000DB   A3           INC     DPTR
   \   0000DC   E0           MOVX    A,@DPTR
   \   0000DD   6402         XRL     A,#0x2
   \   0000DF   6003         JZ      $+5
   \   0000E1   02....       LJMP    ??ZDApp_NwkDescListProcessing_3 & 0xFFFF
   \   0000E4   02....       LJMP    ??ZDApp_NwkDescListProcessing_4 & 0xFFFF
   2137                  {
   2138                    continue;
   2139                  }
   2140                }
   2141          
   2142                break;
   2143              }
   2144          
   2145              if (i < ResultCount)
   2146              {
   2147               selected = TRUE;
   2148                break;
   2149              }
   2150          
   2151              // break if selected or stack profile pro wasn't found
   2152              if ( (selected == TRUE) || (stackProfilePro == FALSE) )
   \                     ??ZDApp_NwkDescListProcessing_7:
   \   0000E7   E5..         MOV     A,?V0 + 3
   \   0000E9   600C         JZ      ??ZDApp_NwkDescListProcessing_12
   2153              {
   2154                break;
   2155              }
   2156            }
   \   0000EB   05..         INC     ?V0 + 1
   \   0000ED   E5..         MOV     A,?V0 + 1
   \   0000EF   C3           CLR     C
   \   0000F0   9402         SUBB    A,#0x2
   \   0000F2   5003         JNC     $+5
   \   0000F4   02....       LJMP    ??ZDApp_NwkDescListProcessing_1 & 0xFFFF
   2157          
   2158            if ( i == ResultCount )
   \                     ??ZDApp_NwkDescListProcessing_12:
   \   0000F7   E5..         MOV     A,?V0 + 0
   \   0000F9   65..         XRL     A,?V0 + 2
   \   0000FB   7006         JNZ     ??ZDApp_NwkDescListProcessing_5
   2159            {
   2160              return (NULL);   // couldn't find appropriate PAN to join !
   \   0000FD   7A00         MOV     R2,#0x0
   \   0000FF   7B00         MOV     R3,#0x0
   \   000101   8004         SJMP    ??ZDApp_NwkDescListProcessing_13
   2161            }
   2162            else
   2163            {
   2164              return (pNwkDesc);
   \                     ??ZDApp_NwkDescListProcessing_5:
   \   000103   EE           MOV     A,R6
   \   000104   FA           MOV     R2,A
   \   000105   EF           MOV     A,R7
   \   000106   FB           MOV     R3,A
   2165            }
   \                     ??ZDApp_NwkDescListProcessing_13:
   \   000107   02....       LJMP    ?Subroutine5 & 0xFFFF
   2166          }// ZDApp_NwkDescListProcessing()

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine21:
   \   000000   EE           MOV     A,R6
   \   000001   2414         ADD     A,#0x14
   \   000003   12....       LCALL   ??Subroutine54_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_117:
   \   000006                REQUIRE ??Subroutine53_0
   \   000006                ; // Fall through to label ??Subroutine53_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine53_0:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   FE           MOV     R6,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   FF           MOV     R7,A
   \   000005   22           RET
   2167          
   2168          /*********************************************************************
   2169           * @fn          ZDO_NetworkFormationConfirmCB
   2170           *
   2171           * @brief       This function reports the results of the request to
   2172           *              initialize a coordinator in a network.
   2173           *
   2174           * @param       Status - Result of NLME_NetworkFormationRequest()
   2175           *
   2176           * @return      none
   2177           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   12....       LCALL   ??Subroutine42_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_66:
   \   000003                REQUIRE ??Subroutine50_0
   \   000003                ; // Fall through to label ??Subroutine50_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2178          void ZDO_NetworkFormationConfirmCB( ZStatus_t Status )
   \                     ZDO_NetworkFormationConfirmCB:
   2179          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   2180            nwkStatus = (byte)Status;
   \   000006   90....       MOV     DPTR,#nwkStatus
   \   000009   F0           MOVX    @DPTR,A
   2181          
   2182            if ( Status == ZSUCCESS )
   \   00000A   700A         JNZ     ??ZDO_NetworkFormationConfirmCB_0
   2183            {
   2184              // LED on shows Coordinator started
   2185              HalLedSet ( HAL_LED_3, HAL_LED_MODE_ON );
   \   00000C                ; Setup parameters for call to function HalLedSet
   \   00000C   12....       LCALL   ?Subroutine37 & 0xFFFF
   2186          
   2187              // LED off forgets HOLD_AUTO_START
   2188              HalLedSet (HAL_LED_4, HAL_LED_MODE_OFF);
   2189          
   2190          #if defined ( ZBIT )
   2191              SIM_SetColor(0xd0ffd0);
   2192          #endif
   2193          
   2194              if ( devState == DEV_HOLD )
   \                     ??CrossCallReturnLabel_51:
   \   00000F   700C         JNZ     ??ZDO_NetworkFormationConfirmCB_1
   2195              {
   2196                // Began with HOLD_AUTO_START
   2197                devState = DEV_COORD_STARTING;
   \   000011   7408         MOV     A,#0x8
   \   000013   F0           MOVX    @DPTR,A
   \   000014   8007         SJMP    ??ZDO_NetworkFormationConfirmCB_1
   2198              }
   2199            }
   2200          #if defined(BLINK_LEDS)
   2201            else
   2202            {
   2203              HalLedSet ( HAL_LED_3, HAL_LED_MODE_FLASH );  // Flash LED to show failure
   \                     ??ZDO_NetworkFormationConfirmCB_0:
   \   000016                ; Setup parameters for call to function HalLedSet
   \   000016   7A04         MOV     R2,#0x4
   \   000018   7904         MOV     R1,#0x4
   \   00001A   12....       LCALL   ??HalLedSet?relay
   2204            }
   2205          #endif
   2206          
   2207            osal_set_event( ZDAppTaskID, ZDO_NETWORK_START );
   \                     ??ZDO_NetworkFormationConfirmCB_1:
   \   00001D                ; Setup parameters for call to function osal_set_event
   \   00001D   7A02         MOV     R2,#0x2
   \   00001F   02....       LJMP    ?Subroutine0 & 0xFFFF
   2208          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine37:
   \   000000   7A01         MOV     R2,#0x1
   \   000002   7904         MOV     R1,#0x4
   \   000004   12....       LCALL   ??HalLedSet?relay
   \   000007                ; Setup parameters for call to function HalLedSet
   \   000007                ; Setup parameters for call to function HalLedSet
   \   000007                ; Setup parameters for call to function HalLedSet
   \   000007   7A00         MOV     R2,#0x0
   \   000009   7908         MOV     R1,#0x8
   \   00000B   12....       LCALL   ??HalLedSet?relay
   \   00000E   90....       MOV     DPTR,#devState
   \   000011   E0           MOVX    A,@DPTR
   \   000012   22           RET
   2209          
   2210          /****************************************************************************
   2211           * @fn          ZDApp_beaconIndProcessing
   2212           *
   2213           * @brief       This function processes the incoming beacon indication.
   2214           *
   2215           *              When another task (MT or App) is registered to process
   2216           *              beacon indication themselves, this function will parse the
   2217           *              beacon payload and pass the beacon descriptor to that task
   2218           *              If no other tasks registered, this function will process
   2219           *              the beacon payload and generate the network descriptor link
   2220           *              list.
   2221           *
   2222           * @param
   2223           *
   2224           * @return      none
   2225           *
   2226           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2227          void ZDO_beaconNotifyIndCB( NLME_beaconInd_t *pBeacon )
   \                     ZDO_beaconNotifyIndCB:
   2228          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 0,R2
   \   000007   8B..         MOV     ?V0 + 1,R3
   2229            // Pass the beacon Indication to another task if it registers the callback
   2230            // Otherwise, process the beacon notification here.
   2231            if (zdoCBFunc[ZDO_BEACON_NOTIFY_IND_CBID] != NULL )
   \   000009   90....       MOV     DPTR,#zdoCBFunc + 6
   \   00000C   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_15:
   \   00000F   6009         JZ      ??ZDO_beaconNotifyIndCB_0
   2232            {
   2233              zdoCBFunc[ZDO_BEACON_NOTIFY_IND_CBID]( (void*)pBeacon );
   \   000011                ; Setup parameters for indirect call
   \   000011   12....       LCALL   ??Subroutine58_0 & 0xFFFF
   2234            }
   \                     ??CrossCallReturnLabel_95:
   \   000014   12....       LCALL   ?CALL_IND
   \   000017   02....       LJMP    ??ZDO_beaconNotifyIndCB_1 & 0xFFFF
   2235            else
   2236            {
   2237              networkDesc_t *pNwkDesc;
   2238              networkDesc_t *pLastNwkDesc;
   2239              uint8 found = false;
   2240          
   2241              // Add the network to the Network Descriptor List
   2242              pNwkDesc = NwkDescList;
   \                     ??ZDO_beaconNotifyIndCB_0:
   \   00001A   90....       MOV     DPTR,#NwkDescList
   \   00001D   12....       LCALL   ??Subroutine53_0 & 0xFFFF
   2243              pLastNwkDesc = NwkDescList;
   \                     ??CrossCallReturnLabel_89:
   \   000020   90....       MOV     DPTR,#NwkDescList
   \   000023   E0           MOVX    A,@DPTR
   \   000024   F5..         MOV     ?V0 + 2,A
   \   000026   A3           INC     DPTR
   \   000027   E0           MOVX    A,@DPTR
   \   000028   F5..         MOV     ?V0 + 3,A
   \   00002A   802D         SJMP    ??CrossCallReturnLabel_93
   2244              while (pNwkDesc)
   2245              {
   2246                if ((pNwkDesc->panId == pBeacon->panID) &&
   2247                    (pNwkDesc->logicalChannel == pBeacon->logicalChannel))
   \                     ??ZDO_beaconNotifyIndCB_2:
   \   00002C   12....       LCALL   ?Subroutine19 & 0xFFFF
   \                     ??CrossCallReturnLabel_77:
   \   00002F   8A82         MOV     DPL,R2
   \   000031   8B83         MOV     DPH,R3
   \   000033   A3           INC     DPTR
   \   000034   A3           INC     DPTR
   \   000035   E0           MOVX    A,@DPTR
   \   000036   68           XRL     A,R0
   \   000037   7003         JNZ     ??ZDO_beaconNotifyIndCB_3
   \   000039   A3           INC     DPTR
   \   00003A   E0           MOVX    A,@DPTR
   \   00003B   69           XRL     A,R1
   \                     ??ZDO_beaconNotifyIndCB_3:
   \   00003C   7014         JNZ     ??ZDO_beaconNotifyIndCB_4
   \   00003E   8E82         MOV     DPL,R6
   \   000040   8F83         MOV     DPH,R7
   \   000042   A3           INC     DPTR
   \   000043   A3           INC     DPTR
   \   000044   E0           MOVX    A,@DPTR
   \   000045   F8           MOV     R0,A
   \   000046   8A82         MOV     DPL,R2
   \   000048   8B83         MOV     DPH,R3
   \   00004A   A3           INC     DPTR
   \   00004B   A3           INC     DPTR
   \   00004C   A3           INC     DPTR
   \   00004D   A3           INC     DPTR
   \   00004E   E0           MOVX    A,@DPTR
   \   00004F   68           XRL     A,R0
   \   000050   605F         JZ      ??ZDO_beaconNotifyIndCB_5
   2248                {
   2249                  found = true;
   2250                  break;
   2251                }
   2252                pLastNwkDesc = pNwkDesc;
   \                     ??ZDO_beaconNotifyIndCB_4:
   \   000052   8E..         MOV     ?V0 + 2,R6
   \   000054   8F..         MOV     ?V0 + 3,R7
   2253                pNwkDesc = pNwkDesc->nextDesc;
   \   000056   12....       LCALL   ?Subroutine21 & 0xFFFF
   2254              }
   \                     ??CrossCallReturnLabel_93:
   \   000059   EE           MOV     A,R6
   \   00005A   4F           ORL     A,R7
   \   00005B   70CF         JNZ     ??ZDO_beaconNotifyIndCB_2
   2255          
   2256              // If no existing descriptor found, make a new one and add to the list
   2257              if (found == false)
   2258              {
   2259                pNwkDesc = osal_mem_alloc( sizeof(networkDesc_t)  );
   \   00005D                ; Setup parameters for call to function osal_mem_alloc
   \   00005D   7A16         MOV     R2,#0x16
   \   00005F   7B00         MOV     R3,#0x0
   \   000061   12....       LCALL   ??osal_mem_alloc?relay
   \   000064   8A..         MOV     ?V0 + 4,R2
   \   000066   8B..         MOV     ?V0 + 5,R3
   \   000068   AE..         MOV     R6,?V0 + 4
   \   00006A   AF..         MOV     R7,?V0 + 5
   2260                if ( !pNwkDesc )
   \   00006C   EE           MOV     A,R6
   \   00006D   4F           ORL     A,R7
   \   00006E   7003         JNZ     $+5
   \   000070   02....       LJMP    ??ZDO_beaconNotifyIndCB_1 & 0xFFFF
   2261                {
   2262                  // Memory alloc failed, discard this beacon
   2263                  return;
   2264                }
   2265          
   2266                // Clear the network descriptor
   2267                osal_memset( pNwkDesc, 0, sizeof(networkDesc_t)  );
   \   000073                ; Setup parameters for call to function osal_memset
   \   000073   7C16         MOV     R4,#0x16
   \   000075   7D00         MOV     R5,#0x0
   \   000077   7900         MOV     R1,#0x0
   \   000079   12....       LCALL   ??osal_memset?relay
   2268          
   2269                // Initialize the descriptor
   2270                pNwkDesc->chosenRouter = INVALID_NODE_ADDR;
   \   00007C   8E82         MOV     DPL,R6
   \   00007E   8F83         MOV     DPH,R7
   \   000080   A3           INC     DPTR
   \   000081   A3           INC     DPTR
   \   000082   A3           INC     DPTR
   \   000083   A3           INC     DPTR
   \   000084   A3           INC     DPTR
   \   000085   A3           INC     DPTR
   \   000086   A3           INC     DPTR
   \   000087   74FE         MOV     A,#-0x2
   \   000089   F0           MOVX    @DPTR,A
   \   00008A   A3           INC     DPTR
   \   00008B   04           INC     A
   \   00008C   12....       LCALL   ?Subroutine12 & 0xFFFF
   2271                pNwkDesc->chosenRouterDepth = 0xFF;
   \                     ??CrossCallReturnLabel_7:
   \   00008F   A3           INC     DPTR
   \   000090   A3           INC     DPTR
   \   000091   A3           INC     DPTR
   \   000092   A3           INC     DPTR
   \   000093   F0           MOVX    @DPTR,A
   2272          
   2273                // Save new entry into the descriptor list
   2274                if ( !NwkDescList )
   \   000094   90....       MOV     DPTR,#NwkDescList
   \   000097   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_16:
   \   00009A   7005         JNZ     ??ZDO_beaconNotifyIndCB_6
   2275                {
   2276                  NwkDescList = pNwkDesc;
   \   00009C   90....       MOV     DPTR,#NwkDescList
   \   00009F   800B         SJMP    ??CrossCallReturnLabel_114
   2277                }
   2278                else
   2279                {
   2280                  pLastNwkDesc->nextDesc = pNwkDesc;
   \                     ??ZDO_beaconNotifyIndCB_6:
   \   0000A1   E5..         MOV     A,?V0 + 2
   \   0000A3   2414         ADD     A,#0x14
   \   0000A5   F582         MOV     DPL,A
   \   0000A7   E5..         MOV     A,?V0 + 3
   \   0000A9   12....       LCALL   ??Subroutine55_0 & 0xFFFF
   2281                }
   2282              }
   \                     ??CrossCallReturnLabel_114:
   \   0000AC   EE           MOV     A,R6
   \   0000AD   F0           MOVX    @DPTR,A
   \   0000AE   A3           INC     DPTR
   \   0000AF   EF           MOV     A,R7
   \   0000B0   F0           MOVX    @DPTR,A
   2283          
   2284              // Update the descriptor with the incoming beacon
   2285              pNwkDesc->stackProfile   = pBeacon->stackProfile;
   \                     ??ZDO_beaconNotifyIndCB_5:
   \   0000B1   85..82       MOV     DPL,?V0 + 0
   \   0000B4   85..83       MOV     DPH,?V0 + 1
   \   0000B7   A3           INC     DPTR
   \   0000B8   A3           INC     DPTR
   \   0000B9   A3           INC     DPTR
   \   0000BA   A3           INC     DPTR
   \   0000BB   A3           INC     DPTR
   \   0000BC   A3           INC     DPTR
   \   0000BD   A3           INC     DPTR
   \   0000BE   A3           INC     DPTR
   \   0000BF   A3           INC     DPTR
   \   0000C0   12....       LCALL   ?Subroutine26 & 0xFFFF
   \                     ??CrossCallReturnLabel_32:
   \   0000C3   A3           INC     DPTR
   \   0000C4   A3           INC     DPTR
   \   0000C5   A3           INC     DPTR
   \   0000C6   F0           MOVX    @DPTR,A
   2286              pNwkDesc->version        = pBeacon->protocolVersion;
   \   0000C7   E5..         MOV     A,?V0 + 0
   \   0000C9   2408         ADD     A,#0x8
   \   0000CB   F8           MOV     R0,A
   \   0000CC   E5..         MOV     A,?V0 + 1
   \   0000CE   3400         ADDC    A,#0x0
   \   0000D0   F9           MOV     R1,A
   \   0000D1   8882         MOV     DPL,R0
   \   0000D3   8983         MOV     DPH,R1
   \   0000D5   12....       LCALL   ?Subroutine26 & 0xFFFF
   \                     ??CrossCallReturnLabel_33:
   \   0000D8   12....       LCALL   ?Subroutine15 & 0xFFFF
   2287              pNwkDesc->logicalChannel = pBeacon->logicalChannel;
   \                     ??CrossCallReturnLabel_10:
   \   0000DB   A3           INC     DPTR
   \   0000DC   A3           INC     DPTR
   \   0000DD   E0           MOVX    A,@DPTR
   \   0000DE   8E82         MOV     DPL,R6
   \   0000E0   8F83         MOV     DPH,R7
   \   0000E2   12....       LCALL   ?Subroutine15 & 0xFFFF
   2288              pNwkDesc->panId          = pBeacon->panID;
   \                     ??CrossCallReturnLabel_11:
   \   0000E5   12....       LCALL   ?Subroutine24 & 0xFFFF
   \                     ??CrossCallReturnLabel_30:
   \   0000E8   8E82         MOV     DPL,R6
   \   0000EA   8F83         MOV     DPH,R7
   \   0000EC   12....       LCALL   ??Subroutine61_0 & 0xFFFF
   2289              pNwkDesc->updateId       = pBeacon->updateID;
   \                     ??CrossCallReturnLabel_125:
   \   0000EF   E5..         MOV     A,?V0 + 0
   \   0000F1   240C         ADD     A,#0xc
   \   0000F3   F582         MOV     DPL,A
   \   0000F5   E5..         MOV     A,?V0 + 1
   \   0000F7   12....       LCALL   ??Subroutine60_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_105:
   \   0000FA   C0E0         PUSH    A
   \   0000FC   EE           MOV     A,R6
   \   0000FD   2413         ADD     A,#0x13
   \   0000FF   12....       LCALL   ??Subroutine54_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_116:
   \   000102   D0E0         POP     A
   \   000104   F0           MOVX    @DPTR,A
   2290          
   2291              // Save the extended PAN ID from the beacon payload only if 1.1 version network
   2292              if ( pBeacon->protocolVersion != ZB_PROT_V1_0 )
   \   000105   8882         MOV     DPL,R0
   \   000107   8983         MOV     DPH,R1
   \   000109   E0           MOVX    A,@DPTR
   \   00010A   6401         XRL     A,#0x1
   \   00010C   6011         JZ      ??ZDO_beaconNotifyIndCB_7
   2293              {
   2294                osal_cpyExtAddr( pNwkDesc->extendedPANID, pBeacon->extendedPanID );
   \   00010E                ; Setup parameters for call to function sAddrExtCpy
   \   00010E   E5..         MOV     A,?V0 + 0
   \   000110   240D         ADD     A,#0xd
   \   000112   FC           MOV     R4,A
   \   000113   E5..         MOV     A,?V0 + 1
   \   000115   3400         ADDC    A,#0x0
   \   000117   12....       LCALL   ?Subroutine34 & 0xFFFF
   2295              }
   \                     ??CrossCallReturnLabel_70:
   \   00011A   12....       LCALL   ??sAddrExtCpy?relay
   \   00011D   800C         SJMP    ??ZDO_beaconNotifyIndCB_8
   2296              else
   2297              {
   2298                osal_memset( pNwkDesc->extendedPANID, 0xFF, Z_EXTADDR_LEN );
   \                     ??ZDO_beaconNotifyIndCB_7:
   \   00011F                ; Setup parameters for call to function osal_memset
   \   00011F   7C08         MOV     R4,#0x8
   \   000121   7D00         MOV     R5,#0x0
   \   000123   79FF         MOV     R1,#-0x1
   \   000125   12....       LCALL   ??Subroutine43_0 & 0xFFFF
   2299              }
   \                     ??CrossCallReturnLabel_68:
   \   000128   12....       LCALL   ??osal_memset?relay
   2300          
   2301              // check if this device is a better choice to join...
   2302              // ...dont bother checking assocPermit flag is doing a rejoin
   2303              if ( ( pBeacon->LQI > gMIN_TREE_LINK_COST ) &&
   2304                  ( ( pBeacon->permitJoining == TRUE ) || ( _tmpRejoinState ) ) )
   \                     ??ZDO_beaconNotifyIndCB_8:
   \   00012B   85..82       MOV     DPL,?V0 + 0
   \   00012E   85..83       MOV     DPH,?V0 + 1
   \   000131   A3           INC     DPTR
   \   000132   A3           INC     DPTR
   \   000133   A3           INC     DPTR
   \   000134   A3           INC     DPTR
   \   000135   A3           INC     DPTR
   \   000136   A3           INC     DPTR
   \   000137   A3           INC     DPTR
   \   000138   A3           INC     DPTR
   \   000139   A3           INC     DPTR
   \   00013A   A3           INC     DPTR
   \   00013B   E0           MOVX    A,@DPTR
   \   00013C   F8           MOV     R0,A
   \   00013D   90....       MOV     DPTR,#gMIN_TREE_LINK_COST
   \   000140   E0           MOVX    A,@DPTR
   \   000141   C3           CLR     C
   \   000142   98           SUBB    A,R0
   \   000143   4003         JC      $+5
   \   000145   02....       LJMP    ??ZDO_beaconNotifyIndCB_1 & 0xFFFF
   \   000148   85..82       MOV     DPL,?V0 + 0
   \   00014B   85..83       MOV     DPH,?V0 + 1
   \   00014E   A3           INC     DPTR
   \   00014F   A3           INC     DPTR
   \   000150   A3           INC     DPTR
   \   000151   A3           INC     DPTR
   \   000152   A3           INC     DPTR
   \   000153   E0           MOVX    A,@DPTR
   \   000154   6401         XRL     A,#0x1
   \   000156   6009         JZ      ??ZDO_beaconNotifyIndCB_9
   \   000158   90....       MOV     DPTR,#_tmpRejoinState
   \   00015B   E0           MOVX    A,@DPTR
   \   00015C   7003         JNZ     $+5
   \   00015E   02....       LJMP    ??ZDO_beaconNotifyIndCB_1 & 0xFFFF
   2305              {
   2306                uint8 selected = FALSE;
   \                     ??ZDO_beaconNotifyIndCB_9:
   \   000161   7900         MOV     R1,#0x0
   2307                uint8 capacity = FALSE;
   2308          
   2309                if ( _NIB.nwkAddrAlloc == NWK_ADDRESSING_STOCHASTIC )
   \   000163   90....       MOV     DPTR,#_NIB + 96
   \   000166   E0           MOVX    A,@DPTR
   \   000167   6402         XRL     A,#0x2
   \   000169   702D         JNZ     ??ZDO_beaconNotifyIndCB_10
   2310                {
   2311                  if ( ((pBeacon->LQI   > pNwkDesc->chosenRouterLinkQuality) &&
   2312                        (pBeacon->depth < MAX_NODE_DEPTH)) ||
   2313                      ((pBeacon->LQI   == pNwkDesc->chosenRouterLinkQuality) &&
   2314                       (pBeacon->depth < pNwkDesc->chosenRouterDepth)) )
   \   00016B   8E82         MOV     DPL,R6
   \   00016D   8F83         MOV     DPH,R7
   \   00016F   A3           INC     DPTR
   \   000170   A3           INC     DPTR
   \   000171   A3           INC     DPTR
   \   000172   A3           INC     DPTR
   \   000173   A3           INC     DPTR
   \   000174   A3           INC     DPTR
   \   000175   A3           INC     DPTR
   \   000176   A3           INC     DPTR
   \   000177   A3           INC     DPTR
   \   000178   E0           MOVX    A,@DPTR
   \   000179   C3           CLR     C
   \   00017A   98           SUBB    A,R0
   \   00017B   500A         JNC     ??ZDO_beaconNotifyIndCB_11
   \   00017D   12....       LCALL   ?Subroutine36 & 0xFFFF
   \                     ??CrossCallReturnLabel_48:
   \   000180   12....       LCALL   ??Subroutine60_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_106:
   \   000183   602D         JZ      ??ZDO_beaconNotifyIndCB_12
   \   000185   802C         SJMP    ??ZDO_beaconNotifyIndCB_13
   \                     ??ZDO_beaconNotifyIndCB_11:
   \   000187   8E82         MOV     DPL,R6
   \   000189   8F83         MOV     DPH,R7
   \   00018B   A3           INC     DPTR
   \   00018C   A3           INC     DPTR
   \   00018D   A3           INC     DPTR
   \   00018E   A3           INC     DPTR
   \   00018F   A3           INC     DPTR
   \   000190   A3           INC     DPTR
   \   000191   A3           INC     DPTR
   \   000192   A3           INC     DPTR
   \   000193   A3           INC     DPTR
   \   000194   E0           MOVX    A,@DPTR
   \   000195   68           XRL     A,R0
   \   000196   701B         JNZ     ??ZDO_beaconNotifyIndCB_13
   \                     ??ZDO_beaconNotifyIndCB_10:
   \   000198   8E82         MOV     DPL,R6
   \   00019A   8F83         MOV     DPH,R7
   \   00019C   A3           INC     DPTR
   \   00019D   A3           INC     DPTR
   \   00019E   A3           INC     DPTR
   \   00019F   A3           INC     DPTR
   \   0001A0   A3           INC     DPTR
   \   0001A1   A3           INC     DPTR
   \   0001A2   A3           INC     DPTR
   \   0001A3   A3           INC     DPTR
   \   0001A4   A3           INC     DPTR
   \   0001A5   A3           INC     DPTR
   \   0001A6   E0           MOVX    A,@DPTR
   \   0001A7   F8           MOV     R0,A
   \   0001A8   12....       LCALL   ?Subroutine36 & 0xFFFF
   \                     ??CrossCallReturnLabel_49:
   \   0001AB   12....       LCALL   ??Subroutine60_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_107:
   \   0001AE   C3           CLR     C
   \   0001AF   98           SUBB    A,R0
   \   0001B0   5001         JNC     ??ZDO_beaconNotifyIndCB_13
   2315                  {
   2316                    selected = TRUE;
   \                     ??ZDO_beaconNotifyIndCB_12:
   \   0001B2   09           INC     R1
   2317                  }
   2318                }
   2319                else
   2320                {
   2321                  if ( pBeacon->depth < pNwkDesc->chosenRouterDepth )
   2322                  {
   2323                    selected = TRUE;
   2324                  }
   2325                }
   2326          
   2327                if ( ZSTACK_ROUTER_BUILD )
   2328                {
   2329                  capacity = pBeacon->routerCapacity;
   2330                }
   2331                else if ( ZSTACK_END_DEVICE_BUILD )
   2332                {
   2333                  capacity = pBeacon->deviceCapacity;
   2334                }
   2335          
   2336                if ( (capacity) && (selected) )
   \                     ??ZDO_beaconNotifyIndCB_13:
   \   0001B3   85..82       MOV     DPL,?V0 + 0
   \   0001B6   85..83       MOV     DPH,?V0 + 1
   \   0001B9   A3           INC     DPTR
   \   0001BA   A3           INC     DPTR
   \   0001BB   A3           INC     DPTR
   \   0001BC   A3           INC     DPTR
   \   0001BD   A3           INC     DPTR
   \   0001BE   A3           INC     DPTR
   \   0001BF   A3           INC     DPTR
   \   0001C0   E0           MOVX    A,@DPTR
   \   0001C1   6042         JZ      ??ZDO_beaconNotifyIndCB_14
   \   0001C3   E9           MOV     A,R1
   \   0001C4   A2E0         MOV     C,0xE0 /* A   */.0
   \   0001C6   5032         JNC     ??ZDO_beaconNotifyIndCB_15
   2337                {
   2338                  // this is the new chosen router for joining...
   2339                  pNwkDesc->chosenRouter            = pBeacon->sourceAddr;
   \   0001C8   85..82       MOV     DPL,?V0 + 0
   \   0001CB   85..83       MOV     DPH,?V0 + 1
   \   0001CE   12....       LCALL   ??Subroutine44_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_72:
   \   0001D1   8E82         MOV     DPL,R6
   \   0001D3   8F83         MOV     DPH,R7
   \   0001D5   A3           INC     DPTR
   \   0001D6   A3           INC     DPTR
   \   0001D7   A3           INC     DPTR
   \   0001D8   A3           INC     DPTR
   \   0001D9   A3           INC     DPTR
   \   0001DA   A3           INC     DPTR
   \   0001DB   A3           INC     DPTR
   \   0001DC   E8           MOV     A,R0
   \   0001DD   F0           MOVX    @DPTR,A
   \   0001DE   A3           INC     DPTR
   \   0001DF   E9           MOV     A,R1
   \   0001E0   12....       LCALL   ?Subroutine10 & 0xFFFF
   2340                  pNwkDesc->chosenRouterLinkQuality = pBeacon->LQI;
   \                     ??CrossCallReturnLabel_2:
   \   0001E3   A3           INC     DPTR
   \   0001E4   A3           INC     DPTR
   \   0001E5   A3           INC     DPTR
   \   0001E6   12....       LCALL   ?Subroutine20 & 0xFFFF
   \                     ??CrossCallReturnLabel_22:
   \   0001E9   F0           MOVX    @DPTR,A
   2341                  pNwkDesc->chosenRouterDepth       = pBeacon->depth;
   \   0001EA   12....       LCALL   ?Subroutine36 & 0xFFFF
   2342                }
   \                     ??CrossCallReturnLabel_50:
   \   0001ED   12....       LCALL   ??Subroutine55_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_115:
   \   0001F0   12....       LCALL   ?Subroutine20 & 0xFFFF
   \                     ??CrossCallReturnLabel_23:
   \   0001F3   A3           INC     DPTR
   \   0001F4   12....       LCALL   ?Subroutine10 & 0xFFFF
   2343          
   2344                if ( pBeacon->deviceCapacity )
   \                     ??CrossCallReturnLabel_3:
   \   0001F7   E0           MOVX    A,@DPTR
   \   0001F8   600B         JZ      ??ZDO_beaconNotifyIndCB_14
   2345                  pNwkDesc->deviceCapacity = 1;
   \                     ??ZDO_beaconNotifyIndCB_15:
   \   0001FA   8E82         MOV     DPL,R6
   \   0001FC   8F83         MOV     DPH,R7
   \   0001FE   A3           INC     DPTR
   \   0001FF   A3           INC     DPTR
   \   000200   A3           INC     DPTR
   \   000201   A3           INC     DPTR
   \   000202   7401         MOV     A,#0x1
   \   000204   F0           MOVX    @DPTR,A
   2346          
   2347                if ( pBeacon->routerCapacity )
   \                     ??ZDO_beaconNotifyIndCB_14:
   \   000205   85..82       MOV     DPL,?V0 + 0
   \   000208   85..83       MOV     DPH,?V0 + 1
   \   00020B   A3           INC     DPTR
   \   00020C   A3           INC     DPTR
   \   00020D   A3           INC     DPTR
   \   00020E   A3           INC     DPTR
   \   00020F   A3           INC     DPTR
   \   000210   A3           INC     DPTR
   \   000211   E0           MOVX    A,@DPTR
   \   000212   600A         JZ      ??ZDO_beaconNotifyIndCB_1
   2348                  pNwkDesc->routerCapacity = 1;
   \   000214   8E82         MOV     DPL,R6
   \   000216   8F83         MOV     DPH,R7
   \   000218   A3           INC     DPTR
   \   000219   A3           INC     DPTR
   \   00021A   A3           INC     DPTR
   \   00021B   7401         MOV     A,#0x1
   \   00021D   F0           MOVX    @DPTR,A
   2349              }
   2350            }
   \                     ??ZDO_beaconNotifyIndCB_1:
   \   00021E   02....       LJMP    ?Subroutine5 & 0xFFFF
   2351          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine36:
   \   000000   E5..         MOV     A,?V0 + 0
   \   000002   240B         ADD     A,#0xb
   \   000004   F582         MOV     DPL,A
   \   000006   E5..         MOV     A,?V0 + 1
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine26:
   \   000000   12....       LCALL   ?Subroutine39 & 0xFFFF
   \                     ??CrossCallReturnLabel_57:
   \   000003   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine39:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   8E82         MOV     DPL,R6
   \   000003   8F83         MOV     DPH,R7
   \   000005   A3           INC     DPTR
   \   000006   A3           INC     DPTR
   \   000007   A3           INC     DPTR
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine20:
   \   000000   12....       LCALL   ?Subroutine39 & 0xFFFF
   \                     ??CrossCallReturnLabel_56:
   \   000003   A3           INC     DPTR
   \   000004   A3           INC     DPTR
   \   000005   A3           INC     DPTR
   \   000006   A3           INC     DPTR
   \   000007   A3           INC     DPTR
   \   000008   A3           INC     DPTR
   \   000009   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine15:
   \   000000   A3           INC     DPTR
   \   000001   A3           INC     DPTR
   \   000002   12....       LCALL   ?Subroutine38 & 0xFFFF
   \                     ??CrossCallReturnLabel_54:
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine38:
   \   000000   F0           MOVX    @DPTR,A
   \   000001   85..82       MOV     DPL,?V0 + 0
   \   000004   85..83       MOV     DPH,?V0 + 1
   \   000007   A3           INC     DPTR
   \   000008   A3           INC     DPTR
   \   000009   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine10:
   \   000000   12....       LCALL   ?Subroutine38 & 0xFFFF
   \                     ??CrossCallReturnLabel_55:
   \   000003   A3           INC     DPTR
   \   000004   A3           INC     DPTR
   \   000005   A3           INC     DPTR
   \   000006   A3           INC     DPTR
   \   000007   A3           INC     DPTR
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine60_0:
   \   000000   12....       LCALL   ??Subroutine55_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_121:
   \   000003   E0           MOVX    A,@DPTR
   \   000004   22           RET
   2352          
   2353          /*********************************************************************
   2354           * @fn          ZDO_StartRouterConfirmCB
   2355           *
   2356           * @brief       This function reports the results of the request to
   2357           *              start functioning as a router in a network.
   2358           *
   2359           * @param       Status - Result of NLME_StartRouterRequest()
   2360           *
   2361           * @return      none
   2362           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2363          void ZDO_StartRouterConfirmCB( ZStatus_t Status )
   \                     ZDO_StartRouterConfirmCB:
   2364          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   2365            nwkStatus = (byte)Status;
   \   000006   90....       MOV     DPTR,#nwkStatus
   \   000009   F0           MOVX    @DPTR,A
   2366          
   2367            if ( Status == ZSUCCESS )
   \   00000A   700A         JNZ     ??ZDO_StartRouterConfirmCB_0
   2368            {
   2369              // LED on shows Router started
   2370              HalLedSet ( HAL_LED_3, HAL_LED_MODE_ON );
   \   00000C                ; Setup parameters for call to function HalLedSet
   \   00000C   12....       LCALL   ?Subroutine37 & 0xFFFF
   2371              // LED off forgets HOLD_AUTO_START
   2372              HalLedSet ( HAL_LED_4, HAL_LED_MODE_OFF);
   2373              if ( devState == DEV_HOLD )
   \                     ??CrossCallReturnLabel_52:
   \   00000F   700C         JNZ     ??ZDO_StartRouterConfirmCB_1
   2374              {
   2375                // Began with HOLD_AUTO_START
   2376                devState = DEV_END_DEVICE;
   \   000011   7406         MOV     A,#0x6
   \   000013   F0           MOVX    @DPTR,A
   \   000014   8007         SJMP    ??ZDO_StartRouterConfirmCB_1
   2377              }
   2378            }
   2379          #if defined(BLINK_LEDS)
   2380            else
   2381            {
   2382              HalLedSet( HAL_LED_3, HAL_LED_MODE_FLASH );  // Flash LED to show failure
   \                     ??ZDO_StartRouterConfirmCB_0:
   \   000016                ; Setup parameters for call to function HalLedSet
   \   000016   7A04         MOV     R2,#0x4
   \   000018   7904         MOV     R1,#0x4
   \   00001A   12....       LCALL   ??HalLedSet?relay
   2383            }
   2384          #endif
   2385          
   2386            osal_set_event( ZDAppTaskID, ZDO_ROUTER_START );
   \                     ??ZDO_StartRouterConfirmCB_1:
   \   00001D                ; Setup parameters for call to function osal_set_event
   \   00001D   7A20         MOV     R2,#0x20
   \   00001F   02....       LJMP    ?Subroutine0 & 0xFFFF
   2387          }
   2388          
   2389          /*********************************************************************
   2390           * @fn          ZDO_JoinConfirmCB
   2391           *
   2392           * @brief       This function allows the next hight layer to be notified
   2393           *              of the results of its request to join itself or another
   2394           *              device to a network.
   2395           *
   2396           * @param       Status - Result of NLME_JoinRequest()
   2397           *
   2398           * @return      none
   2399           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2400          void ZDO_JoinConfirmCB( uint16 PanId, ZStatus_t Status )
   \                     ZDO_JoinConfirmCB:
   2401          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 5
   \   000005   74FB         MOV     A,#-0x5
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   FE           MOV     R6,A
   2402            (void)PanId;  // remove if this parameter is used.
   2403          
   2404            nwkStatus = (byte)Status;
   \   00000C   90....       MOV     DPTR,#nwkStatus
   \   00000F   F0           MOVX    @DPTR,A
   2405          
   2406            if ( Status == ZSUCCESS )
   \   000010   700A         JNZ     ??ZDO_JoinConfirmCB_0
   2407            {
   2408              // LED on shows device joined
   2409              HalLedSet ( HAL_LED_3, HAL_LED_MODE_ON );
   \   000012                ; Setup parameters for call to function HalLedSet
   \   000012   12....       LCALL   ?Subroutine37 & 0xFFFF
   2410              // LED off forgets HOLD_AUTO_START
   2411              HalLedSet ( HAL_LED_4, HAL_LED_MODE_OFF);
   2412              if ( (devState == DEV_HOLD) )
   \                     ??CrossCallReturnLabel_53:
   \   000015   700C         JNZ     ??ZDO_JoinConfirmCB_1
   2413              {
   2414                // Began with HOLD_AUTO_START
   2415                devState = DEV_NWK_JOINING;
   \   000017   7403         MOV     A,#0x3
   \   000019   F0           MOVX    @DPTR,A
   \   00001A   8007         SJMP    ??ZDO_JoinConfirmCB_1
   2416              }
   2417          
   2418              if ( !ZG_SECURE_ENABLED )
   2419              {
   2420                // Notify to save info into NV
   2421                ZDApp_NVUpdate();
   2422              }
   2423            }
   2424            else                    //超次处理  5次
   2425            {  
   2426          
   2427          #if defined(BLINK_LEDS)
   2428              HalLedSet ( HAL_LED_3, HAL_LED_MODE_FLASH );  // Flash LED to show failure
   \                     ??ZDO_JoinConfirmCB_0:
   \   00001C                ; Setup parameters for call to function HalLedSet
   \   00001C   7A04         MOV     R2,#0x4
   \   00001E   7904         MOV     R1,#0x4
   \   000020   12....       LCALL   ??HalLedSet?relay
   2429          #endif
   2430            }
   2431          
   2432            // Pass the join confirm to higher layer if callback registered
   2433            if (zdoCBFunc[ZDO_JOIN_CNF_CBID] != NULL )
   \                     ??ZDO_JoinConfirmCB_1:
   \   000023   90....       MOV     DPTR,#zdoCBFunc + 8
   \   000026   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_17:
   \   000029   6033         JZ      ??ZDO_JoinConfirmCB_2
   2434            {
   2435              zdoJoinCnf_t joinCnf;
   2436          
   2437              joinCnf.status = Status;
   \   00002B   EE           MOV     A,R6
   \   00002C   85..82       MOV     DPL,?XSP + 0
   \   00002F   85..83       MOV     DPH,?XSP + 1
   \   000032   F0           MOVX    @DPTR,A
   2438              joinCnf.deviceAddr = _NIB.nwkDevAddress;
   \   000033   90....       MOV     DPTR,#_NIB + 20
   \   000036   12....       LCALL   ??Subroutine44_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_73:
   \   000039   7401         MOV     A,#0x1
   \   00003B   12....       LCALL   ?XSTACK_DISP0_8
   \   00003E   E8           MOV     A,R0
   \   00003F   F0           MOVX    @DPTR,A
   \   000040   A3           INC     DPTR
   \   000041   E9           MOV     A,R1
   \   000042   F0           MOVX    @DPTR,A
   2439              joinCnf.parentAddr = _NIB.nwkCoordAddress;
   \   000043   90....       MOV     DPTR,#_NIB + 23
   \   000046   12....       LCALL   ??Subroutine44_0 & 0xFFFF
   2440          
   2441              zdoCBFunc[ZDO_JOIN_CNF_CBID]( (void*)&joinCnf );
   2442            }
   \                     ??CrossCallReturnLabel_74:
   \   000049   7403         MOV     A,#0x3
   \   00004B   12....       LCALL   ?XSTACK_DISP0_8
   \   00004E   E8           MOV     A,R0
   \   00004F   F0           MOVX    @DPTR,A
   \   000050   A3           INC     DPTR
   \   000051   E9           MOV     A,R1
   \   000052   12....       LCALL   ?Subroutine13 & 0xFFFF
   \                     ??CrossCallReturnLabel_9:
   \   000055   90....       MOV     DPTR,#zdoCBFunc + 8
   \   000058   12....       LCALL   ??Subroutine57_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_101:
   \   00005B   12....       LCALL   ?CALL_IND
   2443          
   2444            // Notify ZDApp
   2445            ZDApp_SendMsg( ZDAppTaskID, ZDO_NWK_JOIN_IND, sizeof(osal_event_hdr_t), (byte*)NULL );
   \                     ??ZDO_JoinConfirmCB_2:
   \   00005E                ; Setup parameters for call to function ZDApp_SendMsg
   \   00005E   7C00         MOV     R4,#0x0
   \   000060   7D00         MOV     R5,#0x0
   \   000062   7B02         MOV     R3,#0x2
   \   000064   7A02         MOV     R2,#0x2
   \   000066   12....       LCALL   ?Subroutine23 & 0xFFFF
   2446          
   2447          }
   \                     ??CrossCallReturnLabel_26:
   \   000069                REQUIRE ?Subroutine6
   \   000069                ; // Fall through to label ?Subroutine6

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine6:
   \   000000   7405         MOV     A,#0x5
   \   000002   12....       LCALL   ?DEALLOC_XSTACK8
   \   000005   02....       LJMP    ??Subroutine50_0 & 0xFFFF
   2448          
   2449          /*********************************************************************
   2450           * @fn          ZDO_AddrChangeIndicationCB
   2451           *
   2452           * @brief       This function notifies the application that this
   2453           *              device's address has changed.  Could happen in
   2454           *              a network with stochastic addressing (PRO).
   2455           *
   2456           * @param       newAddr - the new address
   2457           *
   2458           * @return      none
   2459           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2460          void ZDO_AddrChangeIndicationCB( uint16 newAddr )
   \                     ZDO_AddrChangeIndicationCB:
   2461          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 0,R2
   \   000007   8B..         MOV     ?V0 + 1,R3
   2462            ZDO_AddrChangeInd_t *pZDOAddrChangeMsg;
   2463            epList_t *pItem = epList;
   \   000009   90....       MOV     DPTR,#epList
   \   00000C   12....       LCALL   ??Subroutine53_0 & 0xFFFF
   2464          
   2465            // Notify to save info into NV
   2466            ZDApp_NVUpdate();
   2467          
   2468            // Notify the applications
   2469            osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \                     ??CrossCallReturnLabel_90:
   \   00000F                ; Setup parameters for call to function osal_set_event
   \   00000F   12....       LCALL   ?Subroutine18 & 0xFFFF
   \                     ??CrossCallReturnLabel_64:
   \   000012   8033         SJMP    ??ZDO_AddrChangeIndicationCB_0
   2470          
   2471            while (pItem != NULL)
   2472            {
   2473              if (pItem->epDesc->endPoint != ZDO_EP)
   \                     ??ZDO_AddrChangeIndicationCB_1:
   \   000014   12....       LCALL   ?Subroutine17 & 0xFFFF
   \                     ??CrossCallReturnLabel_103:
   \   000017   E0           MOVX    A,@DPTR
   \   000018   6026         JZ      ??ZDO_AddrChangeIndicationCB_2
   2474              {
   2475                pZDOAddrChangeMsg = (ZDO_AddrChangeInd_t *)osal_msg_allocate( sizeof( ZDO_AddrChangeInd_t ) );
   \   00001A                ; Setup parameters for call to function osal_msg_allocate
   \   00001A   7A04         MOV     R2,#0x4
   \   00001C   7B00         MOV     R3,#0x0
   \   00001E   12....       LCALL   ??osal_msg_allocate?relay
   2476                if (pZDOAddrChangeMsg != NULL)
   \   000021   EA           MOV     A,R2
   \   000022   4B           ORL     A,R3
   \   000023   601B         JZ      ??ZDO_AddrChangeIndicationCB_2
   2477                {
   2478                  pZDOAddrChangeMsg->hdr.event = ZDO_ADDR_CHANGE_IND;
   \   000025   8A82         MOV     DPL,R2
   \   000027   8B83         MOV     DPH,R3
   \   000029   74D6         MOV     A,#-0x2a
   \   00002B   F0           MOVX    @DPTR,A
   2479                  pZDOAddrChangeMsg->shortAddr = newAddr;
   \   00002C   A3           INC     DPTR
   \   00002D   A3           INC     DPTR
   \   00002E   E5..         MOV     A,?V0 + 0
   \   000030   F0           MOVX    @DPTR,A
   \   000031   A3           INC     DPTR
   \   000032   E5..         MOV     A,?V0 + 1
   \   000034   F0           MOVX    @DPTR,A
   2480                  osal_msg_send( *(pItem->epDesc->task_id), (uint8 *)pZDOAddrChangeMsg );
   \   000035                ; Setup parameters for call to function osal_msg_send
   \   000035   12....       LCALL   ?Subroutine17 & 0xFFFF
   2481                }
   2482              }
   \                     ??CrossCallReturnLabel_104:
   \   000038   12....       LCALL   ??Subroutine56_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_102:
   \   00003B   E0           MOVX    A,@DPTR
   \   00003C   F9           MOV     R1,A
   \   00003D   12....       LCALL   ??osal_msg_send?relay
   2483              pItem = pItem->nextDesc;
   \                     ??ZDO_AddrChangeIndicationCB_2:
   \   000040   12....       LCALL   ?Subroutine19 & 0xFFFF
   2484            }
   \                     ??CrossCallReturnLabel_78:
   \   000043   E8           MOV     A,R0
   \   000044   FE           MOV     R6,A
   \   000045   E9           MOV     A,R1
   \   000046   FF           MOV     R7,A
   \                     ??ZDO_AddrChangeIndicationCB_0:
   \   000047   EE           MOV     A,R6
   \   000048   4F           ORL     A,R7
   \   000049   70C9         JNZ     ??ZDO_AddrChangeIndicationCB_1
   2485          
   2486            // Send out a device announce
   2487            ZDApp_AnnounceNewAddress();
   \   00004B                ; Setup parameters for call to function ZDApp_AnnounceNewAddress
   \   00004B   12....       LCALL   ??ZDApp_AnnounceNewAddress?relay
   2488          }
   \   00004E   02....       LJMP    ??Subroutine46_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine17:
   \   000000   8E82         MOV     DPL,R6
   \   000002   8F83         MOV     DPH,R7
   \   000004   A3           INC     DPTR
   \   000005                REQUIRE ??Subroutine56_0
   \   000005                ; // Fall through to label ??Subroutine56_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine56_0:
   \   000000   A3           INC     DPTR
   \   000001                REQUIRE ??Subroutine57_0
   \   000001                ; // Fall through to label ??Subroutine57_0
   2489          
   2490          /*********************************************************************
   2491           * @fn          ZDO_JoinIndicationCB
   2492           *
   2493           * @brief       This function allows the next higher layer of a
   2494           *              coordinator to be notified of a remote join request.
   2495           *
   2496           * @param       ShortAddress - 16-bit address
   2497           * @param       ExtendedAddress - IEEE (64-bit) address
   2498           * @param       CapabilityFlags - Association Capability Flags
   2499           * @param       type - of joining -
   2500           *                          NWK_ASSOC_JOIN
   2501           *                          NWK_ASSOC_REJOIN_UNSECURE
   2502           *                          NWK_ASSOC_REJOIN_SECURE
   2503           *
   2504           * @return      ZStatus_t
   2505           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2506          ZStatus_t ZDO_JoinIndicationCB(uint16 ShortAddress, uint8 *ExtendedAddress,
   \                     ZDO_JoinIndicationCB:
   2507                                          uint8 CapabilityFlags, uint8 type)
   2508          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   2509            (void)ShortAddress;
   2510            (void)ExtendedAddress;
   2511          #if ZDO_NV_SAVE_RFDs
   2512            (void)CapabilityFlags;
   2513          
   2514          #else  // if !ZDO_NV_SAVE_RFDs
   2515            if (CapabilityFlags & CAPINFO_DEVICETYPE_FFD)
   2516          #endif
   2517            {
   2518              ZDApp_NVUpdate();  // Notify to save info into NV.
   2519            }
   2520          
   2521            if (ZG_SECURE_ENABLED)  // Send notification to TC of new device.
   2522            {
   2523              if (type == NWK_ASSOC_JOIN || type == NWK_ASSOC_REJOIN_UNSECURE)
   2524              {
   2525                osal_start_timerEx( ZDAppTaskID, ZDO_NEW_DEVICE, 600 );
   2526              }
   2527            }
   2528          
   2529            return ZSuccess;
   \   000000                REQUIRE ?Subroutine3
   \   000000                ; // Fall through to label ?Subroutine3

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine3:
   \   000000   7900         MOV     R1,#0x0
   \   000002   02....       LJMP    ?BRET
   2530          }
   2531          
   2532          /*********************************************************************
   2533           * @fn          ZDO_ConcentratorIndicationCB
   2534           *
   2535           * @brief       This function allows the next higher layer of a
   2536           *              device to be notified of existence of the concentrator.
   2537           *
   2538           * @param       nwkAddr - 16-bit NWK address of the concentrator
   2539           * @param       extAddr - pointer to extended Address
   2540           *                        NULL if not available
   2541           * @param       pktCost - PktCost from RREQ
   2542           *
   2543           * @return      void
   2544           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2545          void ZDO_ConcentratorIndicationCB( uint16 nwkAddr, uint8 *extAddr, uint8 pktCost )
   \                     ZDO_ConcentratorIndicationCB:
   2546          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 5
   \   000005   74FB         MOV     A,#-0x5
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   2547            zdoConcentratorInd_t conInd;
   2548          
   2549            conInd.nwkAddr = nwkAddr;
   \   00000A   12....       LCALL   ?Subroutine14 & 0xFFFF
   2550            conInd.extAddr = extAddr;
   \                     ??CrossCallReturnLabel_128:
   \   00000D   7402         MOV     A,#0x2
   \   00000F   12....       LCALL   ?XSTACK_DISP0_8
   \   000012   EC           MOV     A,R4
   \   000013   F0           MOVX    @DPTR,A
   \   000014   A3           INC     DPTR
   \   000015   ED           MOV     A,R5
   \   000016   F0           MOVX    @DPTR,A
   2551            conInd.pktCost = pktCost;
   \   000017   7404         MOV     A,#0x4
   \   000019   12....       LCALL   ?XSTACK_DISP0_8
   \   00001C   E9           MOV     A,R1
   \   00001D   F0           MOVX    @DPTR,A
   2552          
   2553            if( zdoCBFunc[ZDO_CONCENTRATOR_IND_CBID] != NULL )
   \   00001E   90....       MOV     DPTR,#zdoCBFunc + 2
   \   000021   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_18:
   \   000024   6013         JZ      ??ZDO_ConcentratorIndicationCB_0
   2554            {
   2555              zdoCBFunc[ZDO_CONCENTRATOR_IND_CBID]( (void*)&conInd );
   \   000026                ; Setup parameters for indirect call
   \   000026   85..82       MOV     DPL,?XSP + 0
   \   000029   85..83       MOV     DPH,?XSP + 1
   \   00002C   AA82         MOV     R2,DPL
   \   00002E   AB83         MOV     R3,DPH
   \   000030   90....       MOV     DPTR,#zdoCBFunc + 3
   \   000033   12....       LCALL   ??Subroutine58_0 & 0xFFFF
   2556            }
   \                     ??CrossCallReturnLabel_96:
   \   000036   12....       LCALL   ?CALL_IND
   2557          }
   \                     ??ZDO_ConcentratorIndicationCB_0:
   \   000039   02....       LJMP    ?Subroutine6 & 0xFFFF
   2558          
   2559          /*********************************************************************
   2560           * @fn          ZDO_LeaveCnf
   2561           *
   2562           * @brief       This function allows the next higher layer to be
   2563           *              notified of the results of its request for this or
   2564           *              a child device to leave the network.
   2565           *
   2566           * @param       cnf - NLME_LeaveCnf_t
   2567           *
   2568           * @return      none
   2569           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2570          void ZDO_LeaveCnf( NLME_LeaveCnf_t* cnf )
   \                     ZDO_LeaveCnf:
   2571          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   2572            // Check for this device
   2573            if ( osal_ExtAddrEqual( cnf->extAddr,
   2574                                    NLME_GetExtAddr() ) == TRUE )
   \   000009                ; Setup parameters for call to function sAddrExtCmp
   \   000009                ; Setup parameters for call to function NLME_GetExtAddr
   \   000009   12....       LCALL   ??NLME_GetExtAddr?relay
   \   00000C   EA           MOV     A,R2
   \   00000D   FC           MOV     R4,A
   \   00000E   EB           MOV     A,R3
   \   00000F   FD           MOV     R5,A
   \   000010   EE           MOV     A,R6
   \   000011   2402         ADD     A,#0x2
   \   000013   FA           MOV     R2,A
   \   000014   EF           MOV     A,R7
   \   000015   3400         ADDC    A,#0x0
   \   000017   FB           MOV     R3,A
   \   000018   12....       LCALL   ??sAddrExtCmp?relay
   \   00001B   E9           MOV     A,R1
   \   00001C   6401         XRL     A,#0x1
   \   00001E   701F         JNZ     ??CrossCallReturnLabel_38
   2575            {
   2576              // Pass the leave confirm to higher layer if callback registered
   2577              if ( ( zdoCBFunc[ZDO_LEAVE_CNF_CBID] == NULL ) ||
   2578                   ( (*zdoCBFunc[ZDO_LEAVE_CNF_CBID])( cnf ) == NULL ) )
   \   000020   90....       MOV     DPTR,#zdoCBFunc + 10
   \   000023   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_19:
   \   000026   6011         JZ      ??ZDO_LeaveCnf_0
   \   000028                ; Setup parameters for indirect call
   \   000028   EE           MOV     A,R6
   \   000029   FA           MOV     R2,A
   \   00002A   EF           MOV     A,R7
   \   00002B   FB           MOV     R3,A
   \   00002C   12....       LCALL   ??Subroutine58_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_97:
   \   00002F   12....       LCALL   ?CALL_IND
   \   000032   8B..         MOV     ?V0 + 1,R3
   \   000034   EA           MOV     A,R2
   \   000035   45..         ORL     A,?V0 + 1
   \   000037   7006         JNZ     ??CrossCallReturnLabel_38
   2579              {
   2580                // Prepare to leave with reset
   2581                ZDApp_LeaveReset( cnf->rejoin );
   \                     ??ZDO_LeaveCnf_0:
   \   000039                ; Setup parameters for call to function ZDApp_LeaveReset
   \   000039   EE           MOV     A,R6
   \   00003A   240B         ADD     A,#0xb
   \   00003C   12....       LCALL   ?Subroutine30 & 0xFFFF
   2582              }
   2583            }
   2584            else if ( ZSTACK_ROUTER_BUILD )
   2585            {
   2586              // Remove device address(optionally descendents) from data
   2587              ZDApp_LeaveUpdate( cnf->dstAddr,
   2588                                 cnf->extAddr,
   2589                                 cnf->removeChildren );
   2590            }
   2591          }
   \                     ??CrossCallReturnLabel_38:
   \   00003F   02....       LJMP    ??Subroutine52_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine30:
   \   000000   12....       LCALL   ??Subroutine54_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_118:
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F9           MOV     R1,A
   \   000005   12....       LCALL   ??ZDApp_LeaveReset?relay
   \   000008   22           RET
   2592          
   2593          /*********************************************************************
   2594           * @fn          ZDO_LeaveInd
   2595           *
   2596           * @brief       This function allows the next higher layer of a
   2597           *              device to be notified of a remote leave request or
   2598           *              indication.
   2599           *
   2600           * @param       ind - NLME_LeaveInd_t
   2601           *
   2602           * @return      none
   2603           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2604          void ZDO_LeaveInd( NLME_LeaveInd_t* ind )
   \                     ZDO_LeaveInd:
   2605          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   2606            uint8 leave;
   2607          
   2608          
   2609            // Parent is requesting the leave - NWK layer filters out illegal
   2610            // requests
   2611            if ( ind->request == TRUE )
   \   000009   8E82         MOV     DPL,R6
   \   00000B   8F83         MOV     DPH,R7
   \   00000D   A3           INC     DPTR
   \   00000E   A3           INC     DPTR
   \   00000F   A3           INC     DPTR
   \   000010   A3           INC     DPTR
   \   000011   A3           INC     DPTR
   \   000012   A3           INC     DPTR
   \   000013   A3           INC     DPTR
   \   000014   A3           INC     DPTR
   \   000015   A3           INC     DPTR
   \   000016   A3           INC     DPTR
   \   000017   E0           MOVX    A,@DPTR
   \   000018   6401         XRL     A,#0x1
   \   00001A   7008         JNZ     ??ZDO_LeaveInd_0
   2612            {
   2613              // Notify network of leave
   2614              if ( ZSTACK_ROUTER_BUILD )
   2615              {
   2616                NLME_LeaveRsp_t rsp;
   2617                rsp.rejoin         = ind->rejoin;
   2618                rsp.removeChildren = ind->removeChildren;
   2619                NLME_LeaveRsp( &rsp );
   2620              }
   2621          
   2622              // Prepare to leave with reset
   2623              ZDApp_LeaveReset( ind->rejoin );
   \                     ??ZDO_LeaveInd_1:
   \   00001C                ; Setup parameters for call to function ZDApp_LeaveReset
   \   00001C   EE           MOV     A,R6
   \   00001D   240C         ADD     A,#0xc
   \   00001F   12....       LCALL   ?Subroutine30 & 0xFFFF
   2624            }
   \                     ??CrossCallReturnLabel_39:
   \   000022   803F         SJMP    ??ZDO_LeaveInd_2
   2625            else
   2626            {
   2627              leave = FALSE;
   2628          
   2629              // Check if this device needs to leave as a child or descendent
   2630              if ( ind->srcAddr == NLME_GetCoordShortAddr() )
   \                     ??ZDO_LeaveInd_0:
   \   000024                ; Setup parameters for call to function NLME_GetCoordShortAddr
   \   000024   12....       LCALL   ??NLME_GetCoordShortAddr?relay
   \   000027   8A..         MOV     ?V0 + 0,R2
   \   000029   8B..         MOV     ?V0 + 1,R3
   \   00002B   A8..         MOV     R0,?V0 + 0
   \   00002D   A9..         MOV     R1,?V0 + 1
   \   00002F   8E82         MOV     DPL,R6
   \   000031   8F83         MOV     DPH,R7
   \   000033   E0           MOVX    A,@DPTR
   \   000034   68           XRL     A,R0
   \   000035   7003         JNZ     ??ZDO_LeaveInd_3
   \   000037   A3           INC     DPTR
   \   000038   E0           MOVX    A,@DPTR
   \   000039   69           XRL     A,R1
   \                     ??ZDO_LeaveInd_3:
   \   00003A   7011         JNZ     ??ZDO_LeaveInd_4
   2631              {
   2632                if ( ( ind->removeChildren == TRUE               ) ||
   2633                     ( ZDO_Config_Node_Descriptor.LogicalType ==
   2634                       NODETYPE_DEVICE                           )    )
   \   00003C   12....       LCALL   ?Subroutine32 & 0xFFFF
   2635                {
   2636                  leave = TRUE;
   2637                }
   2638              }
   \                     ??CrossCallReturnLabel_111:
   \   00003F   6401         XRL     A,#0x1
   \   000041   60D9         JZ      ??ZDO_LeaveInd_1
   \   000043   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000046   E0           MOVX    A,@DPTR
   \   000047   5407         ANL     A,#0x7
   \   000049   6402         XRL     A,#0x2
   \   00004B   60CF         JZ      ??ZDO_LeaveInd_1
   2639              else if ( ind->removeChildren == TRUE )
   2640              {
   2641                // Check NWK address allocation algorithm
   2642                //leave = RTG_ANCESTOR(nwkAddr,thisAddr);
   2643              }
   2644          
   2645              if ( leave == TRUE )
   2646              {
   2647                // Prepare to leave with reset
   2648                ZDApp_LeaveReset( ind->rejoin );
   2649              }
   2650              else
   2651              {
   2652                // Remove device address(optionally descendents) from data
   2653                ZDApp_LeaveUpdate( ind->srcAddr,
   2654                                   ind->extAddr,
   2655                                   ind->removeChildren );
   \                     ??ZDO_LeaveInd_4:
   \   00004D                ; Setup parameters for call to function ZDApp_LeaveUpdate
   \   00004D   12....       LCALL   ?Subroutine32 & 0xFFFF
   2656              }
   2657            }
   \                     ??CrossCallReturnLabel_112:
   \   000050   F9           MOV     R1,A
   \   000051   EE           MOV     A,R6
   \   000052   2402         ADD     A,#0x2
   \   000054   FC           MOV     R4,A
   \   000055   EF           MOV     A,R7
   \   000056   3400         ADDC    A,#0x0
   \   000058   FD           MOV     R5,A
   \   000059   8E82         MOV     DPL,R6
   \   00005B   8F83         MOV     DPH,R7
   \   00005D   12....       LCALL   ?Subroutine24 & 0xFFFF
   \                     ??CrossCallReturnLabel_31:
   \   000060   12....       LCALL   ??ZDApp_LeaveUpdate?relay
   2658          
   2659            // Pass the leave indication to higher layer if callback registered.
   2660            if (zdoCBFunc[ZDO_LEAVE_IND_CBID] != NULL)
   \                     ??ZDO_LeaveInd_2:
   \   000063   90....       MOV     DPTR,#zdoCBFunc + 12
   \   000066   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_20:
   \   000069   600A         JZ      ??ZDO_LeaveInd_5
   2661            {
   2662              (void)zdoCBFunc[ZDO_LEAVE_IND_CBID](ind);
   \   00006B                ; Setup parameters for indirect call
   \   00006B   EE           MOV     A,R6
   \   00006C   FA           MOV     R2,A
   \   00006D   EF           MOV     A,R7
   \   00006E   FB           MOV     R3,A
   \   00006F   12....       LCALL   ??Subroutine58_0 & 0xFFFF
   2663            }
   \                     ??CrossCallReturnLabel_98:
   \   000072   12....       LCALL   ?CALL_IND
   2664          }
   \                     ??ZDO_LeaveInd_5:
   \   000075   02....       LJMP    ??Subroutine52_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine32:
   \   000000   EE           MOV     A,R6
   \   000001   240B         ADD     A,#0xb
   \   000003                REQUIRE ??Subroutine59_0
   \   000003                ; // Fall through to label ??Subroutine59_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine59_0:
   \   000000   F582         MOV     DPL,A
   \   000002   EF           MOV     A,R7
   \   000003                REQUIRE ??Subroutine60_0
   \   000003                ; // Fall through to label ??Subroutine60_0
   2665          
   2666          /*********************************************************************
   2667           * @fn          ZDO_SyncIndicationCB
   2668           *
   2669           * @brief       This function allows the next higher layer of a
   2670           *              coordinator to be notified of a loss of synchronization
   2671           *                          with the parent/child device.
   2672           *
   2673           * @param       type: 0 - child; 1 - parent
   2674           *
   2675           *
   2676           * @return      none
   2677           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2678          void ZDO_SyncIndicationCB( uint8 type, uint16 shortAddr )
   \                     ZDO_SyncIndicationCB:
   2679          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   2680            (void)shortAddr;  // Remove this line if this parameter is used.
   2681          
   2682            if ( ZSTACK_END_DEVICE_BUILD
   2683              || (ZSTACK_ROUTER_BUILD && ((_NIB.CapabilityFlags & ZMAC_ASSOC_CAPINFO_FFD_TYPE) == 0)))
   2684            {
   2685              if ( type == 1 )
   \   000007   7401         MOV     A,#0x1
   \   000009   6E           XRL     A,R6
   \   00000A   700E         JNZ     ??CrossCallReturnLabel_27
   2686              {
   2687                // We lost contact with our parent.  Clear the neighbor Table.
   2688                nwkNeighborInitTable();
   \   00000C                ; Setup parameters for call to function nwkNeighborInitTable
   \   00000C   12....       LCALL   ??nwkNeighborInitTable?relay
   2689          
   2690                // Start the rejoin process.
   2691                ZDApp_SendMsg( ZDAppTaskID, ZDO_NWK_JOIN_REQ, sizeof(osal_event_hdr_t), NULL );
   \   00000F                ; Setup parameters for call to function ZDApp_SendMsg
   \   00000F   7C00         MOV     R4,#0x0
   \   000011   7D00         MOV     R5,#0x0
   \   000013   7B02         MOV     R3,#0x2
   \   000015   7A03         MOV     R2,#0x3
   \   000017   12....       LCALL   ?Subroutine23 & 0xFFFF
   2692              }
   2693            }
   2694          }
   \                     ??CrossCallReturnLabel_27:
   \   00001A   02....       LJMP    ??Subroutine50_0 & 0xFFFF
   2695          
   2696          /*********************************************************************
   2697           * @fn          ZDO_ManytoOneFailureIndicationCB
   2698           *
   2699           * @brief       This function allows the next higher layer of a
   2700           *              concentrator to be notified of a many-to-one route
   2701           *              failure.
   2702           *
   2703           * @param       none
   2704           *
   2705           *
   2706           * @return      none
   2707           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2708          void ZDO_ManytoOneFailureIndicationCB()
   \                     ZDO_ManytoOneFailureIndicationCB:
   2709          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2710            // By default, the concentrator automatically redo many-to-one route
   2711            // discovery to update all many-to-one routes in the network
   2712            // If you want anything processing other than the default,
   2713            // please replace the following code.
   2714          
   2715            RTG_MTORouteReq();
   \   000004                ; Setup parameters for call to function RTG_MTORouteReq
   \   000004   12....       LCALL   ??RTG_MTORouteReq?relay
   2716          }
   \   000007   02....       LJMP    ?Subroutine2 & 0xFFFF
   2717          
   2718          /*********************************************************************
   2719           * @fn          ZDO_PollConfirmCB
   2720           *
   2721           * @brief       This function allows the next higher layer to be
   2722           *              notified of a Poll Confirm.
   2723           *
   2724           * @param       none
   2725           *
   2726           * @return      none
   2727           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2728          void ZDO_PollConfirmCB( uint8 status )
   \                     ZDO_PollConfirmCB:
   2729          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   2730            (void)status;  // Remove this line if this parameter is used.
   2731            return;
   \   000000   02....       LJMP    ?BRET
   2732          }
   2733          
   2734          /******************************************************************************
   2735           * @fn          ZDApp_NwkWriteNVRequest (stubs AddrMgrWriteNVRequest)
   2736           *
   2737           * @brief       Stub routine implemented by NHLE. NHLE should call
   2738           *              <AddrMgrWriteNV> when appropriate.
   2739           *
   2740           * @param       none
   2741           *
   2742           * @return      none
   2743           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2744          void ZDApp_NwkWriteNVRequest( void )
   \                     AddrMgrWriteNVRequest:
   2745          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   2746          #if defined ( NV_RESTORE )
   2747            if ( !osal_get_timeoutEx( ZDAppTaskID, ZDO_NWK_UPDATE_NV ) )
   2748            {
   2749              // Trigger to save info into NV
   2750              ZDApp_NVUpdate();
   2751            }
   2752          #endif
   2753          }
   \   000000   02....       LJMP    ?BRET
   2754          
   2755          /*********************************************************************
   2756           * Call Back Functions from Security  - API
   2757           */
   2758          
   2759           /*********************************************************************
   2760           * @fn          ZDO_UpdateDeviceIndication
   2761           *
   2762           * @brief       This function notifies the "Trust Center" of a
   2763           *              network when a device joins or leaves the network.
   2764           *
   2765           * @param       extAddr - pointer to 64 bit address of new device
   2766           * @param       status  - 0 if a new device joined securely
   2767           *                      - 1 if a new device joined un-securely
   2768           *                      - 2 if a device left the network
   2769           *
   2770           * @return      true if newly joined device should be allowed to
   2771           *                                              remain on network
   2772           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2773          ZStatus_t ZDO_UpdateDeviceIndication( uint8 *extAddr, uint8 status )
   \                     ZDO_UpdateDeviceIndication:
   2774          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   2775            // can implement a network access policy based on the
   2776            // IEEE address of newly joining devices...
   2777            (void)extAddr;
   2778            (void)status;
   2779          
   2780            return ZSuccess;
   \   000000   02....       LJMP    ?Subroutine3 & 0xFFFF
   2781          }
   2782          
   2783          /*********************************************************************
   2784           * @fn          ZDApp_InMsgCB
   2785           *
   2786           * @brief       This function is called to pass up any message that is
   2787           *              not yet supported.  This allows for the developer to
   2788           *              support features themselves..
   2789           *
   2790           * @return      none
   2791           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2792          void ZDApp_InMsgCB( zdoIncomingMsg_t *inMsg )
   \                     ZDApp_InMsgCB:
   2793          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   2794            if ( inMsg->clusterID & ZDO_RESPONSE_BIT )
   \   000009   12....       LCALL   ?Subroutine40 & 0xFFFF
   \                     ??CrossCallReturnLabel_119:
   \   00000C   A3           INC     DPTR
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   5480         ANL     A,#0x80
   \   000010   704A         JNZ     ??ZDApp_InMsgCB_0
   2795            {
   2796              // Handle the response message
   2797            }
   2798            else
   2799            {
   2800              // Handle the request message by sending a generic "not supported".
   2801              // Device Announce doesn't have a response.
   2802              if ( !(inMsg->wasBroadcast) && inMsg->clusterID != Device_annce )
   \   000012   12....       LCALL   ?Subroutine32 & 0xFFFF
   \                     ??CrossCallReturnLabel_113:
   \   000015   7045         JNZ     ??ZDApp_InMsgCB_0
   \   000017   EE           MOV     A,R6
   \   000018   240C         ADD     A,#0xc
   \   00001A   12....       LCALL   ??Subroutine59_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_108:
   \   00001D   6413         XRL     A,#0x13
   \   00001F   7002         JNZ     ??ZDApp_InMsgCB_1
   \   000021   A3           INC     DPTR
   \   000022   E0           MOVX    A,@DPTR
   \                     ??ZDApp_InMsgCB_1:
   \   000023   6037         JZ      ??ZDApp_InMsgCB_0
   2803              {
   2804                ZDP_GenericRsp( inMsg->TransSeq, &(inMsg->srcAddr), ZDP_NOT_SUPPORTED, 0,
   2805                                (uint16)(inMsg->clusterID | ZDO_RESPONSE_BIT), inMsg->SecurityUse );
   \   000025                ; Setup parameters for call to function ZDP_GenericRsp
   \   000025   12....       LCALL   ?Subroutine31 & 0xFFFF
   2806              }
   2807            }
   \                     ??CrossCallReturnLabel_41:
   \   000028   4480         ORL     A,#0x80
   \   00002A   F5..         MOV     ?V0 + 1,A
   \   00002C   78..         MOV     R0,#?V0 + 0
   \   00002E   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000031   E4           CLR     A
   \   000032   F5..         MOV     ?V0 + 0,A
   \   000034   F5..         MOV     ?V0 + 1,A
   \   000036   78..         MOV     R0,#?V0 + 0
   \   000038   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00003B   EE           MOV     A,R6
   \   00003C   240E         ADD     A,#0xe
   \   00003E   12....       LCALL   ??Subroutine59_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_109:
   \   000041   FD           MOV     R5,A
   \   000042   7C84         MOV     R4,#-0x7c
   \   000044   EE           MOV     A,R6
   \   000045   2402         ADD     A,#0x2
   \   000047   0A           INC     R2
   \   000048   0A           INC     R2
   \   000049   EF           MOV     A,R7
   \   00004A   3400         ADDC    A,#0x0
   \   00004C   FB           MOV     R3,A
   \   00004D   EE           MOV     A,R6
   \   00004E   240F         ADD     A,#0xf
   \   000050   12....       LCALL   ??Subroutine59_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_110:
   \   000053   F9           MOV     R1,A
   \   000054   12....       LCALL   ??ZDP_GenericRsp?relay
   \   000057   7404         MOV     A,#0x4
   \   000059   12....       LCALL   ?DEALLOC_XSTACK8
   2808          }
   \                     ??ZDApp_InMsgCB_0:
   \   00005C   02....       LJMP    ??Subroutine52_0 & 0xFFFF
   2809          
   2810          
   2811          /*********************************************************************
   2812           * @fn      ZDApp_ChangeMatchDescRespPermission()
   2813           *
   2814           * @brief   Changes the Match Descriptor Response permission.
   2815           *
   2816           * @param   endpoint - endpoint to allow responses
   2817           * @param   action - true to allow responses, false to not
   2818           *
   2819           * @return  none
   2820           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2821          void ZDApp_ChangeMatchDescRespPermission( uint8 endpoint, uint8 action )
   \                     ZDApp_ChangeMatchDescRespPermission:
   2822          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   2823            // Store the action
   2824            afSetMatch( endpoint, action );
   \   000005                ; Setup parameters for call to function afSetMatch
   \   000005   12....       LCALL   ??afSetMatch?relay
   2825          }
   \   000008   02....       LJMP    ??Subroutine50_0 & 0xFFFF
   2826          
   2827          /*********************************************************************
   2828           * @fn      ZDApp_NetworkInit()
   2829           *
   2830           * @brief   Used to start the network joining process
   2831           *
   2832           * @param   delay - mSec delay to wait before starting
   2833           *
   2834           * @return  none
   2835           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2836          void ZDApp_NetworkInit( uint16 delay )
   \                     ZDApp_NetworkInit:
   2837          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2838            if ( delay )
   \   000004   EA           MOV     A,R2
   \   000005   4B           ORL     A,R3
   \   000006   600B         JZ      ??ZDApp_NetworkInit_0
   2839            {
   2840              // Wait awhile before starting the device
   2841              osal_start_timerEx( ZDAppTaskID, ZDO_NETWORK_INIT, delay );
   \   000008                ; Setup parameters for call to function osal_start_timerEx
   \   000008   EA           MOV     A,R2
   \   000009   FC           MOV     R4,A
   \   00000A   EB           MOV     A,R3
   \   00000B   FD           MOV     R5,A
   \   00000C   7A01         MOV     R2,#0x1
   \   00000E   12....       LCALL   ?Subroutine25 & 0xFFFF
   2842            }
   \                     ??CrossCallReturnLabel_87:
   \   000011   8005         SJMP    ??CrossCallReturnLabel_67
   2843            else
   2844            {
   2845          //****************网络初始化事件**********************************************//
   2846              osal_set_event( ZDAppTaskID, ZDO_NETWORK_INIT );
   \                     ??ZDApp_NetworkInit_0:
   \   000013                ; Setup parameters for call to function osal_set_event
   \   000013   7A01         MOV     R2,#0x1
   \   000015   12....       LCALL   ??Subroutine42_0 & 0xFFFF
   2847            }
   2848          }
   \                     ??CrossCallReturnLabel_67:
   \   000018   02....       LJMP    ?Subroutine2 & 0xFFFF
   2849          
   2850          /*********************************************************************
   2851           * @fn      ZDApp_NwkStateUpdateCB()
   2852           *
   2853           * @brief   This function notifies that this device's network
   2854           *          state info has been changed.
   2855           *
   2856           * @param   none
   2857           *
   2858           * @return  none
   2859           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2860          void ZDApp_NwkStateUpdateCB( void )
   \                     ZDApp_NwkStateUpdateCB:
   2861          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2862            // Notify to save info into NV
   2863            if ( !osal_get_timeoutEx( ZDAppTaskID, ZDO_NWK_UPDATE_NV ) )
   \   000004                ; Setup parameters for call to function osal_get_timeoutEx
   \   000004   7A00         MOV     R2,#0x0
   \   000006   7B02         MOV     R3,#0x2
   \   000008   90....       MOV     DPTR,#ZDAppTaskID
   \   00000B   E0           MOVX    A,@DPTR
   \   00000C   F9           MOV     R1,A
   \   00000D   12....       LCALL   ??osal_get_timeoutEx?relay
   2864            {
   2865              // Trigger to save info into NV
   2866              ZDApp_NVUpdate();
   2867            }
   2868          }
   \   000010   02....       LJMP    ?Subroutine2 & 0xFFFF
   2869          
   2870          /*********************************************************************
   2871           * @fn      ZDApp_NodeProfileSync()
   2872           *
   2873           * @brief   Sync node with stack profile.
   2874           *
   2875           * @param   stackProfile - stack profile of the network to join
   2876           *
   2877           * @return  none
   2878           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2879          void ZDApp_NodeProfileSync( uint8 stackProfile )
   \                     ZDApp_NodeProfileSync:
   2880          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   2881            if ( ZDO_Config_Node_Descriptor.CapabilityFlags & CAPINFO_DEVICETYPE_FFD  )
   \   000007   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   A2E1         MOV     C,0xE0 /* A   */.1
   \   00000D   501A         JNC     ??ZDApp_NodeProfileSync_0
   2882            {
   2883              if ( stackProfile != zgStackProfile )
   \   00000F   90....       MOV     DPTR,#zgStackProfile
   \   000012   E0           MOVX    A,@DPTR
   \   000013   6E           XRL     A,R6
   \   000014   6013         JZ      ??ZDApp_NodeProfileSync_0
   2884              {
   2885                ZDO_Config_Node_Descriptor.LogicalType = NODETYPE_DEVICE;
   \   000016   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   54F8         ANL     A,#0xf8
   \   00001C   4402         ORL     A,#0x2
   \   00001E   F0           MOVX    @DPTR,A
   2886                ZDO_Config_Node_Descriptor.CapabilityFlags = CAPINFO_DEVICETYPE_RFD | CAPINFO_POWER_AC | CAPINFO_RCVR_ON_IDLE;
   \   00001F   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   000022   740C         MOV     A,#0xc
   \   000024   F0           MOVX    @DPTR,A
   2887                NLME_SetBroadcastFilter( ZDO_Config_Node_Descriptor.CapabilityFlags );
   \   000025                ; Setup parameters for call to function NLME_SetBroadcastFilter
   \   000025   F9           MOV     R1,A
   \   000026   12....       LCALL   ??NLME_SetBroadcastFilter?relay
   2888              }
   2889            }
   2890          }
   \                     ??ZDApp_NodeProfileSync_0:
   \   000029   02....       LJMP    ??Subroutine50_0 & 0xFFFF
   2891          
   2892          /*********************************************************************
   2893           * @fn      ZDApp_StartJoiningCycle()
   2894           *
   2895           * @brief   Starts the joining cycle of a device.  This will only
   2896           *          continue an already started (or stopped) joining cycle.
   2897           *
   2898           * @param   none
   2899           *
   2900           * @return  TRUE if joining stopped, FALSE if joining or rejoining
   2901           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2902          uint8 ZDApp_StartJoiningCycle( void )
   \                     ZDApp_StartJoiningCycle:
   2903          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2904            if ( devState == DEV_INIT || devState == DEV_NWK_DISC )
   \   000004   90....       MOV     DPTR,#devState
   \   000007   E0           MOVX    A,@DPTR
   \   000008   6401         XRL     A,#0x1
   \   00000A   6005         JZ      ??ZDApp_StartJoiningCycle_0
   \   00000C   E0           MOVX    A,@DPTR
   \   00000D   6402         XRL     A,#0x2
   \   00000F   7011         JNZ     ??ZDApp_StartJoiningCycle_1
   2905            {
   2906              continueJoining = TRUE;
   \                     ??ZDApp_StartJoiningCycle_0:
   \   000011   90....       MOV     DPTR,#continueJoining
   \   000014   7401         MOV     A,#0x1
   \   000016   F0           MOVX    @DPTR,A
   2907              ZDApp_NetworkInit( 0 );
   \   000017                ; Setup parameters for call to function ZDApp_NetworkInit
   \   000017   7A00         MOV     R2,#0x0
   \   000019   7B00         MOV     R3,#0x0
   \   00001B   12....       LCALL   ??ZDApp_NetworkInit?relay
   2908          
   2909              return ( TRUE );
   \   00001E   7901         MOV     R1,#0x1
   \   000020   8002         SJMP    ??ZDApp_StartJoiningCycle_2
   2910            }
   2911            else
   2912              return ( FALSE );
   \                     ??ZDApp_StartJoiningCycle_1:
   \   000022   7900         MOV     R1,#0x0
   \                     ??ZDApp_StartJoiningCycle_2:
   \   000024   02....       LJMP    ?Subroutine2 & 0xFFFF
   2913          }
   2914          
   2915          /*********************************************************************
   2916           * @fn      ZDApp_StopJoiningCycle()
   2917           *
   2918           * @brief   Stops the joining or rejoining process of a device.
   2919           *
   2920           * @param   none
   2921           *
   2922           * @return  TRUE if joining stopped, FALSE if joining or rejoining
   2923           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2924          uint8 ZDApp_StopJoiningCycle( void )
   \                     ZDApp_StopJoiningCycle:
   2925          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2926            if ( devState == DEV_INIT || devState == DEV_NWK_DISC )
   \   000004   90....       MOV     DPTR,#devState
   \   000007   E0           MOVX    A,@DPTR
   \   000008   6401         XRL     A,#0x1
   \   00000A   6005         JZ      ??ZDApp_StopJoiningCycle_0
   \   00000C   E0           MOVX    A,@DPTR
   \   00000D   6402         XRL     A,#0x2
   \   00000F   7009         JNZ     ??ZDApp_StopJoiningCycle_1
   2927            {
   2928              continueJoining = FALSE;
   \                     ??ZDApp_StopJoiningCycle_0:
   \   000011   90....       MOV     DPTR,#continueJoining
   \   000014   E4           CLR     A
   \   000015   F0           MOVX    @DPTR,A
   2929              return ( TRUE );
   \   000016   7901         MOV     R1,#0x1
   \   000018   8002         SJMP    ??ZDApp_StopJoiningCycle_2
   2930            }
   2931            else
   2932              return ( FALSE );
   \                     ??ZDApp_StopJoiningCycle_1:
   \   00001A   7900         MOV     R1,#0x0
   \                     ??ZDApp_StopJoiningCycle_2:
   \   00001C   02....       LJMP    ?Subroutine2 & 0xFFFF
   2933          }
   2934          
   2935          /*********************************************************************
   2936           * @fn      ZDApp_AnnounceNewAddress()
   2937           *
   2938           * @brief   Send Device Announce and hold all transmissions for
   2939           *          new address timeout.
   2940           *
   2941           * @param   none
   2942           *
   2943           * @return  none
   2944           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2945          void ZDApp_AnnounceNewAddress( void )
   \                     ZDApp_AnnounceNewAddress:
   2946          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   2947          #if defined ( ZIGBEE_NWK_UNIQUE_ADDR_CHECK )
   2948            // Turn off data request hold
   2949            APSME_HoldDataRequests( 0 );
   \   000005                ; Setup parameters for call to function APSME_HoldDataRequests
   \   000005   7A00         MOV     R2,#0x0
   \   000007   7B00         MOV     R3,#0x0
   \   000009   12....       LCALL   ??APSME_HoldDataRequests?relay
   2950          #endif
   2951          
   2952            ZDP_DeviceAnnce( NLME_GetShortAddr(), NLME_GetExtAddr(),
   2953                               ZDO_Config_Node_Descriptor.CapabilityFlags, 0 );
   \   00000C                ; Setup parameters for call to function NLME_GetExtAddr
   \   00000C   12....       LCALL   ??NLME_GetExtAddr?relay
   \   00000F   8A..         MOV     ?V0 + 0,R2
   \   000011   8B..         MOV     ?V0 + 1,R3
   \   000013   AE..         MOV     R6,?V0 + 0
   \   000015                ; Setup parameters for call to function NLME_GetShortAddr
   \   000015   12....       LCALL   ??NLME_GetShortAddr?relay
   \   000018                ; Setup parameters for call to function ZDP_DeviceAnnce
   \   000018   75..00       MOV     ?V0 + 0,#0x0
   \   00001B   78..         MOV     R0,#?V0 + 0
   \   00001D   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000020   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   000023   E0           MOVX    A,@DPTR
   \   000024   F9           MOV     R1,A
   \   000025   EE           MOV     A,R6
   \   000026   FC           MOV     R4,A
   \   000027   AD..         MOV     R5,?V0 + 1
   \   000029   12....       LCALL   ??ZDP_DeviceAnnce?relay
   \   00002C   7401         MOV     A,#0x1
   \   00002E   12....       LCALL   ?DEALLOC_XSTACK8
   2954          
   2955          #if defined ( ZIGBEE_NWK_UNIQUE_ADDR_CHECK )
   2956            // Setup the timeout
   2957            APSME_HoldDataRequests( ZDAPP_HOLD_DATA_REQUESTS_TIMEOUT );
   \   000031                ; Setup parameters for call to function APSME_HoldDataRequests
   \   000031   7A00         MOV     R2,#0x0
   \   000033   7B00         MOV     R3,#0x0
   \   000035   12....       LCALL   ??APSME_HoldDataRequests?relay
   2958          #endif
   2959          }
   \   000038   02....       LJMP    ??Subroutine52_0 & 0xFFFF
   2960          
   2961          /*********************************************************************
   2962           * @fn          ZDApp_NVUpdate
   2963           *
   2964           * @brief       Set the NV Update Timer.
   2965           *
   2966           * @param       none
   2967           *
   2968           * @return      none
   2969           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2970          void ZDApp_NVUpdate( void )
   \                     ZDApp_NVUpdate:
   2971          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   2972          #if defined ( NV_RESTORE )
   2973            osal_start_timerEx( ZDAppTaskID, ZDO_NWK_UPDATE_NV, ZDAPP_UPDATE_NWK_NV_TIME );
   2974          #endif
   2975          }
   \   000000   02....       LJMP    ?BRET
   2976          
   2977          /*********************************************************************
   2978           * @fn      ZDApp_CoordStartPANIDConflictCB()
   2979           *
   2980           * @brief   Returns a PAN ID for the network layer to use during
   2981           *          a coordinator start and there is another network with
   2982           *          the intended PANID.
   2983           *
   2984           * @param   panid - the intended PAN ID
   2985           *
   2986           * @return  PANID to try
   2987           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2988          uint16 ZDApp_CoordStartPANIDConflictCB( uint16 panid )
   \                     ZDApp_CoordStartPANIDConflictCB:
   2989          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   2990            return ( panid + 1 );
   \   000000   EA           MOV     A,R2
   \   000001   2401         ADD     A,#0x1
   \   000003   0A           INC     R2
   \   000004   EB           MOV     A,R3
   \   000005   3400         ADDC    A,#0x0
   \   000007   FB           MOV     R3,A
   \   000008   02....       LJMP    ?BRET
   2991          }
   2992          
   2993          /*********************************************************************
   2994           * @fn          ZDO_SrcRtgIndCB
   2995           *
   2996           * @brief       This function notifies the ZDO available src route record received.
   2997           *
   2998           * @param       srcAddr - source address of the source route
   2999           * @param       relayCnt - number of devices in the relay list
   3000           * @param       relayList - relay list of the source route
   3001           *
   3002           * @return      none
   3003           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   3004          void ZDO_SrcRtgIndCB (uint16 srcAddr, uint8 relayCnt, uint16* pRelayList )
   \                     ZDO_SrcRtgIndCB:
   3005          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 5
   \   000005   74FB         MOV     A,#-0x5
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   3006            zdoSrcRtg_t srcRtg;
   3007          
   3008            srcRtg.srcAddr = srcAddr;
   \   00000A   12....       LCALL   ?Subroutine14 & 0xFFFF
   3009            srcRtg.relayCnt = relayCnt;
   \                     ??CrossCallReturnLabel_129:
   \   00000D   7402         MOV     A,#0x2
   \   00000F   12....       LCALL   ?XSTACK_DISP0_8
   \   000012   E9           MOV     A,R1
   \   000013   F0           MOVX    @DPTR,A
   3010            srcRtg.pRelayList = pRelayList;
   \   000014   7403         MOV     A,#0x3
   \   000016   12....       LCALL   ?XSTACK_DISP0_8
   \   000019   EC           MOV     A,R4
   \   00001A   F0           MOVX    @DPTR,A
   \   00001B   A3           INC     DPTR
   \   00001C   ED           MOV     A,R5
   \   00001D   F0           MOVX    @DPTR,A
   3011          
   3012            if( zdoCBFunc[ZDO_SRC_RTG_IND_CBID] != NULL )
   \   00001E   90....       MOV     DPTR,#zdoCBFunc
   \   000021   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_21:
   \   000024   6013         JZ      ??ZDO_SrcRtgIndCB_0
   3013            {
   3014              zdoCBFunc[ZDO_SRC_RTG_IND_CBID]( (void*)&srcRtg );
   \   000026                ; Setup parameters for indirect call
   \   000026   85..82       MOV     DPL,?XSP + 0
   \   000029   85..83       MOV     DPH,?XSP + 1
   \   00002C   AA82         MOV     R2,DPL
   \   00002E   AB83         MOV     R3,DPH
   \   000030   90....       MOV     DPTR,#zdoCBFunc + 1
   \   000033   12....       LCALL   ??Subroutine58_0 & 0xFFFF
   3015            }
   \                     ??CrossCallReturnLabel_99:
   \   000036   12....       LCALL   ?CALL_IND
   3016          }
   \                     ??ZDO_SrcRtgIndCB_0:
   \   000039   02....       LJMP    ?Subroutine6 & 0xFFFF
   3017          
   3018          /*********************************************************************
   3019           * @fn          ZDApp_InitZdoCBFunc
   3020           *
   3021           * @brief       Call this function to initialize zdoCBFunc[]
   3022           *
   3023           * @param       none
   3024           *
   3025           * @return      none
   3026           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   3027          void ZDApp_InitZdoCBFunc( void )
   \                     ZDApp_InitZdoCBFunc:
   3028          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   3029            uint8 i;
   3030          
   3031            for ( i=0; i< MAX_ZDO_CB_FUNC; i++ )
   \   000004   7A00         MOV     R2,#0x0
   3032            {
   3033              zdoCBFunc[i] = NULL;
   \                     ??ZDApp_InitZdoCBFunc_0:
   \   000006   12....       LCALL   ?Subroutine29 & 0xFFFF
   3034            }
   \                     ??CrossCallReturnLabel_36:
   \   000009   0A           INC     R2
   \   00000A   EA           MOV     A,R2
   \   00000B   C3           CLR     C
   \   00000C   9407         SUBB    A,#0x7
   \   00000E   40F6         JC      ??ZDApp_InitZdoCBFunc_0
   3035          }
   \   000010   02....       LJMP    ?Subroutine2 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine29:
   \   000000   EA           MOV     A,R2
   \   000001   12....       LCALL   ?Subroutine41 & 0xFFFF
   \                     ??CrossCallReturnLabel_59:
   \   000004   E4           CLR     A
   \   000005   F0           MOVX    @DPTR,A
   \   000006   A3           INC     DPTR
   \   000007   F0           MOVX    @DPTR,A
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine41:
   \   000000   C3           CLR     C
   \   000001   33           RLC     A
   \   000002   F8           MOV     R0,A
   \   000003   E4           CLR     A
   \   000004   33           RLC     A
   \   000005   F9           MOV     R1,A
   \   000006   74..         MOV     A,#zdoCBFunc & 0xff
   \   000008   28           ADD     A,R0
   \   000009   F582         MOV     DPL,A
   \   00000B   74..         MOV     A,#(zdoCBFunc >> 8) & 0xff
   \   00000D   39           ADDC    A,R1
   \   00000E   F583         MOV     DPH,A
   \   000010   22           RET
   3036          
   3037          /*********************************************************************
   3038           * @fn          ZDO_RegisterForZdoCB
   3039           *
   3040           * @brief       Call this function to register the higher layer (for
   3041           *              example, the Application layer or MT layer) with ZDO
   3042           *              callbacks to get notified of some ZDO indication like
   3043           *              existence of a concentrator or receipt of a source
   3044           *              route record.
   3045           *
   3046           * @param       indID - ZDO Indication ID
   3047           * @param       pFn   - Callback function pointer
   3048           *
   3049           * @return      ZSuccess - successful, ZInvalidParameter if not
   3050           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   3051          ZStatus_t ZDO_RegisterForZdoCB( uint8 indID, pfnZdoCb pFn )
   \                     ZDO_RegisterForZdoCB:
   3052          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   \   000004   E9           MOV     A,R1
   \   000005   FC           MOV     R4,A
   3053            // Check the range of the indication ID
   3054            if ( indID < MAX_ZDO_CB_FUNC )
   \   000006   C3           CLR     C
   \   000007   9407         SUBB    A,#0x7
   \   000009   500B         JNC     ??ZDO_RegisterForZdoCB_0
   3055            {
   3056              zdoCBFunc[indID] = pFn;
   \   00000B   EC           MOV     A,R4
   \   00000C   12....       LCALL   ?Subroutine41 & 0xFFFF
   \                     ??CrossCallReturnLabel_58:
   \   00000F   12....       LCALL   ??Subroutine61_0 & 0xFFFF
   3057              return ZSuccess;
   \                     ??CrossCallReturnLabel_126:
   \   000012   7900         MOV     R1,#0x0
   \   000014   8002         SJMP    ??ZDO_RegisterForZdoCB_1
   3058            }
   3059          
   3060            return ZInvalidParameter;
   \                     ??ZDO_RegisterForZdoCB_0:
   \   000016   7902         MOV     R1,#0x2
   \                     ??ZDO_RegisterForZdoCB_1:
   \   000018   02....       LJMP    ?Subroutine2 & 0xFFFF
   3061          }
   3062          
   3063          /*********************************************************************
   3064           * @fn          ZDO_DeregisterForZdoCB
   3065           *
   3066           * @brief       Call this function to de-register the higher layer (for
   3067           *              example, the Application layer or MT layer) with ZDO
   3068           *              callbacks to get notified of some ZDO indication like
   3069           *              existence of a concentrator or receipt of a source
   3070           *              route record.
   3071           *
   3072           * @param       indID - ZDO Indication ID
   3073           *
   3074           * @return      ZSuccess - successful, ZInvalidParameter if not
   3075           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   3076          ZStatus_t ZDO_DeregisterForZdoCB( uint8 indID )
   \                     ZDO_DeregisterForZdoCB:
   3077          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   \   000004   E9           MOV     A,R1
   \   000005   FA           MOV     R2,A
   3078            // Check the range of the indication ID
   3079            if ( indID < MAX_ZDO_CB_FUNC )
   \   000006   C3           CLR     C
   \   000007   9407         SUBB    A,#0x7
   \   000009   5006         JNC     ??ZDO_DeregisterForZdoCB_0
   3080            {
   3081              zdoCBFunc[indID] = NULL;
   \   00000B   12....       LCALL   ?Subroutine29 & 0xFFFF
   3082              return ZSuccess;
   \                     ??CrossCallReturnLabel_37:
   \   00000E   F9           MOV     R1,A
   \   00000F   8002         SJMP    ??ZDO_DeregisterForZdoCB_1
   3083            }
   3084          
   3085            return ZInvalidParameter;
   \                     ??ZDO_DeregisterForZdoCB_0:
   \   000011   7902         MOV     R1,#0x2
   \                     ??ZDO_DeregisterForZdoCB_1:
   \   000013   02....       LJMP    ?Subroutine2 & 0xFFFF
   3086          }

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for zdoDiscCounter>`:
   \   000000   01           DB 1

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for continueJoining>`:
   \   000000   01           DB 1

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for devState>`:
   \   000000   01           DB 1

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for ZDApp_epDesc>`:
   \   000000   00           DB 0
   \   000001   ....         DW ZDAppTaskID
   \   000003   0000         DW 0H
   \   000005   00           DB 0

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for ZDApp_SavedPollRate>`:
   \   000000   E803         DW 1000

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_36ee81:
   \   000000   81EE3600     DD 3600001

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_36ee80:
   \   000000   80EE3600     DD 3600000

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_1:
   \   000000   01000000     DD 1

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_3e8:
   \   000000   E8030000     DD 1000

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_Init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_SecInit?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_SecInit

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_event_loop?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_event_loop

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ProcessSecEvent?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ProcessSecEvent

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDOInitDevice?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDOInitDevice

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ReadNetworkRestoreState?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ReadNetworkRestoreState

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDAppDetermineDeviceType?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDAppDetermineDeviceType

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NetworkStartEvt?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NetworkStartEvt

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_DeviceAuthEvt?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_DeviceAuthEvt

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_SaveNetworkStateEvt?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_SaveNetworkStateEvt

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_RestoreNetworkState?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_RestoreNetworkState

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_InitUserDesc?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_InitUserDesc

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDAppCheckForHoldKey?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDAppCheckForHoldKey

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ProcessOSALMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ProcessOSALMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ProcessMsgCBs?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ProcessMsgCBs

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_RegisterCBs?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_RegisterCBs

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ProcessSecMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ProcessSecMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ProcessNetworkJoin?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ProcessNetworkJoin

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_SaveNwkKey?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_SaveNwkKey

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ResetNwkKey?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ResetNwkKey

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_RestoreNwkKey?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_RestoreNwkKey

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ResetTimerStart?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ResetTimerStart

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ResetTimerCancel?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ResetTimerCancel

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveCtrlInit?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveCtrlInit

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveCtrlSet?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveCtrlSet

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveCtrlReset?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveCtrlReset

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveCtrlBypass?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveCtrlBypass

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveCtrlStartup?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveCtrlStartup

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveReset?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveReset

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveUpdate?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveUpdate

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NetworkDiscoveryReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NetworkDiscoveryReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_JoinReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_JoinReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_DeviceConfigured?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_DeviceConfigured

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_SendEventMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_SendEventMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_SendMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_SendMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_NetworkDiscoveryConfirmCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_NetworkDiscoveryConfirmCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NwkDescListProcessing?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NwkDescListProcessing

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_NetworkFormationConfirmCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_NetworkFormationConfirmCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_beaconNotifyIndCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_beaconNotifyIndCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_StartRouterConfirmCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_StartRouterConfirmCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_JoinConfirmCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_JoinConfirmCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_AddrChangeIndicationCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_AddrChangeIndicationCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_JoinIndicationCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_JoinIndicationCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ConcentratorIndicationCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ConcentratorIndicationCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_LeaveCnf?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_LeaveCnf

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_LeaveInd?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_LeaveInd

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_SyncIndicationCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_SyncIndicationCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ManytoOneFailureIndicationCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ManytoOneFailureIndicationCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_PollConfirmCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_PollConfirmCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??AddrMgrWriteNVRequest?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    AddrMgrWriteNVRequest

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_UpdateDeviceIndication?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_UpdateDeviceIndication

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_InMsgCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_InMsgCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ChangeMatchDescRespPermission?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ChangeMatchDescRespPermission

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NetworkInit?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NetworkInit

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NwkStateUpdateCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NwkStateUpdateCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NodeProfileSync?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NodeProfileSync

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_StartJoiningCycle?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_StartJoiningCycle

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_StopJoiningCycle?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_StopJoiningCycle

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_AnnounceNewAddress?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_AnnounceNewAddress

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NVUpdate?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NVUpdate

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_CoordStartPANIDConflictCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_CoordStartPANIDConflictCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_SrcRtgIndCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_SrcRtgIndCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_InitZdoCBFunc?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_InitZdoCBFunc

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_RegisterForZdoCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_RegisterForZdoCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_DeregisterForZdoCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_DeregisterForZdoCB
   3087          
   3088          /*********************************************************************
   3089          *********************************************************************/

   Maximum stack usage in bytes:

     Function                       ISTACK PSTACK XSTACK
     --------                       ------ ------ ------
     AddrMgrWriteNVRequest              0      0      0
     ZDAppCheckForHoldKey               2      0      9
       -> HalKeyRead                    4      0      0
     ZDAppDetermineDeviceType           2      0     12
       -> nwk_ExtPANIDValid             4      0      0
     ZDApp_AnnounceNewAddress           0      0     23
       -> APSME_HoldDataRequests        0      0     20
       -> NLME_GetExtAddr               0      0     20
       -> NLME_GetShortAddr             0      0     20
       -> ZDP_DeviceAnnce               0      0     22
       -> APSME_HoldDataRequests        0      0     20
     ZDApp_ChangeMatchDescRespPermission
                                        0      0      9
       -> afSetMatch                    0      0     18
     ZDApp_CoordStartPANIDConflictCB
                                        0      0      0
     ZDApp_DeviceAuthEvt                2      0      9
       -> ZDApp_ResetTimerCancel        4      0      0
       -> osal_set_event                4      0      0
       -> osal_pwrmgr_device            4      0      0
       -> ZDApp_SaveNwkKey              4      0      0
       -> ZDApp_AnnounceNewAddress      4      0      0
       -> NLME_SetPollRate              4      0      0
     ZDApp_DeviceConfigured             0      0     16
       -> osal_nv_read                  0      0     32
     ZDApp_InMsgCB                      0      0     14
       -> ZDP_GenericRsp                0      0     28
     ZDApp_Init                         0      0      9
       -> NLME_GetExtAddr               0      0     18
       -> ZDAppCheckForHoldKey          0      0     18
       -> ZDO_Init                      0      0     18
       -> afRegister                    0      0     18
       -> ZDOInitDevice                 0      0     18
       -> ZDOInitDevice                 0      0     18
       -> HalLedBlink                   0      0     18
       -> ZDApp_InitZdoCBFunc           0      0     18
       -> ZDApp_RegisterCBs             0      0     18
     ZDApp_InitUserDesc                 0      0     31
       -> osal_memset                   0      0     54
       -> osal_nv_item_init             0      0     58
       -> osal_nv_read                  0      0     62
     ZDApp_InitZdoCBFunc                2      0      9
     ZDApp_JoinReq                      0      0     22
       -> ZDApp_NodeProfileSync         0      0     28
       -> NLME_JoinRequest              0      0     36
     ZDApp_LeaveCtrlBypass              2      0      0
     ZDApp_LeaveCtrlInit                0      0     26
       -> osal_nv_item_init             0      0     24
       -> osal_nv_read                  0      0     28
     ZDApp_LeaveCtrlReset               0      0     14
       -> osal_nv_write                 0      0     28
     ZDApp_LeaveCtrlSet                 0      0     23
       -> osal_nv_write                 0      0     28
     ZDApp_LeaveCtrlStartup             2      0     12
       -> ZDApp_LeaveCtrlReset          4      0      0
     ZDApp_LeaveReset                   0      0     19
       -> ZDApp_LeaveCtrlSet            0      0     18
       -> ZDApp_ResetTimerStart         0      0     18
     ZDApp_LeaveUpdate                  0      0     37
       -> ZDSecMgrDeviceRemoveByExtAddr
                                        0      0     48
       -> ZDSecMgrAddrClear             0      0     48
       -> osal_memcpy                   0      0     54
       -> RTG_RemoveRtgEntry            0      0     48
       -> nwkNeighborRemove             0      0     48
     ZDApp_NVUpdate                     0      0      0
     ZDApp_NetworkDiscoveryReq          0      0     12
       -> NLME_NetworkDiscoveryRequest
                                        0      0     24
     ZDApp_NetworkInit                  2      0     13
       -> osal_start_timerEx            4      0      0
       -> osal_set_event                4      0      0
     ZDApp_NetworkStartEvt              2      0      0
       -> osal_pwrmgr_device            4      0      0
       -> osal_set_event                4      0      0
       -> NLME_GetEnergyThreshold       4      0      0
       -> NLME_GetEnergyThreshold       4      0      0
       -> NLME_SetEnergyThreshold       4      0      0
       -> osal_set_event                4      0      0
       -> osal_set_event                4      0      0
     ZDApp_NodeProfileSync              0      0     23
       -> NLME_SetBroadcastFilter       0      0     18
     ZDApp_NwkDescListProcessing        0      0     27
       -> nwk_getNwkDescList            0      0     28
       -> nwk_getNwkDescList            0      0     28
       -> nwk_ExtPANIDValid             0      0     28
       -> sAddrExtCmp                   0      0     28
     ZDApp_NwkStateUpdateCB             2      0      0
       -> osal_get_timeoutEx            4      0      0
     ZDApp_ProcessMsgCBs                0      0     44
       -> ZDO_ParseAddrRsp              0      0     62
       -> ZDO_UpdateAddrManager         0      0     62
       -> osal_mem_free                 0      0     62
       -> ZDO_ParseBindUnbindReq        0      0     62
       -> ZDO_ProcessBindUnbindReq      0      0     62
     ZDApp_ProcessNetworkJoin           0      0     25
       -> osal_set_event                0      0     24
       -> osal_pwrmgr_device            0      0     24
       -> ZDApp_AnnounceNewAddress      0      0     24
       -> NLME_GetShortAddr             0      0     24
       -> ZMacSetReq                    0      0     24
       -> nwkNeighborInitTable          0      0     24
       -> NLME_NwkDiscTerm              0      0     24
       -> osal_rand                     0      0     24
       -> ZDApp_NetworkInit             0      0     24
       -> osal_set_event                0      0     24
       -> osal_pwrmgr_device            0      0     24
       -> NLME_SetPollRate              0      0     24
       -> NLME_SetQueuedPollRate        0      0     24
       -> NLME_SetResponseRate          0      0     24
       -> ZDApp_AnnounceNewAddress      0      0     24
       -> nwkNeighborInitTable          0      0     24
       -> NLME_NwkDiscTerm              0      0     24
       -> osal_rand                     0      0     24
       -> ZDApp_NetworkInit             0      0     24
       -> ZDApp_AnnounceNewAddress      0      0     24
       -> osal_set_event                0      0     24
     ZDApp_ProcessOSALMsg               2      0     27
       -> ZDP_IncomingData              0      0     26
       -> ZDApp_ProcessMsgCBs           0      0     26
       -> ZDApp_NwkDescListProcessing
                                        0      0     26
       -> ZDApp_NodeProfileSync         0      0     26
       -> NLME_JoinRequest              0      0     34
       -> osal_rand                     0      0     26
       -> ZDApp_NetworkInit             0      0     26
       -> osal_rand                     0      0     26
       -> ZMacSetReq                    0      0     26
       -> ZMacSetReq                    0      0     26
       -> ZMacSetReq                    0      0     26
       -> NLME_ReJoinRequest            0      0     26
       -> osal_rand                     0      0     26
       -> ZDApp_NetworkInit             0      0     26
       -> NLME_SetPollRate              0      0     26
       -> NLME_SetQueuedPollRate        0      0     26
       -> NLME_SetResponseRate          0      0     26
       -> NLME_SetPollRate              0      0     26
       -> NLME_SetQueuedPollRate        0      0     26
       -> NLME_SetResponseRate          0      0     26
       -> shutdown                      0      0     26
       -> halSleep                      0      0     26
       -> halSleep                      0      0     26
       -> turnOnRFX2401C                0      0     26
       -> NLME_SetPollRate              0      0     26
       -> NLME_SetQueuedPollRate        0      0     26
       -> NLME_SetResponseRate          0      0     26
       -> osal_rand                     0      0     26
       -> ZDApp_NetworkInit             0      0     26
       -> ZDApp_ProcessNetworkJoin      0      0     26
       -> sAddrExtCpy                   0      0     26
       -> ZDApp_NetworkInit             0      0     26
     ZDApp_ProcessSecEvent              0      0      9
       -> ZDApp_DeviceAuthEvt           0      0     18
       -> ZDApp_SaveNwkKey              0      0     18
       -> ZDSecMgrSaveTCLinkKey         0      0     18
     ZDApp_ProcessSecMsg                2      0      0
       -> ZDSecMgrTransportKeyInd       4      0      0
       -> ZDSecMgrSwitchKeyInd          4      0      0
     ZDApp_ReadNetworkRestoreState      0      0      9
       -> zgReadStartupOptions          0      0     18
     ZDApp_RegisterCBs                  2      0      9
       -> ZDO_RegisterForZDOMsg         4      0      0
       -> ZDO_RegisterForZDOMsg         4      0      0
       -> ZDO_RegisterForZDOMsg         4      0      0
       -> ZDO_RegisterForZDOMsg         4      0      0
     ZDApp_ResetNwkKey                  0      0     35
       -> osal_memset                   0      0     62
       -> osal_nv_write                 0      0     70
     ZDApp_ResetTimerCancel             2      0      0
       -> osal_stop_timerEx             4      0      0
     ZDApp_ResetTimerStart              2      0      9
       -> osal_start_timerEx            4      0      0
     ZDApp_RestoreNetworkState          0      0      9
       -> NLME_InitNV                   0      0     18
       -> NLME_RestoreFromNV            0      0     18
       -> NLME_GetShortAddr             0      0     18
       -> sAddrExtCpy                   0      0     18
     ZDApp_RestoreNwkKey                0      0     37
       -> osal_nv_read                  0      0     74
       -> osal_memset                   0      0     66
     ZDApp_SaveNetworkStateEvt          0      0      0
     ZDApp_SaveNwkKey                   0      0     46
       -> SSP_ReadNwkActiveKey          0      0     66
       -> osal_nv_write                 0      0     74
       -> osal_memset                   0      0     66
     ZDApp_SecInit                      0      0      9
       -> ZDSecMgrInit                  0      0     18
     ZDApp_SendEventMsg                 0      0      9
       -> ZDApp_SendMsg                 0      0     18
     ZDApp_SendMsg                      1      0     33
       -> osal_msg_allocate             0      0     32
       -> osal_memcpy                   0      0     38
       -> osal_msg_send                 0      0     32
     ZDApp_StartJoiningCycle            2      0      0
       -> ZDApp_NetworkInit             4      0      0
     ZDApp_StopJoiningCycle             2      0      0
     ZDApp_event_loop                   0      0     10
       -> osal_set_event                0      0     20
       -> ZDO_StartDevice               0      0     20
       -> ZDApp_ProcessOSALMsg          0      0     20
       -> osal_msg_deallocate           0      0     20
       -> osal_msg_receive              0      0     20
       -> ZDO_UpdateNwkStatus           0      0     20
       -> osal_start_timerEx            0      0     20
       -> zgWriteStartupOptions         0      0     20
       -> Onboard_soft_reset            0      0     20
     ZDOInitDevice                      0      0     21
       -> zgInitItems                   0      0     24
       -> ZDConfig_InitDescriptors      0      0     24
       -> ZDAppDetermineDeviceType      0      0     24
       -> osal_rand                     0      0     24
       -> ZDSecMgrInit                  0      0     24
       -> ZDApp_LeaveCtrlInit           0      0     24
       -> ZDApp_LeaveCtrlStartup        0      0     24
       -> zgWriteStartupOptions         0      0     24
       -> osal_set_event                0      0     24
       -> ZDApp_NetworkInit             0      0     24
       -> NLME_SetBroadcastFilter       0      0     24
     ZDO_AddrChangeIndicationCB         0      0     12
       -> osal_set_event                0      0     24
       -> osal_msg_allocate             0      0     24
       -> osal_msg_send                 0      0     24
       -> ZDApp_AnnounceNewAddress      0      0     24
     ZDO_ConcentratorIndicationCB       1      0     14
     ZDO_DeregisterForZdoCB             2      0      0
     ZDO_JoinConfirmCB                  1      0     14
       -> HalLedSet                     0      0     28
       -> HalLedSet                     0      0     28
       -> HalLedSet                     0      0     28
       -> ZDApp_SendMsg                 0      0     28
     ZDO_JoinIndicationCB               0      0      1
     ZDO_LeaveCnf                       0      0     10
       -> NLME_GetExtAddr               0      0     20
       -> sAddrExtCmp                   0      0     20
       -> ZDApp_LeaveReset              0      0     20
     ZDO_LeaveInd                       0      0     10
       -> ZDApp_LeaveReset              0      0     20
       -> NLME_GetCoordShortAddr        0      0     20
       -> ZDApp_LeaveUpdate             0      0     20
     ZDO_ManytoOneFailureIndicationCB
                                        2      0      0
       -> RTG_MTORouteReq               4      0      0
     ZDO_NetworkDiscoveryConfirmCB      3      0      3
       -> ZDApp_SendMsg                 4      0      6
     ZDO_NetworkFormationConfirmCB      0      0      9
       -> HalLedSet                     0      0     18
       -> HalLedSet                     0      0     18
       -> HalLedSet                     0      0     18
       -> osal_set_event                0      0     18
     ZDO_PollConfirmCB                  0      0      0
     ZDO_RegisterForZdoCB               2      0      0
     ZDO_SrcRtgIndCB                    1      0     14
     ZDO_StartRouterConfirmCB           0      0      9
       -> HalLedSet                     0      0     18
       -> HalLedSet                     0      0     18
       -> HalLedSet                     0      0     18
       -> osal_set_event                0      0     18
     ZDO_SyncIndicationCB               0      0      9
       -> nwkNeighborInitTable          0      0     18
       -> ZDApp_SendMsg                 0      0     18
     ZDO_UpdateDeviceIndication         0      0      0
     ZDO_beaconNotifyIndCB              1      0     14
       -> osal_mem_alloc                0      0     28
       -> osal_memset                   0      0     28
       -> sAddrExtCpy                   0      0     28
       -> osal_memset                   0      0     28


   Segment part sizes:

     Function/Label                              Bytes
     --------------                              -----
     _A_P1                                          1
     P1DIR                                          1
     zdoDiscCounter                                 1
     ZDAppNwkAddr                                   9
     zdappMgmtNwkDiscRspTransSeq                    1
     zdappMgmtNwkDiscReqInProgress                  1
     zdappMgmtNwkDiscRspAddr                        9
     zdappMgmtNwkDiscStartIndex                     1
     zdappMgmtSavedNwkState                         1
     nwkFrameCounterChanges                         2
     continueJoining                                1
     _tmpRejoinState                                1
     ZDO_UseExtendedPANID                           8
     zdoCBFunc                                     14
     linkedCount                                    1
     ZDAppTaskID                                    1
     nwkStatus                                      1
     ZDApp_AutoFindMode_epDesc                      2
     ZDApp_LeaveCtrl                                1
     devState                                       1
     devStartMode                                   1
     retryCnt                                       1
     ZDApp_epDesc                                   6
     ZDApp_SavedPollRate                            2
     ZDApp_Init                                    85
     ??Subroutine50_0                               5
     ZDApp_SecInit                                 11
     ZDApp_event_loop                             171
     ?Subroutine18                                  2
     ??Subroutine42_0                              11
     ??Subroutine49_0                               6
     ??Subroutine52_0                               5
     ZDApp_ProcessSecEvent                        101
     ??Subroutine44_0                               6
     ??Subroutine61_0                               6
     ZDOInitDevice                                150
     ?Subroutine7                                   5
     ??Subroutine51_0                               3
     ?Subroutine14                                  6
     ZDApp_ReadNetworkRestoreState                 21
     ZDAppDetermineDeviceType                      74
     ?Subroutine2                                   7
     ZDApp_NetworkStartEvt                         79
     ZDApp_DeviceAuthEvt                           44
     ?Subroutine9                                  24
     ?Subroutine24                                  6
     ZDApp_SaveNetworkStateEvt                      3
     ZDApp_RestoreNetworkState                     65
     ?Subroutine11                                 13
     ?Subroutine16                                  8
     ZDApp_InitUserDesc                            89
     ?Subroutine33                                 32
     ?Subroutine35                                  8
     ZDAppCheckForHoldKey                          20
     ZDApp_ProcessOSALMsg                         574
     ?Subroutine34                                  1
     ??Subroutine43_0                               9
     ?Subroutine19                                  4
     ??Subroutine45_0                               3
     ??Subroutine46_0                               5
     ?Subroutine28                                 15
     ?Subroutine27                                  4
     ??Subroutine48_0                              18
     ?Subroutine12                                 12
     ZDApp_ProcessMsgCBs                          118
     ?Subroutine8                                   5
     ?Subroutine40                                  3
     ??Subroutine54_0                               3
     ??Subroutine55_0                               5
     ?Subroutine31                                  9
     ZDApp_RegisterCBs                             31
     ?Subroutine22                                  2
     ??Subroutine47_0                               9
     ZDApp_ProcessSecMsg                           56
     ZDApp_ProcessNetworkJoin                     338
     ?Subroutine13                                 12
     ?Subroutine4                                   2
     ZDApp_SaveNwkKey                             112
     ZDApp_ResetNwkKey                             48
     ZDApp_RestoreNwkKey                          141
     ZDApp_ResetTimerStart                         16
     ?Subroutine25                                  5
     ZDApp_ResetTimerCancel                        19
     ZDApp_LeaveCtrlInit                           71
     ZDApp_LeaveCtrlSet                            22
     ?Subroutine1                                  35
     ZDApp_LeaveCtrlReset                          13
     ZDApp_LeaveCtrlBypass                         15
     ZDApp_LeaveCtrlStartup                        45
     ZDApp_LeaveReset                              17
     ZDApp_LeaveUpdate                            134
     ??Subroutine57_0                               3
     ??Subroutine58_0                               6
     ZDApp_NetworkDiscoveryReq                     11
     ZDApp_JoinReq                                 84
     ?Subroutine5                                   5
     ZDApp_DeviceConfigured                        87
     ZDApp_SendEventMsg                            17
     ?Subroutine23                                  9
     ZDApp_SendMsg                                 90
     ZDO_NetworkDiscoveryConfirmCB                 78
     ZDApp_NwkDescListProcessing                  266
     ?Subroutine21                                  6
     ??Subroutine53_0                               6
     ?Subroutine0                                   3
     ZDO_NetworkFormationConfirmCB                 34
     ?Subroutine37                                 19
     ZDO_beaconNotifyIndCB                        545
     ?Subroutine36                                  9
     ?Subroutine26                                  4
     ?Subroutine39                                  9
     ?Subroutine20                                 10
     ?Subroutine15                                  6
     ?Subroutine38                                 10
     ?Subroutine10                                  9
     ??Subroutine60_0                               5
     ZDO_StartRouterConfirmCB                      34
     ZDO_JoinConfirmCB                            105
     ?Subroutine6                                   8
     ZDO_AddrChangeIndicationCB                    81
     ?Subroutine17                                  5
     ??Subroutine56_0                               1
     ZDO_JoinIndicationCB                           0
     ?Subroutine3                                   5
     ZDO_ConcentratorIndicationCB                  60
     ZDO_LeaveCnf                                  66
     ?Subroutine30                                  9
     ZDO_LeaveInd                                 120
     ?Subroutine32                                  3
     ??Subroutine59_0                               3
     ZDO_SyncIndicationCB                          29
     ZDO_ManytoOneFailureIndicationCB
                                                   10
     ZDO_PollConfirmCB                              3
     AddrMgrWriteNVRequest                          3
     ZDO_UpdateDeviceIndication                     3
     ZDApp_InMsgCB                                 95
     ZDApp_ChangeMatchDescRespPermission
                                                   11
     ZDApp_NetworkInit                             27
     ZDApp_NwkStateUpdateCB                        19
     ZDApp_NodeProfileSync                         44
     ZDApp_StartJoiningCycle                       39
     ZDApp_StopJoiningCycle                        31
     ZDApp_AnnounceNewAddress                      59
     ZDApp_NVUpdate                                 3
     ZDApp_CoordStartPANIDConflictCB
                                                   11
     ZDO_SrcRtgIndCB                               60
     ZDApp_InitZdoCBFunc                           19
     ?Subroutine29                                  9
     ?Subroutine41                                 17
     ZDO_RegisterForZdoCB                          27
     ZDO_DeregisterForZdoCB                        22
     ?<Initializer for zdoDiscCounter>              1
     ?<Initializer for continueJoining>             1
     ?<Initializer for devState>                    1
     ?<Initializer for ZDApp_epDesc>                6
     ?<Initializer for ZDApp_SavedPollRate>         2
     __Constant_36ee81                              4
     __Constant_36ee80                              4
     __Constant_1                                   4
     __Constant_3e8                                 4
     ??ZDApp_Init?relay                             6
     ??ZDApp_SecInit?relay                          6
     ??ZDApp_event_loop?relay                       6
     ??ZDApp_ProcessSecEvent?relay                  6
     ??ZDOInitDevice?relay                          6
     ??ZDApp_ReadNetworkRestoreState?relay          6
     ??ZDAppDetermineDeviceType?relay               6
     ??ZDApp_NetworkStartEvt?relay                  6
     ??ZDApp_DeviceAuthEvt?relay                    6
     ??ZDApp_SaveNetworkStateEvt?relay              6
     ??ZDApp_RestoreNetworkState?relay              6
     ??ZDApp_InitUserDesc?relay                     6
     ??ZDAppCheckForHoldKey?relay                   6
     ??ZDApp_ProcessOSALMsg?relay                   6
     ??ZDApp_ProcessMsgCBs?relay                    6
     ??ZDApp_RegisterCBs?relay                      6
     ??ZDApp_ProcessSecMsg?relay                    6
     ??ZDApp_ProcessNetworkJoin?relay               6
     ??ZDApp_SaveNwkKey?relay                       6
     ??ZDApp_ResetNwkKey?relay                      6
     ??ZDApp_RestoreNwkKey?relay                    6
     ??ZDApp_ResetTimerStart?relay                  6
     ??ZDApp_ResetTimerCancel?relay                 6
     ??ZDApp_LeaveCtrlInit?relay                    6
     ??ZDApp_LeaveCtrlSet?relay                     6
     ??ZDApp_LeaveCtrlReset?relay                   6
     ??ZDApp_LeaveCtrlBypass?relay                  6
     ??ZDApp_LeaveCtrlStartup?relay                 6
     ??ZDApp_LeaveReset?relay                       6
     ??ZDApp_LeaveUpdate?relay                      6
     ??ZDApp_NetworkDiscoveryReq?relay              6
     ??ZDApp_JoinReq?relay                          6
     ??ZDApp_DeviceConfigured?relay                 6
     ??ZDApp_SendEventMsg?relay                     6
     ??ZDApp_SendMsg?relay                          6
     ??ZDO_NetworkDiscoveryConfirmCB?relay          6
     ??ZDApp_NwkDescListProcessing?relay            6
     ??ZDO_NetworkFormationConfirmCB?relay          6
     ??ZDO_beaconNotifyIndCB?relay                  6
     ??ZDO_StartRouterConfirmCB?relay               6
     ??ZDO_JoinConfirmCB?relay                      6
     ??ZDO_AddrChangeIndicationCB?relay             6
     ??ZDO_JoinIndicationCB?relay                   6
     ??ZDO_ConcentratorIndicationCB?relay           6
     ??ZDO_LeaveCnf?relay                           6
     ??ZDO_LeaveInd?relay                           6
     ??ZDO_SyncIndicationCB?relay                   6
     ??ZDO_ManytoOneFailureIndicationCB?relay       6
     ??ZDO_PollConfirmCB?relay                      6
     ??AddrMgrWriteNVRequest?relay                  6
     ??ZDO_UpdateDeviceIndication?relay             6
     ??ZDApp_InMsgCB?relay                          6
     ??ZDApp_ChangeMatchDescRespPermission?relay    6
     ??ZDApp_NetworkInit?relay                      6
     ??ZDApp_NwkStateUpdateCB?relay                 6
     ??ZDApp_NodeProfileSync?relay                  6
     ??ZDApp_StartJoiningCycle?relay                6
     ??ZDApp_StopJoiningCycle?relay                 6
     ??ZDApp_AnnounceNewAddress?relay               6
     ??ZDApp_NVUpdate?relay                         6
     ??ZDApp_CoordStartPANIDConflictCB?relay        6
     ??ZDO_SrcRtgIndCB?relay                        6
     ??ZDApp_InitZdoCBFunc?relay                    6
     ??ZDO_RegisterForZdoCB?relay                   6
     ??ZDO_DeregisterForZdoCB?relay                 6

 
 5 369 bytes in segment BANKED_CODE
   390 bytes in segment BANK_RELAYS
     2 bytes in segment SFR_AN
    11 bytes in segment XDATA_I
    11 bytes in segment XDATA_ID
    16 bytes in segment XDATA_ROM_C
    55 bytes in segment XDATA_Z
 
 5 770 bytes of CODE  memory
     0 bytes of CONST memory (+ 16 bytes shared)
     0 bytes of DATA  memory (+  2 bytes shared)
    66 bytes of XDATA memory

Errors: none
Warnings: none
